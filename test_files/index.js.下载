!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).tdocs=n()}(this,(function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function n(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(t[o[i]]=e[o[i]])}return t}function t(e,n,t,o){return new(t||(t=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,s)}a((o=o.apply(e,n||[])).next())}))}function o(e,n){var t,o,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=c.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=n.call(e,c)}catch(e){r=[6,e],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function i(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s={exports:{}},a={exports:{}};!function(e,n){var t="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",r="[object Boolean]",s="[object Date]",a="[object Function]",u="[object GeneratorFunction]",l="[object Map]",d="[object Number]",f="[object Object]",p="[object Promise]",v="[object RegExp]",w="[object Set]",h="[object String]",g="[object Symbol]",m="[object WeakMap]",b="[object ArrayBuffer]",k="[object DataView]",y="[object Float32Array]",C="[object Float64Array]",W="[object Int8Array]",S="[object Int16Array]",_="[object Int32Array]",A="[object Uint8Array]",T="[object Uint8ClampedArray]",I="[object Uint16Array]",x="[object Uint32Array]",P=/\w*$/,D=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,E={};E[i]=E["[object Array]"]=E[b]=E[k]=E[r]=E[s]=E[y]=E[C]=E[W]=E[S]=E[_]=E[l]=E[d]=E[f]=E[v]=E[w]=E[h]=E[g]=E[A]=E[T]=E[I]=E[x]=!0,E["[object Error]"]=E[a]=E[m]=!1;var M="object"==typeof c&&c&&c.Object===Object&&c,j="object"==typeof self&&self&&self.Object===Object&&self,L=M||j||Function("return this")(),N=n&&!n.nodeType&&n,B=N&&e&&!e.nodeType&&e,F=B&&B.exports===N;function U(e,n){return e.set(n[0],n[1]),e}function R(e,n){return e.add(n),e}function V(e,n,t,o){var i=-1,r=e?e.length:0;for(o&&r&&(t=e[++i]);++i<r;)t=n(t,e[i],i,e);return t}function q(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}function Q(e){var n=-1,t=Array(e.size);return e.forEach((function(e,o){t[++n]=[o,e]})),t}function J(e,n){return function(t){return e(n(t))}}function G(e){var n=-1,t=Array(e.size);return e.forEach((function(e){t[++n]=e})),t}var X,H=Array.prototype,$=Function.prototype,z=Object.prototype,K=L["__core-js_shared__"],Y=(X=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+X:"",Z=$.toString,ee=z.hasOwnProperty,ne=z.toString,te=RegExp("^"+Z.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oe=F?L.Buffer:void 0,ie=L.Symbol,re=L.Uint8Array,ce=J(Object.getPrototypeOf,Object),se=Object.create,ae=z.propertyIsEnumerable,ue=H.splice,le=Object.getOwnPropertySymbols,de=oe?oe.isBuffer:void 0,fe=J(Object.keys,Object),pe=Be(L,"DataView"),ve=Be(L,"Map"),we=Be(L,"Promise"),he=Be(L,"Set"),ge=Be(L,"WeakMap"),me=Be(Object,"create"),be=qe(pe),ke=qe(ve),ye=qe(we),Ce=qe(he),We=qe(ge),Se=ie?ie.prototype:void 0,_e=Se?Se.valueOf:void 0;function Ae(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Te(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Ie(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function xe(e){this.__data__=new Te(e)}function Pe(e,n){var t=Je(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ge(e)}(e)&&ee.call(e,"callee")&&(!ae.call(e,"callee")||ne.call(e)==i)}(e)?function(e,n){for(var t=-1,o=Array(e);++t<e;)o[t]=n(t);return o}(e.length,String):[],o=t.length,r=!!o;for(var c in e)!n&&!ee.call(e,c)||r&&("length"==c||Re(c,o))||t.push(c);return t}function De(e,n,t){var o=e[n];ee.call(e,n)&&Qe(o,t)&&(void 0!==t||n in e)||(e[n]=t)}function Oe(e,n){for(var t=e.length;t--;)if(Qe(e[t][0],n))return t;return-1}function Ee(e,n,t,o,c,p,m){var D;if(o&&(D=p?o(e,c,p,m):o(e)),void 0!==D)return D;if(!$e(e))return e;var O=Je(e);if(O){if(D=function(e){var n=e.length,t=e.constructor(n);n&&"string"==typeof e[0]&&ee.call(e,"index")&&(t.index=e.index,t.input=e.input);return t}(e),!n)return function(e,n){var t=-1,o=e.length;n||(n=Array(o));for(;++t<o;)n[t]=e[t];return n}(e,D)}else{var M=Ue(e),j=M==a||M==u;if(Xe(e))return function(e,n){if(n)return e.slice();var t=new e.constructor(e.length);return e.copy(t),t}(e,n);if(M==f||M==i||j&&!p){if(q(e))return p?e:{};if(D=function(e){return"function"!=typeof e.constructor||Ve(e)?{}:(n=ce(e),$e(n)?se(n):{});var n}(j?{}:e),!n)return function(e,n){return Le(e,Fe(e),n)}(e,function(e,n){return e&&Le(n,ze(n),e)}(D,e))}else{if(!E[M])return p?e:{};D=function(e,n,t,o){var i=e.constructor;switch(n){case b:return je(e);case r:case s:return new i(+e);case k:return function(e,n){var t=n?je(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,o);case y:case C:case W:case S:case _:case A:case T:case I:case x:return function(e,n){var t=n?je(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}(e,o);case l:return function(e,n,t){return V(n?t(Q(e),!0):Q(e),U,new e.constructor)}(e,o,t);case d:case h:return new i(e);case v:return function(e){var n=new e.constructor(e.source,P.exec(e));return n.lastIndex=e.lastIndex,n}(e);case w:return function(e,n,t){return V(n?t(G(e),!0):G(e),R,new e.constructor)}(e,o,t);case g:return c=e,_e?Object(_e.call(c)):{}}var c}(e,M,Ee,n)}}m||(m=new xe);var L=m.get(e);if(L)return L;if(m.set(e,D),!O)var N=t?function(e){return function(e,n,t){var o=n(e);return Je(e)?o:function(e,n){for(var t=-1,o=n.length,i=e.length;++t<o;)e[i+t]=n[t];return e}(o,t(e))}(e,ze,Fe)}(e):ze(e);return function(e,n){for(var t=-1,o=e?e.length:0;++t<o&&!1!==n(e[t],t,e););}(N||e,(function(i,r){N&&(i=e[r=i]),De(D,r,Ee(i,n,t,o,r,e,m))})),D}function Me(e){return!(!$e(e)||(n=e,Y&&Y in n))&&(He(e)||q(e)?te:D).test(qe(e));var n}function je(e){var n=new e.constructor(e.byteLength);return new re(n).set(new re(e)),n}function Le(e,n,t,o){t||(t={});for(var i=-1,r=n.length;++i<r;){var c=n[i],s=o?o(t[c],e[c],c,t,e):void 0;De(t,c,void 0===s?e[c]:s)}return t}function Ne(e,n){var t,o,i=e.__data__;return("string"==(o=typeof(t=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==t:null===t)?i["string"==typeof n?"string":"hash"]:i.map}function Be(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return Me(t)?t:void 0}Ae.prototype.clear=function(){this.__data__=me?me(null):{}},Ae.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ae.prototype.get=function(e){var n=this.__data__;if(me){var o=n[e];return o===t?void 0:o}return ee.call(n,e)?n[e]:void 0},Ae.prototype.has=function(e){var n=this.__data__;return me?void 0!==n[e]:ee.call(n,e)},Ae.prototype.set=function(e,n){return this.__data__[e]=me&&void 0===n?t:n,this},Te.prototype.clear=function(){this.__data__=[]},Te.prototype.delete=function(e){var n=this.__data__,t=Oe(n,e);return!(t<0)&&(t==n.length-1?n.pop():ue.call(n,t,1),!0)},Te.prototype.get=function(e){var n=this.__data__,t=Oe(n,e);return t<0?void 0:n[t][1]},Te.prototype.has=function(e){return Oe(this.__data__,e)>-1},Te.prototype.set=function(e,n){var t=this.__data__,o=Oe(t,e);return o<0?t.push([e,n]):t[o][1]=n,this},Ie.prototype.clear=function(){this.__data__={hash:new Ae,map:new(ve||Te),string:new Ae}},Ie.prototype.delete=function(e){return Ne(this,e).delete(e)},Ie.prototype.get=function(e){return Ne(this,e).get(e)},Ie.prototype.has=function(e){return Ne(this,e).has(e)},Ie.prototype.set=function(e,n){return Ne(this,e).set(e,n),this},xe.prototype.clear=function(){this.__data__=new Te},xe.prototype.delete=function(e){return this.__data__.delete(e)},xe.prototype.get=function(e){return this.__data__.get(e)},xe.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.set=function(e,n){var t=this.__data__;if(t instanceof Te){var o=t.__data__;if(!ve||o.length<199)return o.push([e,n]),this;t=this.__data__=new Ie(o)}return t.set(e,n),this};var Fe=le?J(le,Object):function(){return[]},Ue=function(e){return ne.call(e)};function Re(e,n){return!!(n=null==n?o:n)&&("number"==typeof e||O.test(e))&&e>-1&&e%1==0&&e<n}function Ve(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||z)}function qe(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Qe(e,n){return e===n||e!=e&&n!=n}(pe&&Ue(new pe(new ArrayBuffer(1)))!=k||ve&&Ue(new ve)!=l||we&&Ue(we.resolve())!=p||he&&Ue(new he)!=w||ge&&Ue(new ge)!=m)&&(Ue=function(e){var n=ne.call(e),t=n==f?e.constructor:void 0,o=t?qe(t):void 0;if(o)switch(o){case be:return k;case ke:return l;case ye:return p;case Ce:return w;case We:return m}return n});var Je=Array.isArray;function Ge(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!He(e)}var Xe=de||function(){return!1};function He(e){var n=$e(e)?ne.call(e):"";return n==a||n==u}function $e(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}function ze(e){return Ge(e)?Pe(e):function(e){if(!Ve(e))return fe(e);var n=[];for(var t in Object(e))ee.call(e,t)&&"constructor"!=t&&n.push(t);return n}(e)}e.exports=function(e){return Ee(e,!0,!0)}}(a,a.exports),a.exports.default;var u={exports:{}};!function(e){var n="__lodash_hash_undefined__",t="[object Function]",o="[object GeneratorFunction]",i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/,s=/^\./,a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u=/\\(\\)?/g,l=/^\[object .+?Constructor\]$/,d="object"==typeof c&&c&&c.Object===Object&&c,f="object"==typeof self&&self&&self.Object===Object&&self,p=d||f||Function("return this")();var v,w=Array.prototype,h=Function.prototype,g=Object.prototype,m=p["__core-js_shared__"],b=(v=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",k=h.toString,y=g.hasOwnProperty,C=g.toString,W=RegExp("^"+k.call(y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),S=p.Symbol,_=w.splice,A=N(p,"Map"),T=N(Object,"create"),I=S?S.prototype:void 0,x=I?I.toString:void 0;function P(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function D(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function O(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function E(e,n){for(var t,o,i=e.length;i--;)if((t=e[i][0])===(o=n)||t!=t&&o!=o)return i;return-1}function M(e,n){for(var t,o=0,c=(n=function(e,n){if(R(e))return!1;var t=typeof e;if("number"==t||"symbol"==t||"boolean"==t||null==e||q(e))return!0;return r.test(e)||!i.test(e)||null!=n&&e in Object(n)}(n,e)?[n]:R(t=n)?t:B(t)).length;null!=e&&o<c;)e=e[F(n[o++])];return o&&o==c?e:void 0}function j(e){return!(!V(e)||(n=e,b&&b in n))&&(function(e){var n=V(e)?C.call(e):"";return n==t||n==o}(e)||function(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}(e)?W:l).test(function(e){if(null!=e){try{return k.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var n}function L(e,n){var t,o,i=e.__data__;return("string"==(o=typeof(t=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==t:null===t)?i["string"==typeof n?"string":"hash"]:i.map}function N(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return j(t)?t:void 0}P.prototype.clear=function(){this.__data__=T?T(null):{}},P.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},P.prototype.get=function(e){var t=this.__data__;if(T){var o=t[e];return o===n?void 0:o}return y.call(t,e)?t[e]:void 0},P.prototype.has=function(e){var n=this.__data__;return T?void 0!==n[e]:y.call(n,e)},P.prototype.set=function(e,t){return this.__data__[e]=T&&void 0===t?n:t,this},D.prototype.clear=function(){this.__data__=[]},D.prototype.delete=function(e){var n=this.__data__,t=E(n,e);return!(t<0)&&(t==n.length-1?n.pop():_.call(n,t,1),!0)},D.prototype.get=function(e){var n=this.__data__,t=E(n,e);return t<0?void 0:n[t][1]},D.prototype.has=function(e){return E(this.__data__,e)>-1},D.prototype.set=function(e,n){var t=this.__data__,o=E(t,e);return o<0?t.push([e,n]):t[o][1]=n,this},O.prototype.clear=function(){this.__data__={hash:new P,map:new(A||D),string:new P}},O.prototype.delete=function(e){return L(this,e).delete(e)},O.prototype.get=function(e){return L(this,e).get(e)},O.prototype.has=function(e){return L(this,e).has(e)},O.prototype.set=function(e,n){return L(this,e).set(e,n),this};var B=U((function(e){var n;e=null==(n=e)?"":function(e){if("string"==typeof e)return e;if(q(e))return x?x.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}(n);var t=[];return s.test(e)&&t.push(""),e.replace(a,(function(e,n,o,i){t.push(o?i.replace(u,"$1"):n||e)})),t}));function F(e){if("string"==typeof e||q(e))return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}function U(e,n){if("function"!=typeof e||n&&"function"!=typeof n)throw new TypeError("Expected a function");var t=function(){var o=arguments,i=n?n.apply(this,o):o[0],r=t.cache;if(r.has(i))return r.get(i);var c=e.apply(this,o);return t.cache=r.set(i,c),c};return t.cache=new(U.Cache||O),t}U.Cache=O;var R=Array.isArray;function V(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}function q(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==C.call(e)}e.exports=function(e,n,t){var o=null==e?void 0:M(e,n);return void 0===o?t:o}}(u),u.exports.default;var l={exports:{}};!function(e,n){var t=9007199254740991,o="[object Map]",i="[object Promise]",r="[object Set]",s="[object WeakMap]",a="[object DataView]",u=/^\[object .+?Constructor\]$/,l="object"==typeof c&&c&&c.Object===Object&&c,d="object"==typeof self&&self&&self.Object===Object&&self,f=l||d||Function("return this")(),p=n&&!n.nodeType&&n,v=p&&e&&!e.nodeType&&e,w=v&&v.exports===p;var h,g,m,b=Function.prototype,k=Object.prototype,y=f["__core-js_shared__"],C=(h=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",W=b.toString,S=k.hasOwnProperty,_=k.toString,A=RegExp("^"+W.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),T=w?f.Buffer:void 0,I=k.propertyIsEnumerable,x=T?T.isBuffer:void 0,P=(g=Object.keys,m=Object,function(e){return g(m(e))}),D=q(f,"DataView"),O=q(f,"Map"),E=q(f,"Promise"),M=q(f,"Set"),j=q(f,"WeakMap"),L=!I.call({valueOf:1},"valueOf"),N=J(D),B=J(O),F=J(E),U=J(M),R=J(j);function V(e){return!(!K(e)||function(e){return!!C&&C in e}(e))&&(z(e)||function(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}(e)?A:u).test(J(e))}function q(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return V(t)?t:void 0}var Q=function(e){return _.call(e)};function J(e){if(null!=e){try{return W.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function G(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&H(e)}(e)&&S.call(e,"callee")&&(!I.call(e,"callee")||"[object Arguments]"==_.call(e))}(D&&Q(new D(new ArrayBuffer(1)))!=a||O&&Q(new O)!=o||E&&Q(E.resolve())!=i||M&&Q(new M)!=r||j&&Q(new j)!=s)&&(Q=function(e){var n=_.call(e),t="[object Object]"==n?e.constructor:void 0,c=t?J(t):void 0;if(c)switch(c){case N:return a;case B:return o;case F:return i;case U:return r;case R:return s}return n});var X=Array.isArray;function H(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}(e.length)&&!z(e)}var $=x||function(){return!1};function z(e){var n=K(e)?_.call(e):"";return"[object Function]"==n||"[object GeneratorFunction]"==n}function K(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}e.exports=function(e){if(H(e)&&(X(e)||"string"==typeof e||"function"==typeof e.splice||$(e)||G(e)))return!e.length;var n=Q(e);if(n==o||n==r)return!e.size;if(L||function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||k)}(e))return!P(e).length;for(var t in e)if(S.call(e,t))return!1;return!0}}(l,l.exports),l.exports.default;var d={exports:{}};!function(e,n){var t="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",r="[object Function]",s="[object Object]",a=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[i]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[r]=l["[object Map]"]=l["[object Number]"]=l[s]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var d="object"==typeof c&&c&&c.Object===Object&&c,f="object"==typeof self&&self&&self.Object===Object&&self,p=d||f||Function("return this")(),v=n&&!n.nodeType&&n,w=v&&e&&!e.nodeType&&e,h=w&&w.exports===v,g=h&&d.process,m=function(){try{var e=w&&w.require&&w.require("util").types;return e||g&&g.binding&&g.binding("util")}catch(e){}}(),b=m&&m.isTypedArray;function k(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}var y,C,W,S=Array.prototype,_=Function.prototype,A=Object.prototype,T=p["__core-js_shared__"],I=_.toString,x=A.hasOwnProperty,P=(y=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+y:"",D=A.toString,O=I.call(Object),E=RegExp("^"+I.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=h?p.Buffer:void 0,j=p.Symbol,L=p.Uint8Array,N=M?M.allocUnsafe:void 0,B=(C=Object.getPrototypeOf,W=Object,function(e){return C(W(e))}),F=Object.create,U=A.propertyIsEnumerable,R=S.splice,V=j?j.toStringTag:void 0,q=function(){try{var e=ve(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Q=M?M.isBuffer:void 0,J=Math.max,G=Date.now,X=ve(p,"Map"),H=ve(Object,"create"),$=function(){function e(){}return function(n){if(!Ae(n))return{};if(F)return F(n);e.prototype=n;var t=new e;return e.prototype=void 0,t}}();function z(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function K(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Y(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Z(e){var n=this.__data__=new K(e);this.size=n.size}function ee(e,n){var t=ye(e),o=!t&&ke(e),i=!t&&!o&&We(e),r=!t&&!o&&!i&&Ie(e),c=t||o||i||r,s=c?function(e,n){for(var t=-1,o=Array(e);++t<e;)o[t]=n(t);return o}(e.length,String):[],a=s.length;for(var u in e)!n&&!x.call(e,u)||c&&("length"==u||i&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||we(u,a))||s.push(u);return s}function ne(e,n,t){(void 0!==t&&!be(e[n],t)||void 0===t&&!(n in e))&&ie(e,n,t)}function te(e,n,t){var o=e[n];x.call(e,n)&&be(o,t)&&(void 0!==t||n in e)||ie(e,n,t)}function oe(e,n){for(var t=e.length;t--;)if(be(e[t][0],n))return t;return-1}function ie(e,n,t){"__proto__"==n&&q?q(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}z.prototype.clear=function(){this.__data__=H?H(null):{},this.size=0},z.prototype.delete=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},z.prototype.get=function(e){var n=this.__data__;if(H){var o=n[e];return o===t?void 0:o}return x.call(n,e)?n[e]:void 0},z.prototype.has=function(e){var n=this.__data__;return H?void 0!==n[e]:x.call(n,e)},z.prototype.set=function(e,n){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=H&&void 0===n?t:n,this},K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(e){var n=this.__data__,t=oe(n,e);return!(t<0)&&(t==n.length-1?n.pop():R.call(n,t,1),--this.size,!0)},K.prototype.get=function(e){var n=this.__data__,t=oe(n,e);return t<0?void 0:n[t][1]},K.prototype.has=function(e){return oe(this.__data__,e)>-1},K.prototype.set=function(e,n){var t=this.__data__,o=oe(t,e);return o<0?(++this.size,t.push([e,n])):t[o][1]=n,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new z,map:new(X||K),string:new z}},Y.prototype.delete=function(e){var n=pe(this,e).delete(e);return this.size-=n?1:0,n},Y.prototype.get=function(e){return pe(this,e).get(e)},Y.prototype.has=function(e){return pe(this,e).has(e)},Y.prototype.set=function(e,n){var t=pe(this,e),o=t.size;return t.set(e,n),this.size+=t.size==o?0:1,this},Z.prototype.clear=function(){this.__data__=new K,this.size=0},Z.prototype.delete=function(e){var n=this.__data__,t=n.delete(e);return this.size=n.size,t},Z.prototype.get=function(e){return this.__data__.get(e)},Z.prototype.has=function(e){return this.__data__.has(e)},Z.prototype.set=function(e,n){var t=this.__data__;if(t instanceof K){var o=t.__data__;if(!X||o.length<199)return o.push([e,n]),this.size=++t.size,this;t=this.__data__=new Y(o)}return t.set(e,n),this.size=t.size,this};var re,ce=function(e,n,t){for(var o=-1,i=Object(e),r=t(e),c=r.length;c--;){var s=r[re?c:++o];if(!1===n(i[s],s,i))break}return e};function se(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":V&&V in Object(e)?function(e){var n=x.call(e,V),t=e[V];try{e[V]=void 0;var o=!0}catch(e){}var i=D.call(e);o&&(n?e[V]=t:delete e[V]);return i}(e):function(e){return D.call(e)}(e)}function ae(e){return Te(e)&&se(e)==i}function ue(e){return!(!Ae(e)||function(e){return!!P&&P in e}(e))&&(Se(e)?E:a).test(function(e){if(null!=e){try{return I.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function le(e){if(!Ae(e))return function(e){var n=[];if(null!=e)for(var t in Object(e))n.push(t);return n}(e);var n=he(e),t=[];for(var o in e)("constructor"!=o||!n&&x.call(e,o))&&t.push(o);return t}function de(e,n,t,o,i){e!==n&&ce(n,(function(r,c){if(i||(i=new Z),Ae(r))!function(e,n,t,o,i,r,c){var a=ge(e,t),u=ge(n,t),l=c.get(u);if(l)return void ne(e,t,l);var d=r?r(a,u,t+"",e,n,c):void 0,f=void 0===d;if(f){var p=ye(u),v=!p&&We(u),w=!p&&!v&&Ie(u);d=u,p||v||w?ye(a)?d=a:Te(k=a)&&Ce(k)?d=function(e,n){var t=-1,o=e.length;n||(n=Array(o));for(;++t<o;)n[t]=e[t];return n}(a):v?(f=!1,d=function(e,n){if(n)return e.slice();var t=e.length,o=N?N(t):new e.constructor(t);return e.copy(o),o}(u,!0)):w?(f=!1,h=u,g=!0?(m=h.buffer,b=new m.constructor(m.byteLength),new L(b).set(new L(m)),b):h.buffer,d=new h.constructor(g,h.byteOffset,h.length)):d=[]:function(e){if(!Te(e)||se(e)!=s)return!1;var n=B(e);if(null===n)return!0;var t=x.call(n,"constructor")&&n.constructor;return"function"==typeof t&&t instanceof t&&I.call(t)==O}(u)||ke(u)?(d=a,ke(a)?d=function(e){return function(e,n,t,o){var i=!t;t||(t={});var r=-1,c=n.length;for(;++r<c;){var s=n[r],a=o?o(t[s],e[s],s,t,e):void 0;void 0===a&&(a=e[s]),i?ie(t,s,a):te(t,s,a)}return t}(e,xe(e))}(a):Ae(a)&&!Se(a)||(d=function(e){return"function"!=typeof e.constructor||he(e)?{}:$(B(e))}(u))):f=!1}var h,g,m,b;var k;f&&(c.set(u,d),i(d,u,o,r,c),c.delete(u));ne(e,t,d)}(e,n,c,t,de,o,i);else{var a=o?o(ge(e,c),r,c+"",e,n,i):void 0;void 0===a&&(a=r),ne(e,c,a)}}),xe)}function fe(e,n){return me(function(e,n,t){return n=J(void 0===n?e.length-1:n,0),function(){for(var o=arguments,i=-1,r=J(o.length-n,0),c=Array(r);++i<r;)c[i]=o[n+i];i=-1;for(var s=Array(n+1);++i<n;)s[i]=o[i];return s[n]=t(c),k(e,this,s)}}(e,n,Oe),e+"")}function pe(e,n){var t,o,i=e.__data__;return("string"==(o=typeof(t=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==t:null===t)?i["string"==typeof n?"string":"hash"]:i.map}function ve(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return ue(t)?t:void 0}function we(e,n){var t=typeof e;return!!(n=null==n?o:n)&&("number"==t||"symbol"!=t&&u.test(e))&&e>-1&&e%1==0&&e<n}function he(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||A)}function ge(e,n){if(("constructor"!==n||"function"!=typeof e[n])&&"__proto__"!=n)return e[n]}var me=function(e){var n=0,t=0;return function(){var o=G(),i=16-(o-t);if(t=o,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}(q?function(e,n){return q(e,"toString",{configurable:!0,enumerable:!1,value:(t=n,function(){return t}),writable:!0});var t}:Oe);function be(e,n){return e===n||e!=e&&n!=n}var ke=ae(function(){return arguments}())?ae:function(e){return Te(e)&&x.call(e,"callee")&&!U.call(e,"callee")},ye=Array.isArray;function Ce(e){return null!=e&&_e(e.length)&&!Se(e)}var We=Q||function(){return!1};function Se(e){if(!Ae(e))return!1;var n=se(e);return n==r||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}function _e(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function Ae(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)}function Te(e){return null!=e&&"object"==typeof e}var Ie=b?function(e){return function(n){return e(n)}}(b):function(e){return Te(e)&&_e(e.length)&&!!l[se(e)]};function xe(e){return Ce(e)?ee(e,!0):le(e)}var Pe,De=(Pe=function(e,n,t){de(e,n,t)},fe((function(e,n){var t=-1,o=n.length,i=o>1?n[o-1]:void 0,r=o>2?n[2]:void 0;for(i=Pe.length>3&&"function"==typeof i?(o--,i):void 0,r&&function(e,n,t){if(!Ae(t))return!1;var o=typeof n;return!!("number"==o?Ce(t)&&we(n,t.length):"string"==o&&n in t)&&be(t[n],e)}(n[0],n[1],r)&&(i=o<3?void 0:i,o=1),e=Object(e);++t<o;){var c=n[t];c&&Pe(e,c,t,i)}return e})));function Oe(e){return e}e.exports=De}(d,d.exports),d.exports.default,function(e){e.exports=function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s="./index.ts")}({"../node_modules/webpack/buildin/global.js":
/*!*************************************************!*\
      !*** ../node_modules/webpack/buildin/global.js ***!
      \*************************************************/
/*! no static exports found */function(e,n){var t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./config-constants.ts":
/*!*****************************!*\
      !*** ./config-constants.ts ***!
      \*****************************/
/*! no static exports found */function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigItem=void 0;var o=(i.getKey=function(e){if(""===this.configName)throw new Error("子类未重命名configName!");return this.configName+"."+e},i.configName="",i);function i(){}n.ConfigItem=o},"./config-manager.ts":
/*!***************************!*\
      !*** ./config-manager.ts ***!
      \***************************/
/*! no static exports found */function(e,n,t){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DocsConfig=void 0;var i=o(t(/*! lodash.merge */"lodash.merge")),r=o(t(/*! lodash.get */"lodash.get")),c=o(t(/*! lodash.isempty */"lodash.isempty")),s=o(t(/*! lodash.clonedeep */"lodash.clonedeep")),a=t(/*! ./utils */"./utils.ts"),u=(l.prototype.bind=function(e){i.default(this.cache,e)},l.prototype.get=function(e){return r.default(this.cache,e)},l.prototype.clear=function(){this.cache={}},l.prototype.getAll=function(){return this.cache},l);function l(){this.cache={}}function d(){this.cache=new u,this.init()}d.getInstance=function(){return this.instance||(this.instance=new d),this.instance},d.prototype.bind=function(e){c.default(e)||this.cache.bind(e)},d.prototype.clear=function(){this.cache.clear()},d.prototype.getConfig=function(e){return"object"==typeof(e=this.cache.get(e))?s.default(e):e},d.prototype.getAllConfig=function(){var e=null!==(e=this.cache.getAll())&&void 0!==e?e:{};return s.default(e)},d.prototype.saveToSessionStorage=function(e){var n;try{if(window&&window.sessionStorage){var t=null!==(n=null!=e?e:this.cache.getAll())&&void 0!==n?n:{};return window.sessionStorage.setItem("configCache",JSON.stringify(t)),!0}}catch(e){console.error(e)}return!1},d.prototype.loadFromSessionStorage=function(){try{if(!window||!window.sessionStorage)throw new Error("browser is not support sessionStorage");var e=window.sessionStorage.getItem("configCache");if(e)return this.bind(JSON.parse(e)),!0}catch(e){console.error(e)}return!1},d.prototype.init=function(){var e;"undefined"!=typeof window&&("object"==typeof(e=window.AppConfig)?(e=e[a.getURLQuery("mode")]||e.normal,e=i.default(e,null==e?void 0:e.custom),this.bind(e),this.saveToSessionStorage()):console.error("加载 AppConfig 配置出错"))},t=d,n.DocsConfig=t},"./index.ts":
/*!******************!*\
      !*** ./index.ts ***!
      \******************/
/*! no static exports found */function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigItem=void 0;var o=t(/*! ./config-manager */"./config-manager.ts"),i=t(/*! ./config-constants */"./config-constants.ts");Object.defineProperty(n,"ConfigItem",{enumerable:!0,get:function(){return i.ConfigItem}}),n.default=o.DocsConfig},"./utils.ts":
/*!******************!*\
      !*** ./utils.ts ***!
      \******************/
/*! no static exports found */function(e,n,t){(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.getURLQuery=void 0,n.getURLQuery=function(n,t){var o=null,i=(t?"?"+(t.split("?")[1]||""):null===(i=e.location)||void 0===i?void 0:i.search)||"";return(o=i?i.match(new RegExp("(\\?|&)"+n+"=([^&]*)(&|$)")):o)?decodeURIComponent(o[2]):""}}).call(this,t(/*! ./../node_modules/webpack/buildin/global.js */"../node_modules/webpack/buildin/global.js"))},"lodash.clonedeep":
/*!***********************************!*\
      !*** external "lodash.clonedeep" ***!
      \***********************************/
/*! no static exports found */function(e,n){e.exports=a.exports},"lodash.get":
/*!*****************************!*\
      !*** external "lodash.get" ***!
      \*****************************/
/*! no static exports found */function(e,n){e.exports=u.exports},"lodash.isempty":
/*!*********************************!*\
      !*** external "lodash.isempty" ***!
      \*********************************/
/*! no static exports found */function(e,n){e.exports=l.exports},"lodash.merge":
/*!*******************************!*\
      !*** external "lodash.merge" ***!
      \*******************************/
/*! no static exports found */function(e,n){e.exports=d.exports}})}(s);var f=s.exports.default.getInstance().getConfig('npm["@tencent/tdocs-jsapi"]'),p=function(){return window.location.host},v=(null==f?void 0:f.TOC_HOST)||"docs.qq.com",w=(null==f?void 0:f.TOB_HOST)||"doc.weixin.qq.com",h=(null==f?void 0:f.TOB_COOKIE_DOMAIN)||".doc.weixin.qq.com",g=Object.values((null==f?void 0:f.COOKIE_DOMAINS)||[".weixin.qq.com","weixin.qq.com",".doc.weixin.qq.com","doc.weixin.qq.com"]),m=(null==f?void 0:f.QQJSSDK)||"https://docs.idqqimg.com/tim/docs/sheets/static/js/lib/docs.qqapi.v1.js",b=(null==f?void 0:f.WXJSSDK)||"https://res.wx.qq.com/open/js/jweixin-1.6.0.js",k=(null==f?void 0:f.WW_MOBILE_JSSDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.34/TenOfficeJSBridge.js",y=(null==f?void 0:f.WW_PC_JSSDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.35/wwapp.js",C=(null==f?void 0:f.WW_MOBILE_JSSDK_OLD)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.30/QMailBridge.js",W=(null==f?void 0:f.WW_PC_JSSDK_OLD)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.30/WxDriveAdapter.js",S=(null==f?void 0:f.WW_WEMEET_JS_SDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.29/wemeet-js-sdk-1.0.40.js",_=new RegExp((null==f?void 0:f.WEDRIVE_LINK_REGEXP)||"^http(s):\\/\\/drive\\.weixin\\.qq\\.com"),A=new RegExp((null==f?void 0:f.PRIVATE_WEDRIVE_LINK_REGEXP)||"^http(s):\\/\\/drive\\.weixin\\.qq\\.com\\/s\\?"),T=new RegExp((null==f?void 0:f.WEDOC_FORM_LINK_REGEXP)||"^http(s):\\/\\/doc\\.weixin\\.qq\\.com\\/form"),I=new RegExp((null==f?void 0:f.TOC_ORIGIN_REGEXP)||"^https?:\\/\\/docs\\.qq\\.com(\\/|$)"),x=new RegExp((null==f?void 0:f.TOB_ORIGIN_REGEXP)||"^https?:\\/\\/doc\\.weixin\\.qq\\.com(\\/|$)"),P=new RegExp((null==f?void 0:f.APP_WORK_WEIXIN_ADMIN_URL_REGEXP)||"^https?:\\/\\/app\\.work\\.weixin\\.qq\\.com\\/wework_admin"),D=(null==f?void 0:f.TOC_SUPPORT_URL)||"https://support.qq.com/products/28096/",O=(null==f?void 0:f.TOB_SUPPORT_URL)||"https://support.qq.com/products/111603/",E=function(){function e(){}return e.isServerSide=function(){return"undefined"==typeof window},e.getUserAgent=function(){return this.isServerSide()?"":navigator.userAgent},e.getLowerCaseUserAgent=function(){return this.getUserAgent().toLowerCase()},e.isMobile=function(){return/(mobile)/i.test(this.getUserAgent())||/(android)/i.test(this.getUserAgent())},e.isEnterpriseEnv=function(){return p()===w},e.isAndroid=function(){return/(android)/i.test(this.getUserAgent())},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(this.getUserAgent())},e.isIPad=function(){return/(ipad)/i.test(this.getUserAgent())},e.isAPad=function(){return!/(mobile)/i.test(this.getUserAgent())&&/android/i.test(this.getUserAgent())&&/TencentDocs/i.test(this.getUserAgent())},e.isMac=function(){return!this.isMobile()&&/Mac OS X/i.test(this.getUserAgent())},e.isWindows=function(){return!this.isServerSide()&&/win/i.test(navigator.platform.toLowerCase())},e.isLinux=function(){return!this.isServerSide()&&navigator.platform.includes("Linux")},e.isIE=function(){return/msie/i.test(this.getUserAgent())&&!this.isOpera()||/trident/i.test(this.getUserAgent())},e.isIE9=function(){return!!this.isIE()&&"MSIE9.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")},e.isIE10=function(){return!!this.isIE()&&"MSIE10.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")},e.isIE11=function(){return!window.ActiveXObject&&"ActiveXObject"in window},e.isEdge=function(){return/edge/i.test(this.getUserAgent())},e.isChrome=function(){return/chrome/i.test(this.getUserAgent())},e.isIOSChrome=function(){return/CriOS/i.test(this.getUserAgent())},e.getChromeVersion=function(){var e=this.getUserAgent().match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):0},e.isFireFox=function(){return/firefox/i.test(this.getUserAgent())},e.isOpera=function(){return/opera/i.test(this.getUserAgent())},e.isSafari=function(){return/safari/i.test(this.getUserAgent())},e.isQBFamily=function(){return/QQBrowser/i.test(this.getUserAgent())},e.isMQB=function(){return/MQB/i.test(this.getUserAgent())},e.isMQBFamily=function(){return/MQQBrowser/i.test(this.getUserAgent())},e.isPCQQBrowser=function(){return this.isQBFamily()&&!this.isMobile()&&!/QBCore/i.test(this.getUserAgent())},e.isMobileQQBrowser=function(){return this.isMobile()&&this.isMQBFamily()&&!/TBS/i.test(this.getUserAgent())},e.isQQBrowser=function(){return this.isMobile()?this.isMobileQQBrowser():this.isPCQQBrowser()},e.isWindowStore=function(){return/MSAppHost/i.test(this.getUserAgent())},e.isTimQQ=function(){return/(QQ)/i.test(this.getUserAgent())&&!this.isTencentDocsApp()&&!this.isWeWork()&&!this.isWXh5()&&!this.isQQBrowser()},e.isTim=function(){return/TIM/.test(this.getUserAgent())},e.isQQ=function(){return this.isTimQQ()&&!this.isTim()},e.isWeMeetApp=function(){return/(tencent_wemeet)/i.test(this.getUserAgent())&&(this.isIOS()||this.isAndroid())},e.isTencentDocsApp=function(){return/TencentDocs/i.test(this.getUserAgent())},e.isTencentDocsIPadApp=function(){return this.isIPad()&&this.isTencentDocsApp()},e.isTencentDocsPhoneApp=function(){return!this.isIPad()&&!this.isAPad()&&this.isTencentDocsApp()},e.getTencentDocsAppVersion=function(){var e="";if(this.isTencentDocsApp()){var n=null;this.isAndroid()?n=this.getUserAgent().match(/TencentDocs\/(\S*).tencentdocs/):this.isIOS()&&(n=this.getUserAgent().match(/TencentDocs\/(\S*)/)),n&&(e=n[1])}return e},e.getQQBrowserVersion=function(){var e="",n=this.getUserAgent().match(/MQQBrowser\/(\S*)/);return n&&(e=n[1]),e},e.checkTencentDocAppVersionSupportFunction=function(e){var n=this.getTencentDocsAppVersion();return this.compareVersion(n,e)>=0},e.checkTencentDocAppVersionLowerSupportFunction=function(e){var n=this.getTencentDocsAppVersion();return this.compareVersion(n,e)<0},e.isTencentDocsPC=function(){return/TxDocsPC/i.test(this.getUserAgent())},e.isTencentDocsDesktopApp=function(){return/TDAppDesktop/i.test(this.getUserAgent())},e.checkAppVersionSupportFunction=function(e){var n=this.getUserAgent().match(/MQQBrowser\/(\S*)/);return!!n&&n[1]>=e},e.getTencentDocsDesktopAppVersion=function(){var e="";if(this.isTencentDocsDesktopApp()){var n=this.getUserAgent().match(/TDAppDesktop\/(\S*)/);n&&(e=n[1])}return e},e.supportNativeToolbar=function(){var e;if(this.isTencentDocsApp()&&!location.href.includes("/aio/")){var n=null===(e=this.getUserAgent().match(/TencentDocs\/(\S*).tencentdocs/))||void 0===e?void 0:e[1];if(this.isAndroid()&&"string"==typeof n&&n>="2.1.5"||(this.isIOS()||this.isIPad())&&this.checkTencentDocAppVersionSupportFunction("2.1.5"))return!0}return!1},e.isPortrait=function(){var e=window.orientation;return 0===e||180===e},e.measureSafeMargin=function(){var e=this.isPortrait().toString();if(!this._margins[e]){this._innerSpan||(this._innerSpan=document.createElement("span")),this._innerSpan.id="safeAreaMarginSpan";var n=["top","bottom"].map((function(e){return"padding-"+e+": constant(safe-area-inset-"+e+"); padding-"+e+": env(safe-area-inset-"+e+");"})).join("");this._innerSpan.style.cssText="position: absolute; top: -50000px; white-space:nowrap; overflow: hidden; "+n,document.body.appendChild(this._innerSpan);var t=window.getComputedStyle(this._innerSpan);this._margins[e]={top:parseInt(t.paddingTop||"0",10)||0,bottom:parseInt(t.paddingBottom||"0",10)||0}}return this._margins[e]},e.isIphoneX=function(){var e=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&3===window.devicePixelRatio&&(812===window.screen.width&&375===window.screen.height||375===window.screen.width&&812===window.screen.height),n=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&3===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height),t=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&2===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height);return e||n||t},e.clearSafeMargin=function(){var e=document.getElementById("safeAreaMarginSpan");e?e.remove():this._innerSpan&&this._innerSpan.remove()},e.getStylePanelHeight=function(){var e=258;if(this.isIOS())if(this.isPortrait()){var n=this.measureSafeMargin().bottom;e+=!this.isIphoneX()||0!==n||this.isWXh5()||this.isQQMiniProgram()?n:32}else e=window.innerHeight/2;else this.isPortrait()||(e=window.innerHeight/2);return e},e.getDocUniqueUrl=function(){var e=window.location.pathname.split("/");return e[e.length-1]||"doc"},e.setStylePanelClick=function(e){this.stylePanelButtonClicked=e},e.isStylePanelClick=function(){return this.stylePanelButtonClicked},e.isQQHD=function(){return/IPadQQ/i.test(this.getUserAgent())},e.isWXFamily=function(){return/MicroMessenger/i.test(this.getUserAgent())},e.isWXorQQMiniProgram=function(){return this.isWXMiniProgram()||this.isQQMiniProgram()},e.isWXMiniProgram=function(){return this.isWXFamily()&&this.isMiniProgram()},e.isQQMiniProgram=function(){return/QQ\/|TIM/i.test(this.getUserAgent())&&this.isMiniProgram()},e.isWeWork=function(){return/(wxwork)/i.test(this.getUserAgent())},e.isWeWorkMacOrWin=function(){return!this.isMobile()&&this.isWeWork()&&/(Windows)|(Macintosh)/i.test(this.getUserAgent())},e.isWeWorkWin=function(){return!this.isMobile()&&this.isWeWork()&&/(Windows)/i.test(this.getUserAgent())},e.isWeWorkLinux=function(){return!this.isMobile()&&this.isWeWork()&&/(Linux)/i.test(this.getUserAgent())},e.isWXh5=function(){return this.isWXFamily()&&!this.isWeWork()&&!this.isWXMiniProgram()},e.isAndroidPad=function(){return!/(mobile)/i.test(this.getUserAgent())&&/(android)/i.test(this.getUserAgent())},e.getBrowser=function(){var e=navigator.userAgent,n=/(msie\s|trident.*rv:)([\w.]+)/,t=/(edge)\/([\w.]+)/,o=/(firefox)\/([\w.]+)/,i=/(opera).+version\/([\w.]+)/,r=/(chrome)\/([\w.]+)/,c=/version\/([\w.]+).*(safari)/,s="other",a="0",u="other",l=e.toLowerCase(),d=navigator.vendor;try{var f=function(e){var s=n.exec(e);return null!==s?{browser:"ie",version:s[2]||"0"}:null!==(s=t.exec(e))?{browser:"edge",version:s[2]||"0"}:null!==(s=r.exec(e))&&/Google/.test(d)?{browser:s[1]||"",version:s[2]||"0"}:null!==(s=c.exec(e))&&/Apple Computer/.test(d)?{browser:s[2]||"",version:s[1]||"0"}:null!==(s=o.exec(e))||null!==(s=i.exec(e))?{browser:s[1]||"",version:s[2]||"0"}:{browser:"other",version:"0"}}(l);f.browser&&(s=f.browser,a=f.version,u=/qqbrowser/.test(l)?"qq":/se/.test(l)&&/metasr/.test(l)?"sougou":/360se/.test(l)?"360":/ucweb/.test(l)?"uc":/2345explorer/.test(l)?"2345":/lbbrowser/.test(l)?"liebao":/maxthon/.test(l)?"maxthon":s)}catch(e){console.error(" getBrowser error: "+e)}return u+"_"+s+"_"+a},e.compareVersion=function(e,n){var t=e.split("."),o=n.split("."),i=parseInt(t[0],10)-parseInt(o[0],10);return 0===i&&e!==n?this.compareVersion(t.splice(1).join("."),o.splice(1).join(".")):i},e.isMiniProgram=function(){var e=window;return/miniprogram|miniapp(?!enable)/i.test(this.getUserAgent())||void 0!==e.__wxjs_environment&&"miniprogram"===e.__wxjs_environment},e._margins={},e.stylePanelButtonClicked=!1,e}(),M={exports:{}};!function(e,n){"undefined"!=typeof window&&window,e.exports=function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=73)}([function(e,n){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(e,n,t){e.exports=!t(3)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(5);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,n){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,n,t){var o=t(18)("wks"),i=t(17),r=t(0).Symbol,c="function"==typeof r;(e.exports=function(e){return o[e]||(o[e]=c&&r[e]||(c?r:i)("Symbol."+e))}).store=o},function(e,n){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,n,t){var o=t(0),i=t(15),r=t(11),c=t(12),s=t(19),a=function(e,n,t){var u,l,d,f,p=e&a.F,v=e&a.G,w=e&a.S,h=e&a.P,g=e&a.B,m=v?o:w?o[n]||(o[n]={}):(o[n]||{}).prototype,b=v?i:i[n]||(i[n]={}),k=b.prototype||(b.prototype={});for(u in v&&(t=n),t)d=((l=!p&&m&&void 0!==m[u])?m:t)[u],f=g&&l?s(d,o):h&&"function"==typeof d?s(Function.call,d):d,m&&c(m,u,d,e&a.U),b[u]!=d&&r(b,u,f),h&&k[u]!=d&&(k[u]=d)};o.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},function(e,n,t){var o=t(2),i=t(24),r=t(16),c=Object.defineProperty;n.f=t(1)?Object.defineProperty:function(e,n,t){if(o(e),n=r(n,!0),o(t),i)try{return c(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},function(e,n){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},function(e,n){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,n,t){var o=t(14),i=Math.min;e.exports=function(e){return e>0?i(o(e),9007199254740991):0}},function(e,n,t){var o=t(7),i=t(26);e.exports=t(1)?function(e,n,t){return o.f(e,n,i(1,t))}:function(e,n,t){return e[n]=t,e}},function(e,n,t){var o=t(0),i=t(11),r=t(13),c=t(17)("src"),s=t(45),a=(""+s).split("toString");t(15).inspectSource=function(e){return s.call(e)},(e.exports=function(e,n,t,s){var u="function"==typeof t;u&&(r(t,"name")||i(t,"name",n)),e[n]!==t&&(u&&(r(t,c)||i(t,c,e[n]?""+e[n]:a.join(String(n)))),e===o?e[n]=t:s?e[n]?e[n]=t:i(e,n,t):(delete e[n],i(e,n,t)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[c]||s.call(this)}))},function(e,n){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},function(e,n){var t=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:t)(e)}},function(e,n){var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},function(e,n,t){var o=t(5);e.exports=function(e,n){if(!o(e))return e;var t,i;if(n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;if("function"==typeof(t=e.valueOf)&&!o(i=t.call(e)))return i;if(!n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,n){var t=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+o).toString(36))}},function(e,n,t){var o=t(15),i=t(0),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,n){return r[e]||(r[e]=void 0!==n?n:{})})("versions",[]).push({version:o.version,mode:t(46)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,n,t){var o=t(27);e.exports=function(e,n,t){if(o(e),void 0===n)return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,o){return e.call(n,t,o)};case 3:return function(t,o,i){return e.call(n,t,o,i)}}return function(){return e.apply(n,arguments)}}},function(e,n,t){var o=t(30),i=t(9);e.exports=function(e){return o(i(e))}},function(e,n){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,n,t){var o=t(9);e.exports=function(e){return Object(o(e))}},function(e,n,t){var o,i,r=t(36),c=RegExp.prototype.exec,s=String.prototype.replace,a=c,u=(o=/a/,i=/b*/g,c.call(o,"a"),c.call(i,"a"),0!==o.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];(u||l)&&(a=function(e){var n,t,o,i,a=this;return l&&(t=new RegExp("^"+a.source+"$(?!\\s)",r.call(a))),u&&(n=a.lastIndex),o=c.call(a,e),u&&o&&(a.lastIndex=a.global?o.index+o[0].length:n),l&&o&&o.length>1&&s.call(o[0],t,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o}),e.exports=a},function(e,n,t){e.exports=!t(1)&&!t(3)((function(){return 7!=Object.defineProperty(t(25)("div"),"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(5),i=t(0).document,r=o(i)&&o(i.createElement);e.exports=function(e){return r?i.createElement(e):{}}},function(e,n){e.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(e,n){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,n,t){var o=t(5),i=t(48).set;e.exports=function(e,n,t){var r,c=n.constructor;return c!==t&&"function"==typeof c&&(r=c.prototype)!==t.prototype&&o(r)&&i&&i(e,r),e}},function(e,n,t){var o=t(49),i=t(26),r=t(20),c=t(16),s=t(13),a=t(24),u=Object.getOwnPropertyDescriptor;n.f=t(1)?u:function(e,n){if(e=r(e),n=c(n,!0),a)try{return u(e,n)}catch(e){}if(s(e,n))return i(!o.f.call(e,n),e[n])}},function(e,n,t){var o=t(8);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,n,t){var o=t(32),i=t(21).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(e){return o(e,i)}},function(e,n,t){var o=t(13),i=t(20),r=t(50)(!1),c=t(34)("IE_PROTO");e.exports=function(e,n){var t,s=i(e),a=0,u=[];for(t in s)t!=c&&o(s,t)&&u.push(t);for(;n.length>a;)o(s,t=n[a++])&&(~r(u,t)||u.push(t));return u}},function(e,n,t){var o=t(14),i=Math.max,r=Math.min;e.exports=function(e,n){return(e=o(e))<0?i(e+n,0):r(e,n)}},function(e,n,t){var o=t(18)("keys"),i=t(17);e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,n,t){var o=t(5),i=t(8),r=t(4)("match");e.exports=function(e){var n;return o(e)&&(void 0!==(n=e[r])?!!n:"RegExp"==i(e))}},function(e,n,t){var o=t(2);e.exports=function(){var e=o(this),n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.unicode&&(n+="u"),e.sticky&&(n+="y"),n}},function(e,n,t){var o=t(53)(!0);e.exports=function(e,n,t){return n+(t?o(e,n).length:1)}},function(e,n,t){var o=t(54),i=RegExp.prototype.exec;e.exports=function(e,n){var t=e.exec;if("function"==typeof t){var r=t.call(e,n);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==o(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,n)}},function(e,n,t){t(55);var o=t(12),i=t(11),r=t(3),c=t(9),s=t(4),a=t(23),u=s("species"),l=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,n=e.exec;e.exec=function(){return n.apply(this,arguments)};var t="ab".split(e);return 2===t.length&&"a"===t[0]&&"b"===t[1]}();e.exports=function(e,n,t){var f=s(e),p=!r((function(){var n={};return n[f]=function(){return 7},7!=""[e](n)})),v=p?!r((function(){var n=!1,t=/a/;return t.exec=function(){return n=!0,null},"split"===e&&(t.constructor={},t.constructor[u]=function(){return t}),t[f](""),!n})):void 0;if(!p||!v||"replace"===e&&!l||"split"===e&&!d){var w=/./[f],h=t(c,f,""[e],(function(e,n,t,o,i){return n.exec===a?p&&!i?{done:!0,value:w.call(n,t,o)}:{done:!0,value:e.call(t,n,o)}:{done:!1}})),g=h[0],m=h[1];o(String.prototype,e,g),i(RegExp.prototype,f,2==n?function(e,n){return m.call(e,this,n)}:function(e){return m.call(e,this)})}}},function(e,n,t){var o=t(19),i=t(30),r=t(22),c=t(10),s=t(57);e.exports=function(e,n){var t=1==e,a=2==e,u=3==e,l=4==e,d=6==e,f=5==e||d,p=n||s;return function(n,s,v){for(var w,h,g=r(n),m=i(g),b=o(s,v,3),k=c(m.length),y=0,C=t?p(n,k):a?p(n,0):void 0;k>y;y++)if((f||y in m)&&(h=b(w=m[y],y,g),e))if(t)C[y]=h;else if(h)switch(e){case 3:return!0;case 5:return w;case 6:return y;case 2:C.push(w)}else if(l)return!1;return d?-1:u||l?l:C}}},function(e,n,t){var o=t(4)("unscopables"),i=Array.prototype;null==i[o]&&t(11)(i,o,{}),e.exports=function(e){i[o][e]=!0}},function(e,n){e.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,n){function t(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,n,t){var o=t(6);o(o.S+o.F*!t(1),"Object",{defineProperty:t(7).f})},function(e,n,t){e.exports=t(18)("native-function-to-string",Function.toString)},function(e,n){e.exports=!1},function(e,n,t){var o=t(0),i=t(28),r=t(7).f,c=t(31).f,s=t(35),a=t(36),u=o.RegExp,l=u,d=u.prototype,f=/a/g,p=/a/g,v=new u(f)!==f;if(t(1)&&(!v||t(3)((function(){return p[t(4)("match")]=!1,u(f)!=f||u(p)==p||"/a/i"!=u(f,"i")})))){u=function(e,n){var t=this instanceof u,o=s(e),r=void 0===n;return!t&&o&&e.constructor===u&&r?e:i(v?new l(o&&!r?e.source:e,n):l((o=e instanceof u)?e.source:e,o&&r?a.call(e):n),t?this:d,u)};for(var w=function(e){e in u||r(u,e,{configurable:!0,get:function(){return l[e]},set:function(n){l[e]=n}})},h=c(l),g=0;h.length>g;)w(h[g++]);d.constructor=u,u.prototype=d,t(12)(o,"RegExp",u)}t(51)("RegExp")},function(e,n,t){var o=t(5),i=t(2),r=function(e,n){if(i(e),!o(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,o){try{(o=t(19)(Function.call,t(29).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return r(e,t),n?e.__proto__=t:o(e,t),e}}({},!1):void 0),check:r}},function(e,n){n.f={}.propertyIsEnumerable},function(e,n,t){var o=t(20),i=t(10),r=t(33);e.exports=function(e){return function(n,t,c){var s,a=o(n),u=i(a.length),l=r(c,u);if(e&&t!=t){for(;u>l;)if((s=a[l++])!=s)return!0}else for(;u>l;l++)if((e||l in a)&&a[l]===t)return e||l||0;return!e&&-1}}},function(e,n,t){var o=t(0),i=t(7),r=t(1),c=t(4)("species");e.exports=function(e){var n=o[e];r&&n&&!n[c]&&i.f(n,c,{configurable:!0,get:function(){return this}})}},function(e,n,t){var o=t(2),i=t(22),r=t(10),c=t(14),s=t(37),a=t(38),u=Math.max,l=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;t(39)("replace",2,(function(e,n,t,v){return[function(o,i){var r=e(this),c=null==o?void 0:o[n];return void 0!==c?c.call(o,r,i):t.call(String(r),o,i)},function(e,n){var i=v(t,e,this,n);if(i.done)return i.value;var d=o(e),f=String(this),p="function"==typeof n;p||(n=String(n));var h=d.global;if(h){var g=d.unicode;d.lastIndex=0}for(var m=[];;){var b=a(d,f);if(null===b)break;if(m.push(b),!h)break;""===String(b[0])&&(d.lastIndex=s(f,r(d.lastIndex),g))}for(var k,y="",C=0,W=0;W<m.length;W++){b=m[W];for(var S=String(b[0]),_=u(l(c(b.index),f.length),0),A=[],T=1;T<b.length;T++)A.push(void 0===(k=b[T])?k:String(k));var I=b.groups;if(p){var x=[S].concat(A,_,f);void 0!==I&&x.push(I);var P=String(n.apply(void 0,x))}else P=w(S,f,_,A,I,n);_>=C&&(y+=f.slice(C,_)+P,C=_+S.length)}return y+f.slice(C)}];function w(e,n,o,r,c,s){var a=o+e.length,u=r.length,l=p;return void 0!==c&&(c=i(c),l=f),t.call(s,l,(function(t,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,o);case"'":return n.slice(a);case"<":s=c[i.slice(1,-1)];break;default:var l=+i;if(0===l)return t;if(l>u){var f=d(l/10);return 0===f?t:f<=u?void 0===r[f-1]?i.charAt(1):r[f-1]+i.charAt(1):t}s=r[l-1]}return void 0===s?"":s}))}}))},function(e,n,t){var o=t(14),i=t(9);e.exports=function(e){return function(n,t){var r,c,s=String(i(n)),a=o(t),u=s.length;return a<0||a>=u?e?"":void 0:(r=s.charCodeAt(a))<55296||r>56319||a+1===u||(c=s.charCodeAt(a+1))<56320||c>57343?e?s.charAt(a):r:e?s.slice(a,a+2):c-56320+(r-55296<<10)+65536}}},function(e,n,t){var o=t(8),i=t(4)("toStringTag"),r="Arguments"==o(function(){return arguments}());e.exports=function(e){var n,t,c;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,n){try{return e[n]}catch(e){}}(n=Object(e),i))?t:r?o(n):"Object"==(c=o(n))&&"function"==typeof n.callee?"Arguments":c}},function(e,n,t){var o=t(23);t(6)({target:"RegExp",proto:!0,forced:o!==/./.exec},{exec:o})},function(e,n,t){var o=t(6),i=t(40)(1);o(o.P+o.F*!t(60)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,n,t){var o=t(58);e.exports=function(e,n){return new(o(e))(n)}},function(e,n,t){var o=t(5),i=t(59),r=t(4)("species");e.exports=function(e){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)||(n=void 0),o(n)&&null===(n=n[r])&&(n=void 0)),void 0===n?Array:n}},function(e,n,t){var o=t(8);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,n,t){var o=t(3);e.exports=function(e,n){return!!e&&o((function(){n?e.call(null,(function(){}),1):e.call(null)}))}},function(e,n,t){var o=t(35),i=t(2),r=t(62),c=t(37),s=t(10),a=t(38),u=t(23),l=t(3),d=Math.min,f=[].push,p="length",v=!l((function(){}));t(39)("split",2,(function(e,n,t,l){var w;return w="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[p]||2!="ab".split(/(?:ab)*/)[p]||4!=".".split(/(.?)(.?)/)[p]||".".split(/()()/)[p]>1||"".split(/.?/)[p]?function(e,n){var i=String(this);if(void 0===e&&0===n)return[];if(!o(e))return t.call(i,e,n);for(var r,c,s,a=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,v=void 0===n?4294967295:n>>>0,w=new RegExp(e.source,l+"g");(r=u.call(w,i))&&!((c=w.lastIndex)>d&&(a.push(i.slice(d,r.index)),r[p]>1&&r.index<i[p]&&f.apply(a,r.slice(1)),s=r[0][p],d=c,a[p]>=v));)w.lastIndex===r.index&&w.lastIndex++;return d===i[p]?!s&&w.test("")||a.push(""):a.push(i.slice(d)),a[p]>v?a.slice(0,v):a}:"0".split(void 0,0)[p]?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,o){var i=e(this),r=null==t?void 0:t[n];return void 0!==r?r.call(t,i,o):w.call(String(i),t,o)},function(e,n){var o=l(w,e,this,n,w!==t);if(o.done)return o.value;var u=i(e),f=String(this),p=r(u,RegExp),h=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(v?"y":"g"),m=new p(v?u:"^(?:"+u.source+")",g),b=void 0===n?4294967295:n>>>0;if(0===b)return[];if(0===f.length)return null===a(m,f)?[f]:[];for(var k=0,y=0,C=[];y<f.length;){m.lastIndex=v?y:0;var W,S=a(m,v?f:f.slice(y));if(null===S||(W=d(s(m.lastIndex+(v?0:y)),f.length))===k)y=c(f,y,h);else{if(C.push(f.slice(k,y)),C.length===b)return C;for(var _=1;_<=S.length-1;_++)if(C.push(S[_]),C.length===b)return C;y=k=W}}return C.push(f.slice(k)),C}]}))},function(e,n,t){var o=t(2),i=t(27),r=t(4)("species");e.exports=function(e,n){var t,c=o(e).constructor;return void 0===c||null==(t=o(c)[r])?n:i(t)}},function(e,n,t){var o=t(0),i=t(13),r=t(8),c=t(28),s=t(16),a=t(3),u=t(31).f,l=t(29).f,d=t(7).f,f=t(64).trim,p=o.Number,v=p,w=p.prototype,h="Number"==r(t(66)(w)),g="trim"in String.prototype,m=function(e){var n=s(e,!1);if("string"==typeof n&&n.length>2){var t,o,i,r=(n=g?n.trim():f(n,3)).charCodeAt(0);if(43===r||45===r){if(88===(t=n.charCodeAt(2))||120===t)return NaN}else if(48===r){switch(n.charCodeAt(1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+n}for(var c,a=n.slice(2),u=0,l=a.length;u<l;u++)if((c=a.charCodeAt(u))<48||c>i)return NaN;return parseInt(a,o)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var n=arguments.length<1?0:e,t=this;return t instanceof p&&(h?a((function(){w.valueOf.call(t)})):"Number"!=r(t))?c(new v(m(n)),t,p):m(n)};for(var b,k=t(1)?u(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),y=0;k.length>y;y++)i(v,b=k[y])&&!i(p,b)&&d(p,b,l(v,b));p.prototype=w,w.constructor=p,t(12)(o,"Number",p)}},function(e,n,t){var o=t(6),i=t(9),r=t(3),c=t(65),s="["+c+"]",a=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),l=function(e,n,t){var i={},s=r((function(){return!!c[e]()||"​"!="​"[e]()})),a=i[e]=s?n(d):c[e];t&&(i[t]=a),o(o.P+o.F*s,"String",i)},d=l.trim=function(e,n){return e=String(i(e)),1&n&&(e=e.replace(a,"")),2&n&&(e=e.replace(u,"")),e};e.exports=l},function(e,n){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,n,t){var o=t(2),i=t(67),r=t(21),c=t(34)("IE_PROTO"),s=function(){},a=function(){var e,n=t(25)("iframe"),o=r.length;for(n.style.display="none",t(69).appendChild(n),n.src="javascript:",(e=n.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),a=e.F;o--;)delete a.prototype[r[o]];return a()};e.exports=Object.create||function(e,n){var t;return null!==e?(s.prototype=o(e),t=new s,s.prototype=null,t[c]=e):t=a(),void 0===n?t:i(t,n)}},function(e,n,t){var o=t(7),i=t(2),r=t(68);e.exports=t(1)?Object.defineProperties:function(e,n){i(e);for(var t,c=r(n),s=c.length,a=0;s>a;)o.f(e,t=c[a++],n[t]);return e}},function(e,n,t){var o=t(32),i=t(21);e.exports=Object.keys||function(e){return o(e,i)}},function(e,n,t){var o=t(0).document;e.exports=o&&o.documentElement},function(e,n,t){var o=t(6),i=t(40)(5),r=!0;"find"in[]&&Array(1).find((function(){r=!1})),o(o.P+o.F*r,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),t(41)("find")},function(e,n,t){var o=t(6);o(o.P,"Array",{fill:t(72)}),t(41)("fill")},function(e,n,t){var o=t(22),i=t(33),r=t(10);e.exports=function(e){for(var n=o(this),t=r(n.length),c=arguments.length,s=i(c>1?arguments[1]:void 0,t),a=c>2?arguments[2]:void 0,u=void 0===a?t:i(a,t);u>s;)n[s++]=e;return n}},function(e,n,t){t.r(n),t.d(n,"getVersionFromUA",(function(){return d})),t.d(n,"compareVersion",(function(){return l})),t.d(n,"UserAgent",(function(){return Ve}));var o=t(42),i=t.n(o),r=t(43),c=t.n(r),s=(t(44),t(47),t(52),t(56),t(61),t(63),t(70),t(71),/\d+([._]\d+)*/);function a(e){var n,t=s.exec(e);return null!==(n=null==t?void 0:t[0].replace(/_/g,"."))&&void 0!==n?n:null}function u(e){var n=a(e);return(null==n?void 0:n.split(".").map(Number))||[]}function l(e,n){return t=u(e),o=u(n),(i=Array(Math.max(t.length,o.length)).fill(0).map((function(e,n){return(t[n]||0)-(o[n]||0)})).find((function(e){return 0!==e}))||0)<0?-1:i>0?1:0;var t,o,i}function d(e,n){var t;try{t=new RegExp("\\b".concat(e,"\\W+\\d+([\\._]\\d+)*"),"i")}catch(e){return null}var o=t.exec(n);return o?a(o[0].substring(e.length)):null}var f=function(){var e;return function(){return void 0===e&&(e="undefined"!=typeof navigator?navigator.userAgent:""),e}}();function p(e){return function(n){return e(n||f())}}function v(e){return function(n,t){return e(t||f(),n)}}var w=p((function(e){return/(mobile)/i.test(e)||k(e)})),h=p((function(e){return/(mobile)/i.test(e)&&!m(e)})),g=p((function(e){return/(iphone)/i.test(e)})),m=p((function(e){return/(ipad)/i.test(e)})),b=p((function(e){return/(mobile)/i.test(e)&&S(e)})),k=p((function(e){return!/(mobile)/i.test(e)&&S(e)})),y=p((function(e){return!w(e)})),C=p((function(e){return!w(e)&&/Mac OS X/i.test(e)})),W=p((function(e){return C(e)&&navigator.maxTouchPoints>1})),S=p((function(e){return/android|adr/i.test(e)})),_=p((function(e){return S(e)?d("Android",e):null})),A=v((function(e,n){return l(_(e)||"",n)>=0})),T=p((function(e){return/(iphone|ipad|ipod)/i.test(e)})),I=p((function(e){return T(e)?d("OS",e):null})),x=v((function(e,n){return l(I(e)||"",n)>=0})),P=p((function(e){return/(win64|wow64|win32|wow32|windows nt)/i.test(e)})),D=p((function(e){return/MSAppHost/i.test(e)})),O=p((function(e){return/linux/i.test(e)&&!S(e)})),E=p((function(e){return/linux-kylin/i.test(e)})),M=p((function(e){return/linux-uos/i.test(e)})),j=p((function(e){return!w(e)&&/QQBrowser/i.test(e)&&!/QBCore/i.test(e)})),L=p((function(e){return j(e)?d("QQBrowser",e):null})),N=v((function(e,n){return l(L(e)||"",n)>=0})),B=p((function(e){return w(e)&&/MQQBrowser/i.test(e)&&!me(e)&&!z(e)&&!Z(e)&&!We(e)&&!Ee(e)&&!ke(e)&&!je(e)})),F=p((function(e){return B(e)?d("MQQBrowser",e):null})),U=v((function(e,n){return l(F(e)||"",n)>=0})),R=p((function(e){return w(e)?B(e):j(e)})),V=p((function(e){return/(Chrome|CriOS)\/\S+( Mobile\S*)? Safari\/\S+$/i.test(e)})),q=p((function(e){return d("Chrome",e)})),Q=v((function(e,n){return l(q(e)||"",n)>=0})),J=p((function(e){return/Version\/\S+( Mobile\S*)? Safari\/\S+$/i.test(e)})),G=p((function(e){return/MSIE/i.test(e)&&!/opera/i.test(e)||/Trident/i.test(e)})),X=p((function(e){return/Edge/i.test(e)})),H=p((function(e){return/Edg\//i.test(e)})),$=p((function(e){return/(Firefox|Focus|FxiOS)\//i.test(e)})),z=p((function(e){return/MicroMessenger/i.test(e)&&!Z(e)&&!ye(e)})),K=p((function(e){return z(e)||ye(e)?d("MicroMessenger",e):null})),Y=v((function(e,n){return l(K(e)||"",n)>=0})),Z=p((function(e){return/(wxwork)/i.test(e)})),ee=p((function(e){return/(wxworkQt)/i.test(e)})),ne=p((function(e){return/WeComCEF/i.test(e)&&Z(e)})),te=p((function(e){return/(wxworklocal)/i.test(e)})),oe=p((function(e){return/WXDrive/i.test(e)})),ie=p((function(e){return oe(e)?d("WXDrive",e):null})),re=v((function(e,n){return l(ie(e)||"",n)>=0})),ce=p((function(e){return Z(e)?d("wxwork",e):null})),se=v((function(e,n){return l(ce(e)||"",n)>=0})),ae=p((function(e){return te(e)?d("wxworklocal",e):null})),ue=v((function(e,n){return l(ae(e)||"",n)>=0})),le=p((function(e){return/QQ\//i.test(e)&&!We(e)&&!Ce(e)&&!ve(e)})),de=p((function(e){return/QQ\//i.test(e)&&/_GM/i.test(e)})),fe=p((function(e){return le(e)||Ce(e)?d("QQ",e):null})),pe=v((function(e,n){return l(fe(e)||"",n)>=0})),ve=p((function(e){return/TIM/i.test(e)})),we=p((function(e){return/QBCore/i.test(e)&&/TIM2.0/i.test(e)})),he=p((function(e){return ve(e)?d("TIM",e):null})),ge=v((function(e,n){return l(he(e)||"",n)>=0})),me=p((function(e){return ve(e)&&!Ce(e)||le(e)})),be=p((function(e){return ve(e)||/QQ/i.test(e)})),ke=p((function(e){return/miniprogram|miniapp(?!enable)/i.test(e)||"undefined"!=typeof __wxjs_environment&&"miniprogram"===__wxjs_environment})),ye=p((function(e){return/MicroMessenger/i.test(e)&&ke(e)})),Ce=p((function(e){return/QQ\/|TIM/i.test(e)&&ke(e)})),We=p((function(e){return/TencentDocs/i.test(e)})),Se=p((function(e){return d("TencentDocs",e)})),_e=v((function(e,n){return l(Se(e)||"",n)>=0})),Ae=p((function(e){return/TxDocsPC/i.test(e)})),Te=p((function(e){return Ae(e)})),Ie=p((function(e){return d("TxDocsPC",e)})),xe=v((function(e,n){return l(Ie(e)||"",n)>=0})),Pe=p((function(e){return/TDAppDesktop/i.test(e)})),De=p((function(e){return d("TDAppDesktop",e)})),Oe=v((function(e,n){return l(De(e)||"",n)>=0})),Ee=p((function(e){return/weiyun/i.test(e)})),Me=p((function(e){return/SE 2\.X MetaSr 1\.0/i.test(e)})),je=p((function(e){return/tencent_wemeet/i.test(e)})),Le=p((function(e){return je(e)&&/meeting_wework/i.test(e)})),Ne=p((function(e){return/TencentMeetingRooms/i.test(e)})),Be=p((function(e){return J(e)?d("Version",e):null})),Fe=v((function(e,n){return l(Be(e)||"",n)>=0})),Ue=p((function(e){return $(e)?d("(Firefox|Focus|FxiOS)",e):null})),Re=v((function(e,n){return l(Ue(e)||"",n)>=0})),Ve=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f();i()(this,e),this.getAndroidVersion=function(){return _(n.userAgent)},this.isAndroidVersionAboveOrEqual=function(e){return A(e,n.userAgent)},this.getIOSVersion=function(){return I(n.userAgent)},this.isIOSVersionAboveOrEqual=function(e){return x(e,n.userAgent)},this.getPCQQBrowserVersion=function(){return L(n.userAgent)},this.isPCQQBrowserVersionAboveOrEqual=function(e){return N(e,n.userAgent)},this.getMobileQQBrowserVersion=function(){return F(n.userAgent)},this.isMobileQQBrowserVersionAboveOrEqual=function(e){return U(e,n.userAgent)},this.getChromeVersion=function(){return q(n.userAgent)},this.isChromeVersionAboveOrEqual=function(e){return Q(e,n.userAgent)},this.getWeChatVersion=function(){return K(n.userAgent)},this.isWeChatVersionAboveOrEqual=function(e){return Y(e,n.userAgent)},this.getWxDriveVersion=function(){return ie(n.userAgent)},this.isWxDriveVersionAboveOrEqual=function(e){return re(e,n.userAgent)},this.getWxWorkVersion=function(){return ce(n.userAgent)},this.isWxWorkVersionAboveOrEqual=function(e){return se(e,n.userAgent)},this.getWxWorkPrivateVersion=function(){return ae(n.userAgent)},this.isWxWorkPrivateVersionAboveOrEqual=function(e){return ue(e,n.userAgent)},this.getQQVersion=function(){return fe(n.userAgent)},this.isQQVersionAboveOrEqual=function(e){return pe(e,n.userAgent)},this.getTimVersion=function(){return he(n.userAgent)},this.isTimVersionAboveOrEqual=function(e){return ge(e,n.userAgent)},this.getTencentDocsAppVersion=function(){return Se(n.userAgent)},this.isTencentDocsAppVersionAboveOrEqual=function(e){return _e(e,n.userAgent)},this.getPCTencentDocsClientVersion=function(){return Ie(n.userAgent)},this.isPCTencentDocsClientVersionAboveOrEqual=function(e){return xe(e,n.userAgent)},this.getElectronTencentDocsClientVersion=function(){return De(n.userAgent)},this.isElectronTencentDocsClientVersionAboveOrEqual=function(e){return Oe(e,n.userAgent)},this.getSafariVersion=function(){return Be(n.userAgent)},this.isSafariVersionAboveOrEqual=function(e){return Fe(e,n.userAgent)},this.getFirefoxVersion=function(){return Ue(n.userAgent)},this.isFirefoxVersionAboveOrEqual=function(e){return Re(e,n.userAgent)},Object.defineProperty(this,"userAgent",{value:t,writable:!1})}return c()(e,[{key:"isMobile",get:function(){return w(this.userAgent)}},{key:"isMobilePhone",get:function(){return h(this.userAgent)}},{key:"isIPhone",get:function(){return g(this.userAgent)}},{key:"isIPad",get:function(){return m(this.userAgent)}},{key:"isAndroidPhone",get:function(){return b(this.userAgent)}},{key:"isAndroidPad",get:function(){return k(this.userAgent)}},{key:"isPC",get:function(){return y(this.userAgent)}},{key:"isMac",get:function(){return C(this.userAgent)}},{key:"isIPadEmulatedMac",get:function(){return W(this.userAgent)}},{key:"isAndroid",get:function(){return S(this.userAgent)}},{key:"isIOS",get:function(){return T(this.userAgent)}},{key:"isWindows",get:function(){return P(this.userAgent)}},{key:"isWindowsUWP",get:function(){return D(this.userAgent)}},{key:"isLinux",get:function(){return O(this.userAgent)}},{key:"isLinuxKylin",get:function(){return E(this.userAgent)}},{key:"isLinuxUOS",get:function(){return M(this.userAgent)}},{key:"isPCQQBrowser",get:function(){return j(this.userAgent)}},{key:"isMobileQQBrowser",get:function(){return B(this.userAgent)}},{key:"isQQBrowser",get:function(){return R(this.userAgent)}},{key:"isChrome",get:function(){return V(this.userAgent)}},{key:"isSafari",get:function(){return J(this.userAgent)}},{key:"isIE",get:function(){return G(this.userAgent)}},{key:"isOldEdge",get:function(){return X(this.userAgent)}},{key:"isChromiumEdge",get:function(){return H(this.userAgent)}},{key:"isFirefox",get:function(){return $(this.userAgent)}},{key:"isWeChat",get:function(){return z(this.userAgent)}},{key:"isWxWork",get:function(){return Z(this.userAgent)}},{key:"isWxWorkQt",get:function(){return ee(this.userAgent)}},{key:"isWxWorkCustom",get:function(){return ne(this.userAgent)}},{key:"isWxWorkPrivate",get:function(){return te(this.userAgent)}},{key:"isWxDrive",get:function(){return oe(this.userAgent)}},{key:"isQQ",get:function(){return le(this.userAgent)}},{key:"isQQForGooglePlay",get:function(){return de(this.userAgent)}},{key:"isTim",get:function(){return ve(this.userAgent)}},{key:"isPCTim",get:function(){return we(this.userAgent)}},{key:"isTimOrQQ",get:function(){return me(this.userAgent)}},{key:"isTimOrQQFamily",get:function(){return be(this.userAgent)}},{key:"isMiniProgram",get:function(){return ke(this.userAgent)}},{key:"isWxMiniProgram",get:function(){return ye(this.userAgent)}},{key:"isQQMiniProgram",get:function(){return Ce(this.userAgent)}},{key:"isTencentDocsApp",get:function(){return We(this.userAgent)}},{key:"isPCTencentDocsClient",get:function(){return Ae(this.userAgent)}},{key:"isPCTencentDocsApp",get:function(){return Te(this.userAgent)}},{key:"isElectronTencentDocsClient",get:function(){return Pe(this.userAgent)}},{key:"isWeiYunApp",get:function(){return Ee(this.userAgent)}},{key:"isSouGou",get:function(){return Me(this.userAgent)}},{key:"isTencentMeeting",get:function(){return je(this.userAgent)}},{key:"isWxWorkTencentMeeting",get:function(){return Le(this.userAgent)}},{key:"isTencentMeetingRooms",get:function(){return Ne(this.userAgent)}}]),e}();n.default=new Ve}])}(M);var j,L,N,B,F,U,R,V,q,Q,J,G,X,H,$,z,K,Y=M.exports.default;!function(e){e.IsQQ="IsQQ",e.isQQMiniProgram="isQQMiniProgram",e.isTencentDocsApp="isTencentDocsApp",e.isElectronTencentDocsClient="isElectronTencentDocsClient",e.isWXh5="isWXh5",e.isWeWork="isWeWork",e.isWeWorkApp="isWeWorkApp",e.isTencentMeeting="isTencentMeeting",e.UNKNOW="UNKNOW"}(j||(j={})),function(e){e.Android="android",e.IOS="ios",e.Windows="windows",e.Mac="mac",e.Linux="linux"}(L||(L={})),function(e){e[e.Direct=0]="Direct",e[e.Detail=1]="Detail",e[e.Browser=2]="Browser",e[e.NativeControl=3]="NativeControl"}(N||(N={})),function(e){e[e.show=0]="show",e[e.hide=1]="hide",e[e.disable=2]="disable"}(B||(B={})),function(e){e.image="image",e.text="text",e.collaborator="collaborator",e.offline="offline",e.separator="separator",e.iconWithText="iconWithText"}(F||(F={})),function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.middle=2]="middle"}(U||(U={})),function(e){e.share="0",e.more="1",e.starOff="2",e.starOn="3",e.back="4",e.undo="5",e.redo="6",e.expand="7",e.edit="8",e.play="9",e.toolbarTick="10",e.eye="11",e.addCollaborator="12",e.collaborator="13",e.notification="14",e.discussion="16",e.filter="18",e.wikicatalog="17",e.myCollectedForms="19",e.Unchecked="20",e.Checked="21",e.Smartsheet="22",e.ArrowDown="23",e.NormalSheet="24",e.DashBoard="25",e.SmartsheetDatasource="26",e.External="27"}(R||(R={})),function(e){e[e.normal=0]="normal",e[e.red=1]="red"}(V||(V={})),function(e){e[e.unknown=0]="unknown",e[e.status=1]="status"}(q||(q={})),function(e){e[e.basic=0]="basic",e[e.alert=1]="alert",e[e.success=2]="success",e[e.warning=3]="warning",e[e.error=4]="error"}(Q||(Q={})),function(e){e[e.Back=0]="Back",e[e.Eye=1]="Eye",e[e.Share=2]="Share",e[e.More=3]="More",e[e.Undo=4]="Undo",e[e.Redo=5]="Redo",e[e.AddCollaborator=6]="AddCollaborator",e[e.Collaborator=7]="Collaborator",e[e.Notification=8]="Notification",e[e.MyCollectedForms=9]="MyCollectedForms",e[e.Filter=10]="Filter",e[e.Discussion=11]="Discussion",e[e.WikiCatalog=12]="WikiCatalog",e[e.Unchecked=13]="Unchecked",e[e.Checked=14]="Checked",e[e.SmartSheet=16]="SmartSheet",e[e.ArrowDown=17]="ArrowDown",e[e.NormalSheet=18]="NormalSheet",e[e.DashBoard=19]="DashBoard",e[e.SmartsheetDatasource=20]="SmartsheetDatasource",e[e.External=21]="External"}(J||(J={})),function(e){e.add="add",e.remove="remove",e.rename="rename",e.copy="copy",e.switch="switch",e.move="move"}(G||(G={})),function(e){e[e.ICON=0]="ICON",e[e.TEXT=1]="TEXT"}(X||(X={})),function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE",e[e.DISABLED=2]="DISABLED",e[e.SELECTED=3]="SELECTED"}(H||(H={})),function(e){e[e.gray=0]="gray",e[e.blue=1]="blue"}($||($={})),function(e){e.forward="forward",e.useTemplate="useTemplate",e.learnMore="learnMore"}(z||(z={})),function(e){e[e.empty=0]="empty",e[e.creator=1]="creator",e[e.desc=2]="desc",e[e.descWithLearnMore=3]="descWithLearnMore"}(K||(K={}));var Z,ee=function(){function e(){this.platform=se()}return e.getInstance=function(){return this.instance||(this.instance=new this)},e.prototype.invokeNative=function(n,t){switch(void 0===t&&(t=e.defaultInvokeParams),this.platform){case L.Android:this.invokeAndroid(n,t);break;case L.Mac:case L.IOS:this.invokeMacOrIOS(n,t);break;case L.Windows:this.invokeWindows(n,t);break;case L.Linux:this.invokeLinux(n,t);break;default:console.error("未知的平台")}},e.prototype.invokeAndroid=function(e,n){var t,o,i=JSON.stringify(n);ie?"function"==typeof(null===(t=window.JSCallJavaMgr)||void 0===t?void 0:t.postMessage)?window.JSCallJavaMgr.postMessage(i):console.warn("Not In WeMeet Controller App"):(null===(o=window.JSCallJavaMgr)||void 0===o?void 0:o[e])?window.JSCallJavaMgr[e](i):console.warn("Not In ANDROID WeMeet App")},e.prototype.invokeMacOrIOS=function(e,n){var t,o=null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers,i=o&&o[e];(null==i?void 0:i.postMessage)?i.postMessage(JSON.stringify(n)):console.warn("Not In WeMeet App")},e.prototype.invokeWindows=function(e,n){var t,o=null===(t=window.external)||void 0===t?void 0:t.nativeCall,i=n.module,r=n.method,c=n.param,s=n.callback,a=n.callId;o?o(e,[i,r,c,s,a],(function(){})):console.warn("Not In WeMeet App")},e.prototype.invokeLinux=function(e,n){var t,o=null===(t=window.QtWeb)||void 0===t?void 0:t.JsCall,i=n.module,r=n.method,c=n.param,s=n.callback,a=n.callId;o?o(e,[i,r,c,s,a],(function(){})):console.warn("Not In WeMeet App")},e.defaultInvokeParams={module:"",method:"",param:{},callback:"",callId:""},e}(),ne="undefined"==typeof window;function te(e){return t(this,void 0,void 0,(function(){var n;return o(this,(function(t){switch(t.label){case 0:if(!Z)throw new Error("请先加载sdk");return[4,Z];case 1:return t.sent(),(n={})[j.isWeWork]=de()?window.qmailBridge:ue()?window.wwapp:{},n[j.IsQQ]=window.mqq,n[j.isQQMiniProgram]=window.mqq,n[j.isTencentDocsApp]=window.mqq,n[j.isElectronTencentDocsClient]=window.mqq,n[j.isWXh5]={},n[j.isWeWorkApp]=fe()?window.TenOfficeJSBridge:pe()?window.qmailBridge:window.WeixinJSBridge,n[j.isTencentMeeting]=ee.getInstance(),n[j.UNKNOW]={},[2,n[e]]}}))}))}var oe=E.getUserAgent().includes("app/tencent_wemeet"),ie=E.getUserAgent().includes("app/tencent_wemeet_controller");var re=["log","iosLog","clientDatabaseRequest"];function ce(){var e=j.UNKNOW;return oe?e=j.isTencentMeeting:E.isQQ()||E.isQQMiniProgram()||E.isTencentDocsApp()?e=j.isTencentDocsApp:Y.isElectronTencentDocsClient?e=j.isElectronTencentDocsClient:E.isWXh5()?e=j.isWXh5:E.isWeWork()&&(e=E.isWeWorkMacOrWin()||we()&&E.isWeWorkLinux()?j.isWeWork:j.isWeWorkApp),e}function se(){return E.isAndroid()?L.Android:E.isIOS()?L.IOS:E.isWindows()?L.Windows:E.isMac()?L.Mac:E.isLinux()?L.Linux:void 0}function ae(){var e=E.getLowerCaseUserAgent().match(/wxwork\/([0-9.]*)/);return e?e[1]:""}function ue(){if(we())return E.compareVersion(he(),"2.6.15")>=0;if(E.isMobile())return fe();if(de())return!1;var e=E.compareVersion(ae(),"3.1.18")>=0;return!(e&&p()===v&&E.isMac()&&!/WeComCEF/i.test(E.getUserAgent()))&&e}function le(){return/embeddisk/.test(E.getLowerCaseUserAgent())||E.isMac()&&E.compareVersion(ae(),"4.1.0")>=0}function de(){return!we()&&/WXDrive/i.test(E.getLowerCaseUserAgent())}function fe(){var e,n;return/wdocs/i.test(E.getLowerCaseUserAgent())||E.isIOS()&&!!(null===(n=null===(e=window.webkit)||void 0===e?void 0:e.messageHandlers)||void 0===n?void 0:n.TenOfficeJSBridge)||E.isAndroid()&&!!window.TenOfficeJSBridgeAndroid}function pe(){return!E.isServerSide()&&!window.WeixinJSBridge}function ve(){return!fe()&&(!E.isServerSide()&&(0===location.pathname.indexOf("/forms/")||0===location.pathname.indexOf("/journal/")))}function we(){return/wxworklocal/i.test(E.getLowerCaseUserAgent())}function he(){var e=E.getLowerCaseUserAgent().match(/wxworklocal\/([0-9.]*)/);return e?e[1]:""}function ge(e,n){var i={};return Object.keys(e).forEach((function(c){var s=c,a=e[s];i[s]=function(e,n,i,c){var s=this;return function(a){return void 0===a&&(a={}),t(s,void 0,Promise,(function(){var s,u=this;return o(this,(function(l){switch(l.label){case 0:return[4,te(e)];case 1:if(!(s=l.sent()))throw new Error("当前环境无jssdk，"+e);return[2,new Promise((function(e,l){return t(u,void 0,void 0,(function(){var t,u,d,f,p,v;return o(this,(function(o){a||(a={}),t=Oe(i),u=t.reportSuccess,d=t.reportFail,f=null==a?void 0:a.success,a.success=function(n){null==f||f(n),e(n),u(),console.warn("tdocs call "+i+" success!, res => ",n)},p=null==a?void 0:a.fail,a.fail=function(e){var n;null==p||p(e),l(e),re.includes(i)||null===(n=null==c?void 0:c.log)||void 0===n||n.call(c,{level:"error",message:"tdocs call "+i+" failed! res => "+JSON.stringify(e)}),d({req:a,res:e}),console.error("tdocs call "+i+" fail!, res => "+JSON.stringify(e))};try{v=n(s,a),!(w=v)||"object"!==r(w)&&"function"!=typeof w||"function"!=typeof w.then||v.then(a.success).catch(a.fail)}catch(e){a.fail(e)}var w;return[2]}))}))}))]}}))}))}}(n,a,s,i)})),i}function me(n){var t,o=n.buttons,i=((t={})[R.back]=J.Back,t[R.eye]=J.Eye,t[R.addCollaborator]=J.AddCollaborator,t[R.collaborator]=J.Collaborator,t[R.share]=J.Share,t[R.more]=J.More,t[R.undo]=J.Undo,t[R.redo]=J.Redo,t);E.compareVersion(ae(),"4.0.6")>=0&&(i[R.notification]=J.Notification),E.compareVersion(ae(),"4.0.20")>=0&&(i[R.discussion]=J.Discussion),E.compareVersion(ae(),"4.1.8")>=0&&(i[R.myCollectedForms]=J.MyCollectedForms,i[R.filter]=J.Filter,i[R.wikicatalog]=J.WikiCatalog),E.compareVersion(ae(),"4.1.20")>=0&&(i[R.Unchecked]=J.Unchecked,i[R.Checked]=J.Checked),E.compareVersion(ae(),"4.1.26")>=0&&(i[R.Smartsheet]=J.SmartSheet,i[R.ArrowDown]=J.ArrowDown,i[R.NormalSheet]=J.NormalSheet,i[R.DashBoard]=J.DashBoard),E.compareVersion(ae(),"4.1.28")>=0&&(i[R.SmartsheetDatasource]=J.SmartsheetDatasource,i[R.External]=J.External);var r={0:U.left,1:U.middle,2:U.right},c=[];return o.forEach((function(e){var n,t,o;if(e.type===F.collaborator){var s={id:e.id,type:F.image,icon:R.collaborator===e.url?i[R.collaborator]:J.Eye,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,useAnimation:e.useAnimation,rightIcon:e.rightIcon?i[e.rightIcon]:void 0,badge:""};(null===(n=e.collaborators)||void 0===n?void 0:n.length)&&(null===(t=e.collaborators)||void 0===t?void 0:t.length)>1&&(s.badge=String(e.collaborators.length)),e.badge&&(s.badge=e.badge),c.push(s)}else if(function(e){return e.type===F.image||e.type===F.iconWithText}(e)){var a=i[e.url];if(void 0===a)return;c.push({id:e.id,type:e.type,icon:a,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:e.badge,badgeStyle:e.badgeStyle,text:e.text,useAnimation:e.useAnimation,rightIcon:e.rightIcon?i[e.rightIcon]:void 0})}else c.push({id:e.id,type:e.type,text:null===(o=e)||void 0===o?void 0:o.text,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:e.badge,badgeStyle:e.badgeStyle,useAnimation:e.useAnimation})})),e(e({},n),{buttons:c})}function be(e,n){var t=Oe("consume_cst"),o=t.reportSuccess,i=t.reportFail,r=Object.keys(e).map((function(n){return"wwapp_"+n+"="+encodeURIComponent(e[n])})).join("&");fetch("/cgi/gateway/consume_cst?from_tdocs_jsapi=1&"+r).then((function(e){return e.json()})).then((function(e){var t,i;0===(null==e?void 0:e.retcode)?null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,e):null===(i=null==n?void 0:n.fail)||void 0===i||i.call(n,e),o()})).catch((function(e){var t;null===(t=null==n?void 0:n.fail)||void 0===t||t.call(n,e),i(null==e?void 0:e.message)}))}function ke(e){var n,t,o,i;void 0===e&&(e=location.href);var r=new URL(e),c=r.searchParams.get("docid");if(c)return c;var s=r.searchParams.get("form_id")||r.searchParams.get("formId");if(s)return s;if(r.pathname.startsWith("/smartsheet/form/")&&(null===(t=null===(n=window)||void 0===n?void 0:n.clientVars)||void 0===t?void 0:t.globalPadId))return null===(i=null===(o=window)||void 0===o?void 0:o.clientVars)||void 0===i?void 0:i.globalPadId;var a=/^\/(doc|sheet|forms|slide|flowchart|mind|blankpage|smartsheet|form\/page)\/(j\/)?(.+)\/?/.exec(r.pathname),u=(null==a?void 0:a[3])||"";return"0"===u?"":u}function ye(){return/^\/(doc|sheet|forms|slide|flowchart|mind|mall|blankpage|smartsheet|scenario|form\/page|journal|home)\/(.+)\/?/.exec(location.pathname)}function Ce(e){console.warn("------设置新的cookie-------",e),document.cookie=encodeURIComponent(e.key)+"="+encodeURIComponent(e.value)+(e.expires?"; expires="+e.expires:"")+(e.domain?"; domain="+e.domain:"")+"; path="+(e.path||"/")+(e.secure?"; secure":"")}function We(n){Ce(e(e({},n),{value:"",expires:"Thu, 01 Jan 1970 00:00:00 GMT"}))}function Se(e){var n=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),t=null;return window.document&&(t=window.document.cookie.match(n)),t?decodeURIComponent(t[1]):""}function _e(e){e=""+e;return"[TDOCS]["+(new Date).toLocaleString()+"]["+(ke()||location.pathname)+"]["+(window.__globalReleaseVersion||"")+"] "+e.replace(/(http:\/\/|https:\/\/)?(doc.weixin.qq.com|docs.qq.com)/gi,"TDOC_HOSTNAME")}function Ae(){return window.WeixinJSBridge?Promise.resolve(window.WeixinJSBridge):new Promise((function(e){document.addEventListener("WeixinJSBridgeReady",(function(){e(window.WeixinJSBridge)}))}))}function Te(e){var n,t,o,i;try{e.category="tdocsJSAPI",null===(i=null===(t=null===(n=window.TencentDocReport)||void 0===n?void 0:n.tencentDocReportSDK)||void 0===t?void 0:(o=t.cube).tdw)||void 0===i||i.call(o,e)}catch(e){}}function Ie(e,n){void 0===n&&(n=location.href);try{return new URL(n).searchParams.get(e)}catch(e){return null}}function xe(e){var n,t;try{null===(t=null===(n=window.tencentDocReport)||void 0===n?void 0:n.retcodeEnt)||void 0===t||t.call(n,e)}catch(e){}}function Pe(e){var n=null;return function(t){return n||(n=e(t).then((function(e){return n=null,e})).catch((function(e){throw n=null,e}))),n}}var De=function(){var e,n;return!!(null===(n=null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgent)||void 0===e?void 0:e.includes)||void 0===n?void 0:n.call(e,"wxworkQt"))};function Oe(e,n){void 0===n&&(n=3e3);var t=Date.now(),o=function(n,o){var i=void 0;try{i=o&&JSON.stringify(o)}catch(e){console.error(e)}Te({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:n?"invoke_func_success":"invoke_func_fail",ver7:ae(),ver8:e,ver9:ke()||location.pathname,ver10:ce(),ver11:Date.now()-t,ver12:ve()?1:2,obj3:i})},i=setTimeout((function(){Te({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"invoke_func_timeout",ver7:ae(),ver8:e,ver9:ke()||location.pathname,ver10:ce(),ver11:n}),i=0}),n),r=function(){i&&clearTimeout(i)};return{reportSuccess:function(){o(!0),r()},reportFail:function(e){o(!1,e),r()}}}function Ee(e,t,o,i){var r=o.success,c=o.fail,s=n(o,["success","fail"]);console.log(e,"params",s),t.invoke({func:e,params:s,namespace:i}).then((function(n){console.log(e,"原始res",n),n||(n={code:-1,data:null,msg:"res is empty"}),0===n.code?null==r||r(n.data):2===n.code?null==r||r(null):(console.log(e,"返回code不为0",n.msg,n.code),null==c||c(n.msg,n.code))})).catch((function(e){console.log("调用失败"),null==c||c(e)}))}function Me(e,n,t,o){var i=Le(t);return console.log(e,"params",i),new Promise((function(t,r){n.invoke({func:e,params:i,namespace:o}).then((function(n){void 0===n&&(n={code:-1,data:null,msg:"res is empty"}),0===n.code?t(n.data):(console.log(e,"返回code不为0",n.msg),r(n))})).catch((function(e){console.log("调用失败",e),r(e)}))}))}function je(e,n){return new Promise((function(t){var o;null===(o=window.WeixinJSBridge)||void 0===o||o.invoke(e,Le(n),t)}))}function Le(e){var t=e||{};return t.success,t.fail,n(t,["success","fail"])}function Ne(e,t,o){void 0===o&&(o=!1),Ae().then((function(i){var r=t.success,c=t.fail,s=n(t,["success","fail"]);console.log("[tdocs] invokeWeixinJSBridge func:"+e+" params:",s),null==i||i.invoke(e,s,(function(n){console.log("[tdocs] invokeWeixinJSBridge func:"+e+" resp:",n);try{if(o&&"{}"===JSON.stringify(n))return void(null==r||r(n))}catch(e){}n.err_msg.includes("cancel")?null==r||r(null):n.err_msg.includes("ok")?null==r||r(n):null==c||c(n)}))}))}function Be(n){return e(e({},n),{success:function(e){var t,o,i;"params"in e?null===(t=n.success)||void 0===t||t.call(n,(null===(o=e.params)||void 0===o?void 0:o.data)||{}):null===(i=n.success)||void 0===i||i.call(n,e)}})}function Fe(n){return e(e({},n),{success:function(e){var t,o;"data"in e?null===(t=n.success)||void 0===t||t.call(n,(null==e?void 0:e.data)||{}):null===(o=n.success)||void 0===o||o.call(n,e)}})}var Ue=function(t,o){var i=o.success,r=o.fail,c=n(o,["success","fail"]);return ve()?new Promise((function(n,t){Ne("wwapp.doc.collectionTable.readSystemClipboard",e(e({},o),{success:function(e){var t,o,i,r;n({html:(null===(o=null===(t=null==e?void 0:e.params)||void 0===t?void 0:t.data)||void 0===o?void 0:o.html)||"",plain:(null===(r=null===(i=null==e?void 0:e.params)||void 0===i?void 0:i.data)||void 0===r?void 0:r.plain)||""})},fail:function(e){t(e)}}))})):fe()?t.invoke({func:"readSystemClipboard",params:c}).then((function(e){0===e.code?(i||Promise.resolve)(e.data):(r||Promise.reject)(e.msg)})):void t.readFromPasteBoard().then((function(e){var n;null===(n=o.success)||void 0===n||n.call(o,{html:(null==e?void 0:e.html)||"",plain:(null==e?void 0:e.value)||""})})).catch(o.fail)},Re=function(e,t){if(fe()){var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"writeSystemClipboard",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))}e.writeToPasteBoard({html:t.html||"",value:t.plain||""}).then(t.success).catch(t.fail)},Ve=function(e,n){Ee("isWeDriveEnabled",e,n)},qe=function(e,n){Ee("chooseWeDriveFile",e,n)},Qe=function(e,n){ve()?Ne("wwapp.doc.collectionTable.chooseWeDriveFile",Be(n)):Ee("multiChooseWeDriveFile",e,n)},Je=function(e,n){ve()?Ne("wwapp.doc.collectionTable.chooseTencentOfficeFile",Be(n)):Ee("chooseTencentOfficeFile",e,n)},Ge=function(e,t){if(console.log(e,t),!fe())return e.discuss(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"discuss",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Xe=function(e,n){if(!fe())return e.forwardToConversion(Le(n));Ee("shareDoc",e,n)},He=function(e,n){return Me("fileDownload",e,n)},$e=function(e,n){console.log("开始调用企业微信接口111"),void 0===n.docid&&(n.docid=ke()||void 0),Ee("openCamera",e,n)},ze=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,ae())},Ke=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,E.compareVersion(ae(),(null==n?void 0:n.version)||""))},Ye=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,ue())},Ze=function(e,i){return t(void 0,void 0,Promise,(function(){var t,r,c;return o(this,(function(o){return console.log(e,i),fe()?(t=i.success,r=i.fail,c=n(i,["success","fail"]),[2,e.invoke({func:"onUnload",params:c}).then((function(e){0===e.code?(t||Promise.resolve)(e.data):(r||Promise.reject)(e.msg)}))]):[2,e.onUnload(Le(i))]}))}))},en=function(e,n){return t(void 0,void 0,Promise,(function(){return o(this,(function(t){switch(t.label){case 0:return console.log("addEventListener 开始监听"),[4,te(j.isWeWorkApp)];case 1:return t.sent().addEventListener(e,n),[2]}}))}))},nn=function(e,n){return t(void 0,void 0,Promise,(function(){var t;return o(this,(function(o){switch(o.label){case 0:return[4,te(j.isWeWorkApp)];case 1:return t=o.sent(),console.log("removeEventListener",e),t.removeEventListener(e,n),[2]}}))}))};function tn(e,n){return void 0!==e?e:!!n&&!!Se("wedoc_openid")&&ye()&&(E.isMobile()||E.isMac()?E.compareVersion(ae(),"4.0.10")>=0:E.compareVersion(ae(),"4.0.6")>=0)?1:void 0}function on(e,n){var t=Oe(e.openid?"disklogin_openid":"disklogin"),o=t.reportSuccess,i=t.reportFail,r="/disklogin/login?from_tdocs_jsapi=1&product=2&from=2&f=json&"+Object.keys(e).map((function(n){return"wwapp_"+n+"="+encodeURIComponent(e[n])})).join("&");fetch(r).then((function(e){return e.json()})).then((function(e){var t,c,s,a;0===(null===(t=null==e?void 0:e.head)||void 0===t?void 0:t.ret)?(null===(c=null==n?void 0:n.success)||void 0===c||c.call(n,e),o()):(null===(s=null==n?void 0:n.fail)||void 0===s||s.call(n,e),i(e),xe({url:r,code:(null===(a=null==e?void 0:e.head)||void 0===a?void 0:a.ret)||-1,scene:"backendError"}))})).catch((function(e){var t;null===(t=null==n?void 0:n.fail)||void 0===t||t.call(n,e),i(null==e?void 0:e.message)}))}function rn(e){return!!e&&!!(""+e).match(/^\d+$/)}function cn(e){return!!e&&!(""+e).match(/^\d+$/)&&!(""+e).match(/@/)}function sn(e){return""+e=="4294967304"}var an=function(n,i){return t(void 0,void 0,void 0,(function(){var t,r,c,s,a,u,l,d;return o(this,(function(o){switch(o.label){case 0:return t=tn(i.useOpenid,i.canUseOpenid||!!(null===(u=i.selectedUserOpenIds)||void 0===u?void 0:u.length)||!!(null===(l=i.selectedOpenIds)||void 0===l?void 0:l.length)),fe()?[3,2]:pe()?[2,n.selectPerson(Le(i))]:(r=i.selectedVid||i.selectedUserIds,c=i.selectedOpenIds||i.selectedUserOpenIds,[4,je("wwapp.selectContacts",e(e({docid:ke(),docId:ke()},i),{useOpenid:t,selectedVid:t?void 0:r&&r.filter((function(e){return rn(e)})),selectedOpenIds:t?c||r&&r.filter((function(e){return cn(e)})):void 0}))]);case 1:return s=o.sent(),(null===(d=null==s?void 0:s.selectedContacts)||void 0===d?void 0:d.length)?t?[2,e(e({},s),{successOrNot:!0,notifySelected:s.checkNotice,persons:s.selectedContacts.map((function(n){return e(e({},n),{vid:n.openid,name:n.at_name||n.name})}))})]:[2,e(e({},s),{successOrNot:!0,notifySelected:s.checkNotice,persons:s.selectedContacts.map((function(n){return e(e({},n),{name:n.at_name||n.name})}))})]:[2,Promise.reject(s)];case 2:return t?[4,Me("selectPerson",n,e(e({docid:ke()},i),{useOpenid:t,selectedUserOpenIds:i.selectedUserOpenIds||i.selectedUserIds&&i.selectedUserIds.filter((function(e){return cn(e)})),selectedUserIds:void 0}))]:[2,Me("selectPerson",n,e(e({},i),{selectedUserIds:i.selectedUserIds&&i.selectedUserIds.filter((function(e){return rn(e)}))}))];case 3:return a=o.sent(),[2,e(e({},a),{persons:a.persons&&a.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})]}}))}))},un=function(n,i){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return t=i.openid||i.useOpenid||!rn(i.vid)?1:void 0,void 0===i.docid&&(i.docid=ke()),/_st$/.test(i.docid)||sn(i.openid||i.vid)||t&&E.compareVersion(ae(),"4.0.10")<0?[2,Promise.resolve({})]:t&&!cn(i.openid||i.vid)?[2,Promise.reject({err_msg:(i.openid||i.vid)+" is not openid"})]:fe()?t?[2,Me("viewProfile",n,e(e({},i),{useOpenid:t,openid:i.openid||i.vid,vid:void 0}))]:[2,Me("viewProfile",n,i)]:pe()?[2,n.viewProfile(Le(i))]:t?[2,je("wwapp.openContactProfile",e(e({},i),{useOpenid:t,openid:i.openid||i.vid,vid:void 0}))]:[2,je("wwapp.openContactProfile",e(e({},i),{vid:E.isIOS()?Number(i.vid):i.vid}))]}))}))},ln=function(e,t){if(!fe())return e.updateAuthority(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"updateAuthority",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},dn=function(n,t){var o,i,r=tn(t.useOpenid,!!(null===(o=t.online_users_detail)||void 0===o?void 0:o.find((function(e){return cn(e.openid)}))));Ee("showCollaboratorPanel",n,e(e({docid:ke()},t),{useOpenid:r,online_users_detail:null===(i=t.online_users_detail)||void 0===i?void 0:i.filter((function(e){return r?cn(e.openid):rn(e.uin)}))}))},fn=function(n,t){var o,i,r=tn(t.useOpenid,!!(null===(o=t.online_users_detail)||void 0===o?void 0:o.find((function(e){return cn(e.openid)}))));Ee("updateOnlineUserList",n,e(e({docid:ke()},t),{useOpenid:r,online_users_detail:null===(i=t.online_users_detail)||void 0===i?void 0:i.filter((function(e){return r?cn(e.openid):rn(e.uin)}))}))},pn=function(e,n){Ee("updateAuth",e,n)},vn=function(e,n){console.log("开始调用 initToolbarConfig"),Ee("initToolbarConfig",e,n)},wn=function(e,n){console.log("开始调用 setToolbarConfig"),Ee("updateToolbarConfig",e,n)},hn=function(e,n){console.log("开始调用 showNativeToolbar"),Ee("setNativeToolbarShow",e,n)},gn=function(e,n){console.log("开始调用 updatePanelConfig"),Ee("updateStylePanelConfig",e,n)},mn=function(e,n){console.log("开始调用 showNativePanel"),Ee("setNativePanelShow",e,n)},bn=function(e){var n=e.buttons,t=e.ext;E.compareVersion(ae(),"4.0.8")<0&&n?function(e,n){console.log("[timeline]: handlePolyfillTitleBar",e,n),e.forEach((function(e){if(2!==e.icon){if(3===e.icon){var t=(n||{}).moreMenuClick,o={enable:0===e.state};return t&&(o.onClick=t),void Ne("wwapp.doc.collectionTable.enableMenu",o)}}else{var i=null==n?void 0:n.forwardData;i&&Ne("wwapp.doc.collectionTable.enableTopBarShareIcon",{enable:0===e.state,form_card_msg:i})}}))}(n,t):Ne("wwapp.doc.collectionTable.updateTitlebarIcons",e)},kn=function(e,n){var t;if(console.info("----setActionButtons1-------"),Fn||(null===(t=window.magicBox)||void 0===t?void 0:t.start)){var o=me(n);o=qn(e,o,!1),console.info("----setActionButtons2-------"),console.info(o),console.info(JSON.stringify(o)),ve()?Ne("wwapp.doc.collectionTable.setTitlebarIcons",o):(Bn(),Ln(e,o),Ee("setTitlebarIcons",e,o))}else!function(e,n){if(ve())return Fn={custom:!1,text:""},void kn(e,n);Un(e,{success:function(t){console.error("123123"),t?(Fn=t,kn(e,n)):(console.error("getCustomTopbarButtonConfigAndSetButtons",t),Fn={custom:!1,text:""},kn(e,n))},fail:function(t){console.error("getCustomTopbarButtonConfigAndSetButtons",t),Fn={custom:!1,text:""},kn(e,n)}})}(e,n)},yn=function(e,n){ve()?Ne("wwapp.doc.collectionTable.setTitlebarIcons",n):(Bn(),Ln(e,n),Ee("setTitlebarIcons",e,n))},Cn=function(n,t){ve()?function(e){Ne(E.isAndroid()?"wwapp.doc.collectionTable.updateNavigationBarShadow":"wwapp.updateNavigationBarShadow",{action:e.showMask?"showShadow":"hideShadow",success:function(n){console.log("[tdocsJsapi]formsShowTitlebarMask res:",n),e.onClickMask&&"function"==typeof e.onClickMask&&e.onClickMask()}},!0)}(t):(n.removeEventListener("onUserClickedTitlebarMask"),t.onClickMask&&n.addEventListener("onUserClickedTitlebarMask",t.onClickMask),Ee("showTitlebarMask",n,e(e({},t),{onClickMask:void 0})))},Wn=function(e,n){console.info("-----showMenuActions------"),console.info(n),Nn(e,n),Ee("showMenuActions",e,n)},Sn=function(e,n){console.info("-----showBottomActionSheet------"),console.info(n),function(e,n){console.error(JSON.stringify(n.actions)),0===Object.keys(On).length&&function(e){e.addEventListener("onBottomActionSheetClick",(function(e){var n;console.error("点击回调",e),console.error(On),null===(n=On[e.id])||void 0===n||n.call(On,e)}))}(e);n.actions.forEach((function(e){e.onclick&&(On[e.id]=e.onclick)}))}(e,n),Ee("showBottomActionSheet",e,n)},_n=function(e,n){var t=me(n);t=qn(e,t,!0),console.info("-----updateActionButtons log------"),console.info(t),console.info(JSON.stringify(t)),ve()?bn(t):(Ln(e,t),Ee("updateTitlebarIcons",e,t))},An=function(e,n){ve()?bn(n):(Ln(e,n),Ee("updateTitlebarIcons",e,n))},Tn=function(e,n){if(!fe())return e.setTitle(Le(n));Ee("setWebviewNaviTitle",e,n)},In=function(e,n){console.error("showOnlineUserList, options-------------",n),Ee("showOnlineUserList",e,n)},xn={},Pn=null,Dn={},On={},En=null,Mn={},jn=!1;function Ln(e,n){console.error("--addEventListenerByActionButtonConfig---"),n.buttons.forEach((function(e){e.onclick&&(xn[e.id]=e.onclick)})),function(e){Pn||(Pn=function(e){var n;console.error("点击回调",e),null===(n=xn[e.id])||void 0===n||n.call(xn,e)},console.error(Pn),console.error("init titlebarIconClick"),e.addEventListener("titlebarIconClick",Pn))}(e)}function Nn(e,n){console.error(JSON.stringify(n.actions)),0===Object.keys(Dn).length&&function(e){jn||(e.addEventListener("onMenuActionClick",(function(e){var n;console.error("点击回调",e),console.error(Dn),null===(n=Dn[e.name])||void 0===n||n.call(Dn,e)})),jn=!0)}(e),n.actions.forEach((function(e){e.forEach((function(e){e.onclick&&(Dn[e.name]=e.onclick)}))}))}var Bn=function(){xn={}},Fn=null,Un=function(n,t){console.info("--------------getCustomTopbarButton"),Ee("getCustomTopbarButton",n,e(e({},t),{success:function(e){var n;console.error("345345"),Fn=e,null===(n=null==t?void 0:t.success)||void 0===n||n.call(t,e)}}))},Rn=function(e,n){Ee("onCustomTopbarButtonClick",e,n)},Vn=[];function qn(n,t,o){if(!(null==Fn?void 0:Fn.custom))return t;o?t.buttons.forEach((function(n){var t=Vn.findIndex((function(e){return e.id===n.id}));-1!==t?Vn[t]=e(e({},Vn[t]),n):Vn.push(n)})):Vn=i([],t.buttons);var r=i([],Vn),c=Vn.find((function(e){return e.icon===J.More&&2===e.position&&e.state===B.show}));return c&&(r=r.map((function(n){return 2===n.position?e(e({},n),{state:B.hide}):n}))),r.push({id:"__send__",type:F.text,text:Fn.text||"发送",position:2,state:c?B.show:B.hide,onclick:function(){return Rn(n,{})}}),e(e({},t),{buttons:r})}var Qn=function(){var e;xn={},Dn={},On={},Mn={},Pn=null,null===(e=null===window||void 0===window?void 0:window.TenOfficeJSBridge)||void 0===e||e.__callbackMap.clear(),En=null},Jn=function(e){var n=e.url,t=e.target;Ne("wwapp.doc.collectionTable.openUrl",{url:n,target:void 0===t?N.NativeControl:t})},Gn=function(e,n){var t,o;if(ve())return function(e,n){var t=n.url,o=n.target;if(E.compareVersion(ae(),"4.1.0")<0)try{return o!==N.Direct?void Gn(e,n):o===N.Direct||E.isIOS()?window.location.href=t:window.open(t)}catch(e){return console.log("formsWebviewOpenUrl error",e),window.location.href=t}_.test(n.url)?Jn({url:t,target:N.NativeControl}):Jn(n)}(e,n),void(null===(t=null==n?void 0:n.success)||void 0===t||t.call(n));var i=we()?A.test(n.url):_.test(n.url),r=T.test(n.url);(null==n?void 0:n.url)&&(i||r)&&(n.target=3),fe()?Ee("openDocLink",e,n):pe()?e.openDocLink(Le(n)).then(n.success).catch(n.fail):null===(o=window.WeixinJSBridge)||void 0===o||o.invoke("wwapp.openUrl",Le(n),n.success)},Xn=function(e,n){ve()?Ne("wwapp.closeCurrentWebview",n):Ee("popBack",e,n)},Hn=function(e,n){ve()?Ne("wwapp.doc.collectionTable.closeWebView",n):Ee("closeFormAndTemplate",e,n)},$n=function(e,n){var t;console.log(e),fe()?Ee("previewImage",e,n):pe()?e.previewImage(Le(n)).then(n.success).catch(n.fail):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.previewImages",{imageUrls:n.images,curIndex:n.currentIndex,editable:!1},n.success)},zn=function(e,n){console.log("开始调用callWxWorkAppApi"),Ee("savePublicImg",e,n)},Kn=function(e,n){if(console.log("开始调用chooseimage"),!fe())return e.chooseImage(Le(n));void 0===n.docid&&(n.docid=ke()||void 0),Ee("multipleImagePicker",e,n)},Yn=function(e,n){var t;fe()?Ee("previewFiles",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.doc.previewFiles",Le(n),n.success)},Zn=function(e,n){var t;fe()?Ee("preloadData",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.doc.preloadData",Le(n),n.success)},et=function(e,t){if(!fe())return e.showNativeToast(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"showNativeToast",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},nt=function(e,t){if(!fe())return e.notifyCommentActionToNative(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"notifyCommentActionToNative",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},tt=function(e,n){fe()?Ee("notifyEmojiCommentToNative",e,n):e.notifyEmojiCommentToNative(Le(n)).then(n.success).catch(n.fail)},ot=function(e,t){if(!fe())return e.allCommentPanelCountUpdated(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"allCommentPanelCountUpdated",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},it=function(e,t){if(!fe())return e.showNativeAllCommentPanel(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"showNativeAllCommentPanel",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},rt=function(e,t){if(!fe())return e.launchCommentInput(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"launchCommentInput",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},ct=function(e,t){if(!fe())return e.showEmojiActionPanel(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"showEmojiActionPanel",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},st=function(e,n){Ee("showNativeSingleCommentPanel",e,n)},at=function(e,n){Ee("hideNativeSingleCommentPanel",e,n)},ut=function(e,n){Ee("notifyDocChange",e,n)},lt=function(e,n){Ee("updateMessageQuoteStatus",e,n)},dt=function(n,t){ve()?Ne("wwapp.doc.collectionTable.clearUnread",e(e({},t),{docId:t.docid})):Ee("clearDocUnread",n,t)},ft=function(n,t){var o,i;if(ve())Ne("wwapp.doc.collectionTable.showDiscussion",e(e({},t),{docId:t.docid}));else{var r=tn(t.useOpenid,!!(null===(o=t.online_users_detail)||void 0===o?void 0:o.find((function(e){return cn(e.openid)}))));Ee("showDiscussion",n,e(e({docid:ke()},t),{useOpenid:r,online_users_detail:null===(i=t.online_users_detail)||void 0===i?void 0:i.filter((function(e){return r?cn(e.openid):rn(e.uin)}))}))}},pt=function(n,t){ve()?Ne("wwapp.doc.collectionTable.hideDiscussion",e(e({},t),{docId:t.docid})):Ee("hideDiscussion",n,t)},vt=function(n,t){ve()?Ne("wwapp.doc.collectionTable.updateDiscussion",e(e({},t),{docId:t.docid})):Ee("updateDiscussion",n,t)},wt=function(e,n){Ee("queryLatestUnreadMsg",e,n)},ht=function(e,n){Ee("queryConversationUnread",e,n)},gt=function(n,t){ve()?Ne("wwapp.doc.collectionTable.getRedPointMsgList",Be(e(e({},t),{docId:t.docid}))):Ee("getRedPointMsgList",n,t)},mt=function(e,n){fe()?Ee("getConversationMsgList",e,n):Ae().then((function(){var e;null===(e=window.WeixinJSBridge)||void 0===e||e.invoke("wwapp.doc.collectionTable.getConversationMsgList",Le(n),(function(e){var t,o,i,r;(null===(o=null===(t=null==e?void 0:e.params)||void 0===t?void 0:t.data)||void 0===o?void 0:o.json_strings)?null===(i=n.success)||void 0===i||i.call(n,e.params.data):null===(r=n.fail)||void 0===r||r.call(n,e)}))}))},bt=function(e,n){Ee("insertWxworkGroupChat",e,n)},kt=function(e,n){Ee("isInWxworkGroupChat",e,n)},yt=function(e,n){Ee("joinWxworkGroupChat",e,n)},Ct=function(e,n){Ee("enterWxworkGroupChat",e,n)},Wt=function(e,n){Ee("createWxworkNameCardSelf",e,n)},St=function(e,n){Ee("enterWxworkNameCard",e,n)},_t=function(e,n){Ee("canChatWithWxworkNameCard",e,n)},At=function(e,n){Ee("createWxworkCalender",e,n)},Tt=function(e,n){Ee("selectWxworkCalenderList",e,n)},It=function(e,n){Ee("viewDetailWxworkCalender",e,n)},xt=function(e,n){Ee("queryWxworkCalenderInfo",e,n)},Pt=function(e,n){Ee("joinWxworkCalender",e,n)},Dt=function(e,n){Ee("createTransferedChatMessageInfo",e,n)},Ot=function(e,n){Ee("openChatMessageDetail",e,n)},Et=function(e,n){Ee("insertApp",e,n)},Mt=function(e,n){Ee("openMiniProgram",e,n)},jt=function(e,n){ve()?Ne("startGroupChat",n):Ee("startGroupChat",e,n)},Lt=function(e,t){if(!fe())return e.vibration(Le(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"vibration",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Nt=function(e,n){Ee("vibrateDevice",e,n)},Bt=function(n,t){var o=tn(t.useOpenid,t.canUseOpenid);fe()?Ee("getAppCookies",n,e(e({docid:ke(),useOpenid:o},t),{success:function(e){var n;e&&o&&e.wedoc_openid&&!e.openid&&(e.openid=e.wedoc_openid),null===(n=t.success)||void 0===n||n.call(t,e)}})):Ae().then((function(n){return null==n?void 0:n.invoke("wwapp.exchangeST",e(e({docid:ke()},t),{useOpenid:o}),(function(e){var n,o,i,r;(null===(o=null===(n=null==e?void 0:e.err_msg)||void 0===n?void 0:n.includes)||void 0===o?void 0:o.call(n,"ok"))?null===(i=null==t?void 0:t.success)||void 0===i||i.call(t,e):null===(r=null==t?void 0:t.fail)||void 0===r||r.call(t,e)}))}))};function Ft(e,n,t){try{if(E.isIOS()){var o=Se("wedoc_skey"),i=(null==e?void 0:e.wedoc_skey)||"";(o.indexOf("%")>-1||i.indexOf("%")>-1)&&Te({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"ios_skey_encode_error_"+t,ver7:ae(),ver8:o,obj3:i,ver9:ke()||location.pathname,ver10:ce(),ver11:n?1:0,ver12:Ut()})}}catch(e){}}function Ut(){var e=navigator.userAgent.match(/iPhone OS ([\d_]+)/);return e?e[1]:""}var Rt,Vt=function(n,t){var o,i;if(console.warn("----------客户端开始续票--------"),i=["uid","uid_key","wedrive_sid","wedrive_skey","wedrive_ticket","wedrive_uin","tdoc_sid","tdoc_skey","tdoc_vid","wedoc_sid","wedoc_skey","wedoc_ticket","tdoc_uid"],g.forEach((function(e){i.forEach((function(n){We({key:n,domain:e===p()?"":e,path:"/"})}))})),fe()||!pe()||(n.docLogin().then((function(){return be({},t)})).catch(t.fail),!(null===(o=n.hasReceivedMsgFromNative)||void 0===o?void 0:o.call(n)))){console.warn("----------开始续票--------");var r=fe()&&!1!==t.isAutoSetLoginState,c=tn(t.useOpenid,!0),s=Oe("getLoginCst"),a=s.reportSuccess,u=s.reportFail,l=!1;"D0000000000000000"===ke()&&setTimeout((function(){var e;!l&&(null===(e=t.fail)||void 0===e||e.call(t,{msg:"timeout for D0000000000000000"}))}),2e3),Bt(n,e(e({docid:ke(),useOpenid:c,canUseOpenid:!0},t),{isAutoSetLoginState:r,success:function(n){console.warn("----------跟客户端交互成功--------",n),r?setTimeout((function(){var o,i=!Se("wedrive_ticket")&&!Se("wedoc_ticket");if(Ft(n,i,"before"),i){console.warn("----------客户端种票失败--------");var r={cst:!0,deviceid:!0,vid:!0,openid:!0},s=h;if(console.warn("----------前端自己种票了--------"),Object.keys(n).forEach((function(e){r[e]||Ce({key:e,value:n[e],domain:s,path:"/"})})),E.isWeWork()&&E.isIOS()){var a=parseInt(Ut().split("_")[0],10),u=!Number.isNaN(a)&&a<=12;if(console.warn("----------iOS系统版本--------",a,u),u){return console.warn("----------iOS12以下系统，前端自己种票失败，重新调用cgi--------"),void on(e({cst:n.cst,deviceid:n.deviceid},c&&n.openid?{openid:n.openid}:{vid:n.vid}),t)}}Ft(n,i,"after")}null===(o=t.success)||void 0===o||o.call(t,n)}),150):on(e({cst:n.cst,deviceid:n.deviceid},c&&n.openid?{openid:n.openid}:{vid:n.vid}),t),a(),l=!0},fail:function(e){var n;null===(n=t.fail)||void 0===n||n.call(t,e),u(e),l=!0}}))}},qt=function(n,t){var o,i=_e(t.message||""),r=t.level||"info";return ve()?null===(o=null==t?void 0:t.success)||void 0===o?void 0:o.call(t):fe()?void(E.isIOS()&&E.compareVersion(ae(),"4.0.20")>0?Ee("iosLog",n,e(e({},t),{level:r,message:i})):Ee("log",n,e(e({},t),{level:r,message:i}))):n.localLog(Le(e(e({},t),{level:r,message:i})))},Qt=function(e,n){Ee("emitEvent",e,n,"magicbox")},Jt=function(e,n){Ee("clientMutexLock",e,n,"docx")},Gt=function(e,n){Ee("mapDocumentVersion",e,n,"docx")},Xt=function(e,n){Ee("removeDocumentVersion",e,n,"docx")},Ht=function(e,t){var o=t.success,i=t.fail,r=n(t,["success","fail"]);e.invoke({func:"getOfflineLocalConfig",params:r,namespace:"docx"}).then((function(e){null==o||o(e)})).catch((function(e){console.log("调用失败"),null==i||i(e)}))},$t=function(e,n){Ee("isOfflineBidAvailable",e,n,"docx")},zt=function(e,n){Ee("notifyNative",e,n,"docx")},Kt=function(e,n){Ee("manualSaveDocData",e,n,"docx")},Yt=function(e,n){Ee("preloadJsReady",e,n,"docx")},Zt=function(e,n){var t=n.urls,o=n.success,i=n.fail,r="documentUrlReplace";e.invoke({func:r,params:t,namespace:"docx"}).then((function(e){void 0===e&&(e={code:-1,data:null,msg:"res is empty"}),0===e.code?null==o||o(e.data):(console.log(r,"返回code不为0",e.msg),null==i||i(e.msg))})).catch((function(e){console.log("调用失败"),null==i||i(e)}))},eo=function(e,n){Ee("firstLoadFinished",e,n,"docx")},no=function(e,n){ve()?Ne("wwapp.doc.collectionTable.requestFocus",n):Ee("requestFocus",e,n)},to=function(t,o){if(ve()){var i=o.success,r=n(o,["success"]);Ne("wwapp.selectGroupChat",e(e({},r),{success:function(n){return"string"==typeof n.selectedConversationIdList&&n.selectedConversationIdList?null==i?void 0:i(e(e({},n),{selectedConversationIdList:JSON.parse(n.selectedConversationIdList)})):null==i?void 0:i(n)}}))}else Ee("selectGroupChat",t,o)},oo=function(e,n){ve()?Ne("journalStatisticShowPersonPicker",Fe(n)):Ee("journalStatisticShowPersonPicker",e,n)},io=function(e,n){ve()?Ne("journalStatisticShowDatePicker",Fe(n)):Ee("journalStatisticShowDatePicker",e,n)};!function(e){e.NotGroup="0",e.Group="1"}(Rt||(Rt={}));var ro;!function(e){e[e.Read=0]="Read",e[e.Write=1]="Write",e[e.Statistic=2]="Statistic"}(ro||(ro={}));var co=function(n,t){ve()?Ne("wwapp.selectCorpGroupContact",e(e({},t),{seizeParams:!0})):Ee("selectCorpGroupContact",n,t)},so=function(n,t){ve()?Ne("wwapp.doc.collectionTable.notifyJournalSubmitted",e(e({},t),{seizeParams:!0})):Ee("notifyJournalSubmitted",n,t)},ao=function(n,t){var o,i;ve()?Ne("previewFile",e(e({},t),{name:null===(o=t.name)||void 0===o?void 0:o.replace(/[/\\?%*|"<>:]/g,"-")})):Ee("previewFile",n,e(e({},t),{name:null===(i=t.name)||void 0===i?void 0:i.replace(/[/\\?%*|"<>:]/g,"-")}))},uo={didPublishWorkLog:function(e,n){Ee("didPublishWorkLog",e,n)},openTencentOfficeFromTemplate:function(e,n){Ee("wwapp.tdoc.openTencentOfficeFromTemplate",e,n)},openWorklogTemplate:function(e,t){!function(e,t,o,i){var r=o.success,c=o.fail,s=n(o,["success","fail"]);console.log(e,"params",s),E.isIOS()?t.invoke(e,s,r):t.invoke({func:e,params:s,namespace:i}).then((function(n){0===n.code?null==r||r(n.data):(console.log(e,"返回code不为0",n.msg),null==c||c(n.msg,n.code))})).catch((function(e){console.log("调用失败"),null==c||c(e)}))}("wwapp.doc.worklog.openWorklogTemplate",e,t)},selectGroupChat:to,shareCustomCard:function(e,n){Ee("shareCustomCard",e,n)},journalStatisticsShowPersonPicker:oo,journalStatisticsShowDatePicker:io,journalJumpToStat:function(e,n){Ee("jumpToStat",e,n)},journalJumpToManagement:function(e,n){Ee("jumpToManagement",e,n)},journalSendToGroupChat:function(e,n){Ee("journalSendToGroupChat",e,n)},openDocOrNormalOrJournal:function(e,n){Ee("openDocOrNormalOrEditWorklog",e,n)},sendTemplateInviteCard:function(e,n){Ee("sendTemplateInviteCard",e,n)},selectCorpGroupContact:co,getWecomSetting:function(e,n){Ee("getWecomSetting",e,n)},selectCorpGroupContactNative:function(e,n){Ee("selectCorpGroupContactNative",e,n)},notifyJournalSubmitted:so},lo={previewFile:ao},fo={selectGroupChat:to,notifyJournalSubmitted:so,journalStatisticsShowDatePicker:io,journalStatisticsShowPersonPicker:oo},po=function(e,n){var t;fe()?Ee("wwapp.tdoc.getTemplateSegmentName",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.tdoc.getTemplateSegmentName",Le(n),n.success)},vo=function(e,n){var t;fe()?Ee("wwapp.tdoc.getMobileTemplateFromPage",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.tdoc.getMobileTemplateFromPage",Le(n),n.success)},wo=function(e,n){fe()?Ee("chooseImage",e,n):Ne("chooseImage",n)},ho=function(n,t){fe()?Ee("updateTimelineConv",n,t):Ne("wwapp.doc.collectionTable.updateTimelineConv",e(e({},t),{docId:t.docid}))},go={chooseWeDriveDir:function(e,n){fe()?Ee("chooseWeDriveDir",e,n):Ne("wwapp.doc.collectionTable.chooseWeDriveDir",Be(n))},selectImgFromImagePickerOrFileFromFav:function(e,n){fe()?Ee("selectImgFromImagePickerOrFileFromFav",e,n):Ne("wwapp.selectImgFromImagePickerOrFileFromFav",n)},saveFileToDrive:function(e,n){fe()?Ee("saveFileToDrive",e,n):Ne("wwapp.doc.collectionTable.saveFileToDrive",Be(n))},getLocalImgData:function(e,n){fe()?Ee("getLocalImgData",e,n):Ne("getLocalImgData",n)},openLocation:function(n,t){var o=t.longitude,i=t.latitude,r=e(e({},t),{longitude:""+o,latitude:""+i});fe()?(E.isIOS()&&E.compareVersion(ae(),"4.1.9")<=0&&(r.longitude=+o,r.latitude=+i,r.longtitude=+o),Ee("openLocation",n,r)):Ne("openLocation",e(e({},r),{longitude:+o,latitude:+i}))},selectLocation:function(e,n){fe()?Ee("selectLocation",e,n):Ne("wwapp.selectLocation",n)},shareWechatMessage:function(e,n){fe()?Ee("shareWechatMessage",e,n):Ne("shareWechatMessage",n)},forwardBySchoolNotification:function(e,n){fe()?Ee("forwardBySchoolNotification",e,n):Ne("wwapp.forwardBySchoolNotification",n)},selectEnterpriseContacts:function(e,n){fe()?Ee("selectEnterpriseContacts",e,n):Ne("selectEnterpriseContact",n)},selectContacts:function(n,t){fe()?Ee("selectContacts",n,t):Ne("wwapp.selectContacts",e(e({},t),{docId:t.docid}))},openEnterpriseContact:function(e,n){fe()?Ee("openEnterpriseContact",e,n):Ne("wwapp.openEnterpriseContact",n)},openSchoolNodeProfile:function(e,n){fe()?Ee("openSchoolNodeProfile",e,n):Ne("wwapp.openSchoolNodeProfile",n)},selectHomeSchoolNode:function(e,n){fe()?Ee("selectHomeSchoolNode",e,n):Ne("wwapp.selectHomeSchoolNode",n)},genRoomChatTicket:function(e,n){fe()?Ee("genRoomChatTicket",e,n):Ne("wwapp.doc.collectionTable.genRoomChatTicket",n)},getTimelineStatus:function(n,t){fe()?Ee("getTimelineStatus",n,t):Ne("wwapp.doc.collectionTable.getTimelineStatus",Be(e(e({},t),{docId:t.docid})))},setTimelineStatus:function(n,t){fe()?Ee("setTimelineStatus",n,t):Ne("wwapp.doc.collectionTable.setTimelineStatus",e(e({},t),{docId:t.docid}))},updateTimelineConv:ho,onReceiveEvent:function(e,n){fe()?Ee("onReceiveEvent",e,n):Ne("wwapp.doc.collectionTable.onReceiveEvent",n)},geoLocation:function(e,n){fe()?Ee("geoLocation",e,n):Ne("geoLocation",n)},checkForwardBySchoolNotification:function(n,t){fe()?Ee("checkForwardBySchoolNotification",n,e(e({},t),{success:function(e){var n,o;1===e.canUse?null===(n=null==t?void 0:t.success)||void 0===n||n.call(t,!0):null===(o=null==t?void 0:t.success)||void 0===o||o.call(t,!1)}})):Ne("wwapp.checkJsApi",e(e({},t),{funcName:"wwapp.forwardBySchoolNotification",success:function(e){var n,o;1===e.canUse||0===e.canUse?null===(n=null==t?void 0:t.success)||void 0===n||n.call(t,!0):null===(o=null==t?void 0:t.success)||void 0===o||o.call(t,!1)}}))}},mo=function(e,n){fe()?Ee("showEmojiPanel",e,n):Ne("wwapp.doc.collectionTable.showEmojiPanel",n)},bo=function(e,n){fe()?Ee("toggleEmojiPanel",e,n):Ne("wwapp.doc.collectionTable.toggleEmojiPanel",n)},ko=function(e,n){fe()?Ee("keepEmojiPanel",e,n):Ne("wwapp.doc.collectionTable.keepEmojiPanel",n)},yo=function(e,n){fe()?Ee("showOrHideLoading",e,n):Ne("wwapp.doc.collectionTable.showOrHideLoading",n)},Co=function(n,t){var o=e(e({},t),{form_card_msg:t.formCardMsg,is_form_url:!!t.formCardMsg}),i=o.forwardRoomIds?"shareAppMessageWithRoomId":"shareAppMessage";Array.isArray(o.forwardRoomIds)&&(Y.isAndroid?o.forwardRoomIds=o.forwardRoomIds.map((function(e){return""+e})):o.forwardRoomIds=o.forwardRoomIds.map((function(e){return+e}))),fe()?Ee(i,n,o):Ne(i,o)},Wo={showEmojiPanel:mo,toggleEmojiPanel:bo,keepEmojiPanel:ko,forwardFormsToWXWork:Co,updateTimelineConv:ho},So={},_o=null;function Ao(e,n){n.buttons.forEach((function(e){e.onClick&&(So[e.id]=e.onClick)})),n.content.learnMoreId&&n.content.onLearnMoreBtnClick&&(So[n.content.learnMoreId]=n.content.onLearnMoreBtnClick),n.onBottomBarVisibilityChange&&e.addEventListener("templateBottomBarVisibilityChange",n.onBottomBarVisibilityChange),console.log("showTemplateBottomBar --addEventListenerByActionButtonConfig---",So),function(e){_o||(_o=function(e){var n;console.log("showTemplateBottomBar 点击 showTemplateBottomBar 回调",e),null===(n=So[e.id])||void 0===n||n.call(So,e)},console.log("showTemplateBottomBar init templateBottomBarButtonClick",So),e.addEventListener("templateBottomBarButtonClick",_o))}(e)}var To=E.compareVersion(ae(),"3.1.20")>=0,Io=E.compareVersion(ae(),"3.1.23")>=0,xo=E.compareVersion(ae(),"4.0.0")>=0,Po=E.compareVersion(ae(),"4.0.2")>=0,Do=E.compareVersion(ae(),"4.0.6")>=0,Oo=E.compareVersion(ae(),"4.0.8")>=0,Eo=E.compareVersion(ae(),"4.0.16")>=0,Mo=E.compareVersion(ae(),"4.0.18")>=0,jo=E.compareVersion(ae(),"4.0.20")>=0,Lo=E.compareVersion(ae(),"4.1.0")>=0,No=E.compareVersion(ae(),"4.1.2")>=0,Bo=E.compareVersion(ae(),"4.1.6")>=0,Fo=E.compareVersion(ae(),"4.1.8")>=0,Uo=E.compareVersion(ae(),"4.1.10")>=0,Ro=E.compareVersion(ae(),"4.1.12")>=0,Vo=E.compareVersion(ae(),"4.1.20")>=0,qo=E.compareVersion(ae(),"4.1.22")>=0,Qo=E.compareVersion(ae(),"4.1.26")>=0,Jo=E.compareVersion(ae(),"4.1.28")>=0,Go=E.compareVersion(ae(),"4.1.30")>=0,Xo=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e({clean:Qn,isWeDriveEnabled:Ve,chooseWeDriveFile:qe,multiChooseWeDriveFile:Qe,chooseTencentOfficeFile:Je,getClipboardData:Ue,setClipboardData:Re,fileDownload:He,getAppVersion:ze,compare:Ke,isNewWwapp:Ye,openCamera:$e,quoteToDiscuss:Ge,forwardToConversion:Xe,showNativePanel:mn,updatePanelConfig:gn,initToolbarConfig:vn,showNativeToolbar:hn,updateToolbarConfig:wn,setTitle:Tn,showOnlineUserList:In,getCustomTopbarButtonConfig:Un,onCustomTopbarButtonClick:Rn,viewProfile:un,onUnload:Ze,selectPerson:an,openUrl:Gn,popBack:Xn,saveImage:zn,previewImage:$n,chooseImage:Kn,chooseImagePicker:wo,setActionButtons:kn,showMenuActions:Wn,showBottomActionSheet:Sn,updateActionButtons:_n,showNativeToast:et,notifyCommentActionToNative:nt,notifyEmojiCommentToNative:tt,allCommentPanelCountUpdated:ot,showNativeAllCommentPanel:it,launchCommentInput:rt,showEmojiActionPanel:ct,vibration:Lt,updateAuthority:ln,wdocsUpdateAuthority:ln,getLoginCst:Bt,docLogin:Vt,log:qt,sendMagicBoxMsg:Qt,getClientMutexLock:Jt,mapDocumentVersion:Gt,removeDocumentVersion:Xt,getOfflineLocalConfig:Ht,isOfflineBidAvailable:$t,preloadJsReady:Yt,manualSaveDocData:Kt,notifyNative:zt,firstLoadFinished:eo,documentUrlReplace:Zt,requestFocus:no},To?{insertWxworkGroupChat:bt,isInWxworkGroupChat:kt,joinWxworkGroupChat:yt,enterWxworkGroupChat:Ct,createWxworkNameCardSelf:Wt,enterWxworkNameCard:St,canChatWithWxworkNameCard:_t,joinWxworkCalender:Pt,queryWxworkCalenderInfo:xt,createWxworkCalender:At,selectWxworkCalenderList:Tt,viewDetailWxworkCalender:It,openChatMessageDetail:Ot,createTransferedChatMessageInfo:Dt,clearDocUnread:dt,showDiscussion:ft,hideDiscussion:pt,updateDiscussion:vt,showCollaboratorPanel:dn}:{}),Io?{showNativeSingleCommentPanel:st,hideNativeSingleCommentPanel:at,updateOnlineUserList:fn,notifyDocChange:ut,updateMessageQuoteStatus:lt}:{}),xo?{insertApp:Et,openMiniProgram:Mt}:{}),Po?{updateAuth:pn}:{}),Po&&E.isIOS()?{vibrateDevice:Nt}:{}),Do?{queryLatestUnreadMsg:wt,queryConversationUnread:ht,getRedPointMsgList:gt,clientDatabaseRequest:function(e,n){var t=n.success;n.success=function(e){(null==e?void 0:e.result)&&(null==t||t(e)),null==t||t({result:e})},Ee("clientDatabaseRequest",e,n,"docx")}}:{}),Oo&&E.isIOS()?{setBounces:function(e,n){Ee("setBounces",e,n)}}:{}),Oo?{waitForClientLoadingClosed:function(e,n){var t,o=new Promise((function(e){t=setTimeout((function(){e(void 0),console.log("waitForClientLoadingClosed 超时了")}),n.timeout)})),i=new Promise((function(n){e.addEventListener("loadingClosed",(function o(){n(void 0),clearTimeout(t),console.log("waitForClientLoadingClosed 客户端回调蒙层消失"),e.removeEventListener("loadingClosed",o)}))}));return Promise.race([o,i])},setTitlebarIcons:yn,updateTitlebarIcons:An}:{}),Eo?e(e({},uo),{startGroupChat:jt}):{}),Mo?e({showTitlebarMask:Cn,showDocSharePanel:function(e,n){Ee("showDocSharePanel",e,n)},showAdvancedFunc:function(e,n){Ee("wwapp.showAdvancedFunc",e,n)}},lo):{}),jo?{previewFiles:Yn,getTemplateSegmentName:po}:{}),jo&&E.isIOS()?{getMobileTemplateFromPage:vo}:{}),Lo?{importFromTencentOffice:function(e,n){Ee("importFromTencentOffice",e,n)},importFromWechatFile:function(e,n){Ee("importFromWechatFile",e,n)},getConversationMsgList:mt}:{}),No?{preloadData:Zn,updateMenuActions:function(e,n){console.info("-----updateMenuActions------"),console.info(n),Nn(e,n),Ee("updateMenuActions",e,n)},onlyDownloadFile:function(e,n){return Me("onlyDownloadFile",e,n)},saveToWedriveByLocalPath:function(e,n){return Me("saveToWedriveByLocalPath",e,n)},openWithOtherAppByLocalPath:function(e,n){return Me("openWithOtherAppByLocalPath",e,n)},importFromLocal:function(e,n){Ee("importFromLocal",e,n)},selectWxworkMeetingList:function(e,n){Ee("selectWxworkMeetingList",e,n)},viewDetailWxworkMeeting:function(e,n){Ee("viewDetailWxworkMeeting",e,n)},enterWxworkMeeting:function(e,n){Ee("enterWxworkMeeting",e,n)},joinWxworkMeeting:function(e,n){Ee("joinWxworkMeeting",e,n)}}:{}),Bo?{notifyNativeRefetchDocInfo:function(e,n){Ee("notifyNativeRefetchDocInfo",e,n)},closeCommentInput:function(e,n){Ee("closeCommentInput",e,n)},getNativeWebViewSize:function(e,n){return Me("getNativeWebViewSize",e,n)},disableOfflinePackage:function(e,n){Ee("disableOfflinePackage",e,n,"docx")}}:{}),Fo?e(e(e({},Wo),go),{closeFormAndTemplate:Hn,showNewWikiDocActionSheet:function(e,n){Ee("showNewWikiDocActionSheet",e,n)},showWikiCatalogPanel:function(e,n){Ee("showWikiCatalogPanel",e,n)},switchWikiDoc:function(e,n){Ee("switchWikiDoc",e,n)},getWikiMemberCount:function(e,n){Ee("getWikiMemberCount",e,n)},showWikiMemberPage:function(e,n){Ee("showWikiMemberPage",e,n)},getDisplayFontSize:function(e,n){return Me("getDisplayFontSize",e,n)},sendDocApplyToConversation:function(e,n){Me("sendDocApplyToConversation",e,n)},showOrHideLoading:yo}):{}),Fo&&E.isAndroid()?{getAndroidNativeScreenSize:function(e,n){Ee("getNativeScreenSize",e,n,"docx")},getAndroidDeviceInfo:function(e,n){Ee("getDeviceInfo",e,n,"docx")}}:{}),Uo?{selectLocation:function(e,n){Ee("selectLocation",e,n)},openLocation:function(e,n){Ee("openLocation",e,n)},showTelAlert:function(n,t){Ee("showTelAlert",n,e({appid:200001},t))},showMailWritePage:function(e,n){Ee("showMailWritePage",e,n)},getTransactionIds:function(n,t){Ee("getTransactionIds",n,e({command:"beginTransaction"},t),"docx")}}:{}),Uo&&E.isIOS()?{setDocumentSSR:function(e,n){Ee("setDocumentSSR",e,n,"docx")},getDocumentSSR:function(e,n){Ee("getDocumentSSR",e,n,"docx")},removeDocumentSSR:function(e,n){Ee("removeDocumentSSR",e,n,"docx")}}:{}),Ro?{createSheetRangeAuth:function(e,n){return Me("createSheetRangeAuth",e,n)},showSheetRangeAuthList:function(e,n){return Me("showSheetRangeAuthList",e,n)},getNavigationBarHeight:function(e,n){Ee("getNativeNavigationBarHeight",e,n)}}:{}),Vo?{openMyDocListPage:function(e,n){Ee("openMyDocListPage",e,n)},getWeworkInfo:function(e,n){var t=n.success;n.success=function(e){var n;e.englishName=null!==(n=e.englishName)&&void 0!==n?n:e.english_name,null==t||t(e)},Ee("getSelfUserInfo",e,n)},showTimelineDocMenu:function(e,n){return Me("showTimelineDocMenu",e,n)},addExistingDocToWiki:function(e,n){Ee("addExistingDocToWiki",e,n)},openSecurityApplication:function(e,n){return Me("openSecurityApplication",e,n)},scanQRCode:function(e,n){console.log("开始调用 scanQRCode",n),fe()?Ee("scanQRCode",e,n):Ne("scanQRCode",n)}}:{}),Vo&&E.isIOS()?{shouldShowOrHideFormToolbar:function(e,n){console.log("开始调用 shouldShowOrHideFormToolbar",n),fe()?Ee("shouldShowOrHideFormToolbar",e,n):Ne("shouldShowOrHideFormToolbar",n)},setFormToolbarIcons:function(e,n){console.log("开始调用 setFormToolbarIcons",n),fe()?Ee("setFormToolbarIcons",e,n):Ne("setFormToolbarIcons",n)},updateFormToolbarIcons:function(e,n){console.log("开始调用 updateFormToolbarIcons",n),fe()?Ee("updateFormToolbarIcons",e,n):Ne("updateFormToolbarIcons",n)}}:{}),qo?{getDocumentVersion:function(e,n){Ee("getDocumentVersion",e,n,"docx")},getBidInfo:function(e,n){Ee("getBidInfo",e,n,"docx")},getDocMemberInfo:function(e,n){Ee("getDocMemberInfo",e,n)},foldToMinimize:function(e,n){Ee("foldToMinimize",e,n)},isMinimizeEnabled:function(e,n){Ee("isMinimizeEnabled",e,n)},modifyFormViewShareSetting:function(e,n){Ee("modifyFormViewShareSetting",e,n)},prefetchFormViewShareSetting:function(e,n){Ee("prefetchFormViewShareSetting",e,n)},showSmartsheetDotMenu:function(e,n){Ee("showSmartsheetDotMenu",e,n)}}:{}),Qo?{smartsheetWebDataReady:function(e,n){Ee("smartsheetWebDataReady",e,n)},smartsheetConfigSubTableMsgPanel:function(e,n){Ee("smartsheetConfigSubTableMsgPanel",e,n)},smartsheetShowViewSetting:function(e,n){Ee("smartsheetShowViewSetting",e,n)},closeSmartsheetViewSettingPanel:function(e,n){Ee("closeSmartsheetViewSettingPanel",e,n)},smartsheetUpdateViewSetting:function(e,n){Ee("smartsheetUpdateViewSetting",e,n)},smartSheetShowNormalLayout:function(e,n){Ee("smartSheetShowNormalLayout",e,n)},setSmartsheetFloatingButtonStyle:function(e,n){Ee("setSmartsheetFloatingButtonStyle",e,n)},setSmartsheetFloatingButtonOffset:function(e,n){Ee("setSmartsheetFloatingButtonOffset",e,n)},smartsheetWebSubTablesOperation:function(e,n){Ee("smartsheetWebSubTablesOperation",e,n)},smartsheetGetMainPageStatus:function(e,n){Ee("smartsheetGetMainPageStatus",e,n)},smartsheetEnableNativeGesture:function(e,n){Ee("smartsheetEnableNativeGesture",e,n)},smartsheetShowSubTableList:function(e,n){Ee("smartsheetShowSubTableList",e,n)},smartsheetHideSubTableList:function(e,n){Ee("smartsheetHideSubTableList",e,n)},smartsheetSubViewsPanelOperation:function(e,n){Ee("smartsheetSubViewsPanelOperation",e,n)},smartsheetUpdateWebScrollStatus:function(e,n){Ee("smartsheetUpdateWebScrollStatus",e,n)},showInputAlert:function(e,n){Ee("showInputAlert",e,n)},showAlertMobile:function(e,n){Ee("showAlert",e,n)},showAlertMixButton:function(e,n){Ee("showAlertMixButton",e,n)},docTemplateUse:function(e,n){Ee("docTemplateUse",e,n)},showTemplateBottomBar:function(e,n){Ao(e,n),Ee("showTemplateBottomBar",e,n)},selectConversations:function(n,t){Ee("selectConversations",n,e({max_count:500},t))},fetchConversationInfos:function(e,n){Ee("fetchConversationInfos",e,n)},pushNavigatorPage:function(e,n){Ee("react.pushNavigatorPage",e,n)},showAnimatedPanel:function(e,n){Ee("react.showReactAnimatedPanel",e,n)},showBottomSheet:function(e,n){Ee("react.showBottomSheet",e,n)},showPopupWidget:function(e,n){Ee("react.showPopupWidget",e,n)},createInstance:function(e,n){Ee("react.createInstance",e,n)},appendChild:function(e,n){Ee("react.appendChild",e,n)},appendChildToContainer:function(e,n){Ee("react.appendChildToContainer",e,n)},removeChild:function(e,n){Ee("react.removeChild",e,n)},insertChildBefore:function(e,n){Ee("react.insertChildBefore",e,n)},commitUpdate:function(e,n){Ee("react.commitUpdate",e,n)},batchCommit:function(e,n){Ee("react.batchCommit",e,n)},sendControllerEvent:function(e,n){Ee("react.sendControllerEvent",e,n)}}:{}),Jo?{selectSmartSheetForImport:function(e,n){Ee("selectSmartSheetForImport",e,n)}}:{}),Go?{selectFile:function(e,n){return Me("selectFile",e,n)},getLocalFileInfo:function(e,n){return Me("getLocalFileInfo",e,n)},getLocalThumbnail:function(e,n){return Me("getLocalThumbnail",e,n)},uploadFileToC2C:function(e,n){return Me("uploadFileToC2C",e,n)},operateC2CUploadFiles:function(e,n){return Me("operateC2CUploadFiles",e,n)},queryC2CUploadStatus:function(e,n){return Me("queryC2CUploadStatus",e,n)},showSimpleEditContentPanel:function(e,n){console.info("-----showTopTips------"),console.info(n),function(e,n){var t;En||function(e){e.addEventListener("onSimpleEditContentPanelAction",(function(e){console.error("点击回调",e),console.error(En),null==En||En(e)}))}(e);En=null!==(t=n.onClick)&&void 0!==t?t:null}(e,n),Ee("showSimpleEditContentPanel",e,n)},showTopTips:function(e,n){console.info("-----showTopTips------"),console.info(n),function(e,n){console.error(JSON.stringify(n.actions)),0===Object.keys(Mn).length&&function(e){e.addEventListener("onTopTipsClick",(function(e){var n;console.error("点击回调",e),console.error(Mn),null===(n=Mn[e.id])||void 0===n||n.call(Mn,e)}))}(e);if(!n.actions)return;null==n||n.actions.forEach((function(e){e.onclick&&(Mn[e.id]=e.onclick)}))}(e,n),Ee("showTopTips",e,n)},showDataPicker:function(e,n){return Me("showDataPicker",e,n)},isDarkMode:function(e,n){return Me("isDarkMode",e,n)},dismissTopTips:function(e,n){console.info("-----dismissTopTips------"),Ee("dismissTopTips",e,n),Mn={}},unfocusPrimaryFocus:function(e,n){return console.info("-----unfocusPrimaryFocus------"),Me("unfocusPrimaryFocus",e,n)},updateWatermarkInfo:function(e,n){Ee("updateWatermarkInfo",e,n)},forcePopAllPage:function(e,n){Ee("react.forcePopAllPage",e,n)},forcePopPage:function(e,n){Ee("react.forcePopPage",e,n)},showLoading:function(e,n){Ee("react.showLoading",e,n)},getRootPageId:function(e,n){return Me("react.getRootPageId",e,n)}}:{}),Ho={clean:Qn,getClipboardData:Ue,setClipboardData:Re,getAppVersion:ze,compare:Ke,isNewWwapp:Ye,quoteToDiscuss:Ge,forwardToConversion:Xe,setTitle:Tn,viewProfile:un,onUnload:Ze,selectPerson:an,openUrl:Gn,previewImage:$n,showNativeToast:et,notifyCommentActionToNative:nt,notifyEmojiCommentToNative:tt,allCommentPanelCountUpdated:ot,showNativeAllCommentPanel:it,launchCommentInput:rt,showEmojiActionPanel:ct,vibration:Lt,updateAuthority:ln,docLogin:Vt,log:qt},$o=e(e(e(e({getAppVersion:ze,compare:Ke,isNewWwapp:Ye,viewProfile:un,selectPerson:an,openUrl:Gn,previewImage:$n,getLoginCst:Bt,docLogin:Vt},jo?{previewFiles:Yn,getTemplateSegmentName:po}:{}),jo&&E.isIOS()?{getMobileTemplateFromPage:vo}:{}),Lo?{getConversationMsgList:mt}:{}),No?{preloadData:Zn}:{}),zo=e(e(e(e(e(e(e(e(e(e(e(e({},$o),go),{log:qt,hideDiscussion:pt,clearDocUnread:dt,getRedPointMsgList:gt,previewFile:ao,viewProfile:un,getLoginCst:Bt,chooseImagePicker:wo,requestFocus:no,setClipboardData:Re,keepEmojiPanel:ko,forwardFormsToWXWork:Co,updateTimelineConv:ho}),To?{popBack:Xn}:{}),Oo?{showDiscussion:ft,setTitlebarIcons:yn,updateTitlebarIcons:An,updateDiscussion:vt}:{}),Eo?{selectCorpGroupContact:co}:{}),!Mo&&E.isAndroid()?{}:{showTitlebarMask:Cn}),Mo?{chooseWeDriveFile:qe,multiChooseWeDriveFile:Qe}:{}),Lo?{chooseTencentOfficeFile:Je,showEmojiPanel:mo,toggleEmojiPanel:bo,getClipboardData:Ue}:{}),!jo||E.isAndroid()?{}:{showOrHideLoading:yo}),fo),{startGroupChat:jt,setActionButtons:kn,updateActionButtons:_n,closeFormAndTemplate:Hn});var Ko=ge(fe()?Xo:ve()?zo:pe()?Ho:$o,j.isWeWorkApp);Ko.docLogin&&(Ko.docLogin=Pe(Ko.docLogin));var Yo=e(e(e({},Ko),{isWedocWebview:fe}),fe()?{addEventListener:en,removeEventListener:nn,removeIconButtonClickEvent:Bn,callbackMap:xn,deleteCookie:We,onRemoteCall:function(e,n){return t(void 0,void 0,Promise,(function(){var t,i;return o(this,(function(o){switch(o.label){case 0:return console.log("onRemoteCall 开始监听"),[4,te(j.isWeWorkApp)];case 1:return t=o.sent(),null===(i=t.onRemoteCall)||void 0===i||i.call(t,e,n),[2]}}))}))},offRemoteCall:function(e,n){return t(void 0,void 0,Promise,(function(){var t,i;return o(this,(function(o){switch(o.label){case 0:return[4,te(j.isWeWorkApp)];case 1:return t=o.sent(),console.log("onRemoteCall",e),null===(i=t.offRemoteCall)||void 0===i||i.call(t,e,n),[2]}}))}))}}:{});function Zo(e){var t=e||{},o=t.success,i=t.fail,r=t.cancel;return{data:n(t,["success","fail","cancel"]),success:o,fail:i,cancel:r}}function ei(e){var t=e||{};return t.success,t.fail,n(t,["success","fail"])}function ni(e,n,t){return n.invoke(e,{data:ei(t)})}function ti(e,n,t){n.invoke(e,Zo(t))}function oi(e,n,t,o){var i;void 0===o&&(o=3),(null===(i=window.qmailBridge)||void 0===i?void 0:i[e])?n(window.qmailBridge):o>0?setTimeout((function(){return oi(e,n,t,o-1)}),1e3):t()}function ii(){if(!/^\/(journal|forms|form\/page)\//.test(location.pathname))return ye()||/^\/txdoc\//.test(location.pathname)?"doc":void 0}function ri(){if(/^\/(journal|forms|form\/page)\//.test(location.pathname))return!0}var ci=function(e,n){de()?e.readFromPasteBoard((function(e){var t;null===(t=n.success)||void 0===t||t.call(n,{plain:e.value||"",html:e.html||""})}),n.fail):e.invoke("wwapp.wedoc.readFromPasteBoard",Zo(n))},si=function(e,n){de()?e.writeToPasteBoard({html:n.html||"",value:n.plain||""},n.success,n.fail):e.invoke("wwapp.wedoc.writeToPasteBoard",Zo(n))},ai=function(e,n){var t;de()?null===(t=n.success)||void 0===t||t.call(n,e.readFileListFromClipBoard()):e.invoke("wwapp.wedoc.readFileListFromClipBoard",Zo(n))},ui=function(e,n){de()?e.readAsDataURL(n.path).then((function(e){var t,o;e?null===(t=n.success)||void 0===t||t.call(n,{base64:e}):null===(o=n.fail)||void 0===o||o.call(n)})).catch((function(e){var t;null===(t=n.fail)||void 0===t||t.call(n,e)})):e.invoke("wwapp.wedoc.readAsDataURL",Zo(n))},li=function(e,n){de()?e.copyNativeImageByPath(n.path).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.copyNativeImageByPath",Zo(n))},di=function(e,n){e.invoke("wwapp.wedoc.requestFullscreen",Zo(n))},fi=function(e,n){e.invoke("wwapp.wedoc.exitFullscreen",Zo(n))},pi=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_isFullscreen",e),[2]}}))}))},vi=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_isFullscreen",e),[2]}}))}))},wi=function(e,n){de()?e.add2Drive().then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.add2Drive",Zo(n))},hi=function(n,t){de()?n.selectFromWxDrive(e(e({},ei(t)),{confirmHandler:function(e){var n,o,i=(null==e?void 0:e.length)?e[0]:null;i?null===(o=t.success)||void 0===o||o.call(t,{err_code:0,err_msg:"pickWeDriveWindow:ok",fileid:i.doc_id||i.id,filename:i.name,filetype:i.doc_id?1:0,spaceid:i.topId||i.rootId,url:i.doc_url}):null===(n=t.fail)||void 0===n||n.call(t)}})):n.invoke("wwapp.wedoc.selectFromWxDrive",Zo(t))},gi=function(e,t){var o;if(de())return e.jumpToDrive({id:t.file_id,parentId:t.folder_id,topId:t.space_id}),void(null===(o=t.success)||void 0===o||o.call(t));if(le()){var i=t||{},r=i.success,c=i.fail,s=n(i,["success","fail"]),a={data:{event:"jumpToDrive",param:JSON.stringify({file:s})},success:r,fail:c,cancel:c};e.invoke("wwapp.wedoc.wedriveUniversalEvent",a)}else e.invoke("wwapp.wedoc.jumpToDrive",Zo(t))},mi=function(n,t){if(le()){var o=JSON.stringify(t.param);t=e(e({},t),{param:o}),n.invoke("wwapp.wedoc.wedriveUniversalEvent",Zo(t))}},bi=function(e,n){de()?e.request("mainService.appIpcRequest","wework/getPartyListOrUserListForWXDrive",ei(n),{timeout:2e3}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.getPartyListOrUserList",Zo(n))},ki=function(e,n){de()?e.request("mainService.appIpcRequest","wework/getSubDepartmentsForWXDrive",ei(n)).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.getSubDepartments",Zo(n))},yi=function(n,i){return t(void 0,void 0,void 0,(function(){return o(this,(function(t){if(void 0===(i=Ci(i)).docid&&(i.docid=ke()),/_st$/.test(i.docid))return[2,Promise.resolve({})];if(sn(i.openid||i.vid))return[2,Promise.resolve({})];if(de())return[2,n.viewProfile(null==i?void 0:i.vid)];if(i.openid||i.useOpenid||!rn(i.vid)){if(E.isMac()&&E.compareVersion(ae(),"4.0.10")<0)return[2,Promise.resolve({})];if(!cn(i.openid||i.vid))return[2,Promise.reject({err_msg:(i.openid||i.vid)+" is not openid"})];i=e(e({},i),{openid:i.openid||i.vid,vid:void 0,useOpenid:1})}return[2,ni("wwapp.wedoc.viewProfile",n,i)]}))}))};function Ci(n){if("number"!=typeof n.positionX||"number"!=typeof n.positionY)return n;if(!window.parent||window.parent===window)return n;try{var t=window.parent.document.querySelectorAll("iframe"),o=Array.from(t).find((function(e){return e.contentWindow===window})),i=null==o?void 0:o.getBoundingClientRect();return i?e(e({},n),{positionX:n.positionX+i.left,positionY:n.positionY+i.top}):n}catch(e){return console.error(e),n}}var Wi=function(n,i){return t(void 0,void 0,void 0,(function(){var t,r,c,s;return o(this,(function(o){switch(o.label){case 0:return de()?[2,n.selectContacts(ei(i))]:(t=tn(i.useOpenid,i.canUseOpenid||!!(null===(c=i.selectedContactOpenIds)||void 0===c?void 0:c.length)||!!(null===(s=i.disabledUserOpenIds)||void 0===s?void 0:s.length)))?[4,ni("wwapp.wedoc.selectContacts",n,e(e({docid:ke(),docId:ke(),ignoreCmodes:ri(),whitelistType:ii()},i),{useOpenid:t,selectedContacts:void 0,disabledUserIds:void 0,selectedContactOpenIds:i.selectedContactOpenIds||i.selectedUserIds&&i.selectedUserIds.filter((function(e){return cn(e)})),disabledUserOpenIds:i.disabledUserOpenIds||i.disabledUserIds&&i.disabledUserIds.filter((function(e){return cn(e)}))}))]:[2,ni("wwapp.wedoc.selectContacts",n,e(e({docid:ke(),whitelistType:ii(),ignoreCmodes:ri()},i),{selectedContacts:i.selectedContacts&&i.selectedContacts.filter((function(e){return rn(e)})),disabledUserIds:i.disabledUserIds&&i.disabledUserIds.filter((function(e){return rn(e)}))}))];case 1:return r=o.sent(),[2,e(e({},r),{selectedContacts:r.selectedContacts&&r.selectedContacts.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),applyExternalVidList:r.applyExternalVidList&&r.applyExternalVidList.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),applyWxList:r.applyWxList&&r.applyWxList.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),selectedOtherContacts:r.selectedOtherContacts&&r.selectedOtherContacts.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})}))})]}}))}))},Si=function(n,i){if(de())oi("getRecentContacts",(function(e){e.getRecentContacts().then(null==i?void 0:i.success).catch(null==i?void 0:i.fail)}),(function(){var e;null===(e=i.fail)||void 0===e||e.call(i)}));else{var r=tn(i.useOpenid,i.canUseOpenid);r?ni("wwapp.wedoc.getRecentContacts",n,e(e({docid:ke()},i),{useOpenid:r})).then((function(n){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return null===(t=i.success)||void 0===t||t.call(i,e(e({},n),{persons:n.persons&&n.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})),[2]}))}))})).catch(i.fail):n.invoke("wwapp.wedoc.getRecentContacts",Zo(i))}},_i=function(n,i){if(de())n.searchContacts(ei(i)).then(null==i?void 0:i.success).catch(null==i?void 0:i.fail);else{var r=tn(i.useOpenid,i.canUseOpenid);r?ni("wwapp.wedoc.searchContacts",n,e(e({docid:ke()},i),{useOpenid:r})).then((function(n){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return null===(t=i.success)||void 0===t||t.call(i,e(e({},n),{persons:n.persons&&n.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})),[2]}))}))})).catch(i.fail):n.invoke("wwapp.wedoc.searchContacts",Zo(i))}},Ai={CN:{INVITE:"邀请成员加入",LINK:"复制链接",DISABLE:"企业外人员不可加入此文档",QRCODE:"生成二维码",SHARE_TPL:"分享模板"},EN:{INVITE:"Send Invitation",LINK:"Copy the link",DISABLE:"Externals cannot join this document",QRCODE:"Generate QR Code",SHARE_TPL:"Share Template"},HK:{INVITE:"邀請成員加入",LINK:"複製連結",DISABLE:"企業外人員不可加入此文檔",QRCODE:"生成二維碼",SHARE_TPL:"分享模板"},TH:{INVITE:"เชิญสมาชิกเข้าร่วม",LINK:"คัดลอกลิงก์",DISABLE:"ผู้ที่ไม่ใช่พนักงานภายในไม่สามารถเข้าร่วมเอกสารนี้ได้",QRCODE:"สร้างรหัส QR",SHARE_TPL:"แบ่งปันเทมเพลต"},VI:{INVITE:"Mời thành viên tham gia",LINK:"Sao chép liên kết",DISABLE:"Không cho phép người ngoài doanh nghiệp tham gia tài liệu này",QRCODE:"Tạo mã QR",SHARE_TPL:"Chia sẻ mẫu"},MS:{INVITE:"Jemput ahli untuk menyertai",LINK:"Salin pautan",DISABLE:"Ahli luar syarikat tidak dibenarkan menyertai dokumen ini",QRCODE:"Buat kod QR",SHARE_TPL:"Kongsi Templat"},FIL:{INVITE:"Mag-imbita ng mga kasapi na sumali",LINK:"Kopyahin ang link",DISABLE:"Ang mga tao na hindi kabilang sa kumpanya ay hindi maaaring sumali sa dokumentong ito",QRCODE:"Lumikha ng QR code",SHARE_TPL:"Ibahagi ang Template"},ID:{INVITE:"Undang anggota untuk bergabung",LINK:"Salin tautan",DISABLE:"Pegawai di luar perusahaan tidak dapat bergabung dengan dokumen ini",QRCODE:"Buat kode QR",SHARE_TPL:"Bagikan Templat"},ES:{INVITE:"Invitar a miembros a unirse",LINK:"Copiar enlace",DISABLE:"Los miembros externos a la empresa no pueden unirse a este documento",QRCODE:"Generar código QR",SHARE_TPL:"Compartir plantilla"},DE:{INVITE:"Mitglieder einladen beizutreten",LINK:"Link kopieren",DISABLE:"Externe Mitarbeiter können nicht an diesem Dokument teilnehmen",QRCODE:"QR-Code generieren",SHARE_TPL:"Vorlage teilen"},JA:{INVITE:"メンバーを招待して参加する",LINK:"リンクをコピーする",DISABLE:"企業外の人はこのドキュメントに参加できません",QRCODE:"QRコードを生成する",SHARE_TPL:"テンプレートを共有する"}},Ti=E.compareVersion(ae(),"4.0.18")>=0,Ii=E.compareVersion(ae(),"4.1.8")>=0,xi=E.compareVersion(ae(),"4.1.10")>=0,Pi=new Map,Di=!1,Oi=0,Ei=!1,Mi=function(){for(var e,n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{"function"==typeof(null===(n=window.log)||void 0===n?void 0:n.info)?(e=window.log).info.apply(e,t):console.info.apply(console,t)}catch(e){}};function ji(e){var n;if(Mi("----QuoteToDiscuss onclick----",e),"close"===(null==e?void 0:e.id)&&xi)return Oi=Date.now(),Ei=!1,Mi("----QuoteToDiscuss onclose----",Oi),void window.dispatchEvent(new CustomEvent("sharePanelClosed"));(null==e?void 0:e.id)&&(null===(n=Pi.get(e.id))||void 0===n||n())}var Li=function(){var e=Date.now()-Oi;return!(e<=500&&xi)||(Mi("----QuoteToDiscuss forbidden show---- diffTime="+e),!1)};var Ni=function(n,t){if(de())n.discuss(ei(t)).then(t.success).catch(t.fail);else if(Li()){var o,i,r,c=window.isTimelineMode?{hideDiscussWindow:!0}:{};if(Pi.clear(),Ti&&t.extraButtons&&function(e,n){null==n||n.forEach((function(e){var n=e.id,t=e.onClick;n&&t&&Pi.set(n,t)})),console.log("----QuoteToDiscuss Click Action Init----",null==n?void 0:n.length,Di),Di||(e.on("wwapp.wedoc.onClickSharePanel",ji),Di=!0)}(n,t.extraButtons),t.fixPosition&&(t=Ci(t)),t.url&&(o=t.url,i=Ie("wikifileid"),r=Ie("wikifileid",o),i&&i!==r&&Te({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"wiki_file_id_not_match",ver7:ae(),ver8:i,ver9:ke()||location.pathname,ver10:ce(),source3:r})),Ii){void 0!==(null==t?void 0:t.positionX)&&E.isWindows()&&(t.positionX-=40,console.debug("4.1.8版本转发弹窗UI变化,tdoc自动向左偏移40px(win)",t.positionX));var s=Ai[function(){try{var e=window.__LANG__||localStorage.getItem("shared-language")||"zh-CN";return e?/^en/i.test(e)?"EN":/hk$/i.test(e)||/tw$/i.test(e)?"HK":/^zh/i.test(e)?"CN":/^ms/i.test(e)?"MS":/^es/i.test(e)?"ES":/^id/i.test(e)?"ID":/^ja/i.test(e)?"JA":/^th/i.test(e)?"TH":/^tl/i.test(e)||/^fil/i.test(e)?"FIL":/^vi/i.test(e)?"VI":/^de/i.test(e)?"DE":"EN":"CN"}catch(e){return"CN"}}()];t&&!/forms\//.test((null==t?void 0:t.url)||"")&&(t.shareTitle=/_st$/.test((null==t?void 0:t.docId)||"")?s.SHARE_TPL:s.INVITE,console.debug("4.1.8版本转发弹窗UI变化,shareTitle自动修改为",t.shareTitle)),((null==t?void 0:t.extraButtons)||[]).forEach((function(e){if(!e.skipFix){if(!e.enable&&["qrcode","wechat-share"].includes(e.id)&&(e.hoverText=s.DISABLE),e.enable&&"qrcode"===e.id&&(e.hoverText=s.QRCODE),"link"===e.id){var n=E.isMac()?"⌘ L":"Ctrl+L";e.hoverText=s.LINK+"  "+n}console.debug("4.1.8版本转发弹窗UI变化,"+e.id+"的hoverText自动修改为"+e.hoverText)}}))}setTimeout((function(){var o=Zo(e(e({whitelistType:ii()},c),t));n.invoke("wwapp.wedoc.discuss",o),Mi("wwapp.wedoc.discuss",o)}),25),xi&&(Ei=!0,window.dispatchEvent(new CustomEvent("sharePanelShowed")))}else Oi=0},Bi=function(n,t){var o,i;if(de())n.startConversation(ei(t)).then(t.success).catch(t.fail);else{if(void 0===t.docid&&(t.docid=ke()),t.openid||t.useOpenid||!rn(t.vid)){if(E.isMac()&&E.compareVersion(ae(),"4.0.10")<0)return void(null===(o=t.success)||void 0===o||o.call(t,{}));if(!cn(t.openid||t.vid))return void(null===(i=t.fail)||void 0===i||i.call(t,{err_msg:(t.openid||t.vid)+" is not openid"}));t=e(e({},t),{openid:t.openid||t.vid,vid:void 0,useOpenid:1})}n.invoke("wwapp.wedoc.startConversation",Zo(t))}},Fi=function(n,t){if(de())n.forwardFormsToWXWork(t.forms||[]).then(t.success).catch(t.fail);else{var o=e({},t);Array.isArray(t.forwardRoomIds)&&(Y.isWindows||Y.isMac&&Y.isWxWorkVersionAboveOrEqual("4.0.19")?o.forwardRoomIds=t.forwardRoomIds.map((function(e){return""+e})):o.forwardRoomIds=t.forwardRoomIds.map((function(e){return+e}))),n.invoke("wwapp.wedoc.forwardFormsToWXWork",Zo(e({whitelistType:ii()},o)))}},Ui=function(e,n){de()?e.forwardToConversion(n.convId||"").then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.forwardToConversion",Zo(n))},Ri=function(e,n){de()?e.request("mainService.appIpcRequest","wework/notifyPush",ei(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.notifyPush",Zo(n))},Vi=function(e,n){de()?e.request("mainService.appIpcRequest","wework/showDiscussWindow",ei(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.showDiscussWindow",Zo(n))},qi=function(e,n){de()?e.request("mainService.appIpcRequest","wework/hideOneDiscussWindow",ei(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.hideOneDiscussWindow",Zo(n))},Qi=function(e,n){de()?e.request("mainService.appIpcRequest","wework/destroyDiscussWindow",ei(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.destroyDiscussWindow",Zo(n))};function Ji(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.on("wework_completeComment",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_completeComment",e),[2]}}))}))}function Gi(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.removeListener("wework_completeComment",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_completeComment",e),[2]}}))}))}function Xi(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.on("wework_unreadCountChange",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_unreadCountChange",e),[2]}}))}))}function Hi(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.removeListener("wework_unreadCountChange",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_unreadCountChange",e),[2]}}))}))}function $i(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.on("wework_closeDiscussWindow",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_closeDiscussWindow",e),[2]}}))}))}function zi(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.removeListener("wework_closeDiscussWindow",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_closeDiscussWindow",e),[2]}}))}))}!E.isServerSide()&&E.isWeWorkMacOrWin()&&(/^\/home/.test(location.pathname)||document.addEventListener("tdocsReady",(function(){te(j.isWeWork).then((function(e){var n=e.notify.bind(e);e.notify=function(){for(var e,t,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];n.apply(void 0,o);try{if("wwapp.wedoc.onClickSharePanel"!==o[0])return;var r=document.querySelector(".tmall-panel");if(!r)return;var c=r.querySelector("iframe");if(!c)return;var s=null==c?void 0:c.contentWindow;if(!(null===(t=null==s?void 0:s.wwapp)||void 0===t?void 0:t.notify))return;(e=s.wwapp).notify.apply(e,o),console.debug("forward success",o)}catch(e){console.error("forward error",e)}}}))})));var Ki=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,ae())},Yi=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,E.compareVersion(ae(),(null==n?void 0:n.version)||""))},Zi=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,ue())},er=function(e,n){n.target!==N.Browser&&(I.test(n.url)||x.test(n.url))?n.target===N.Direct?location.href=n.url:rr(e,n):nr(e,n)},nr=function(e,n){de()?e.openFileInBrowser(n.url).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openFileInBrowser",Zo(n))},tr=function(n,t){var o,i;E.isMac()?null===(i=null===(o=window.WeixinJSBridge)||void 0===o?void 0:o.invoke)||void 0===i||i.call(o,"wwapp.openUrl",e(e({width:"960",height:"680"},ei(t)),{forceInnerBrowser:1,url:t.url}),t.success):n.invoke("wwapp.wedoc.openInWxworkBrowser",Zo(t))},or=function(e,t){if(de())e.openFileInWedrive(t.fileId,t.url).then(t.success).catch(t.fail);else if(le()){var o=t||{},i=o.success,r=o.fail,c=n(o,["success","fail"]),s={data:{event:"openFileInWedrive",param:JSON.stringify(c)},success:i,fail:r,cancel:r};e.invoke("wwapp.wedoc.wedriveUniversalEvent",s)}else e.invoke("wwapp.wedoc.openFileInWedrive",Zo(t))},ir=function(e,n){var t;de()?null===(t=n.success)||void 0===t||t.call(n,e.closeWindow()):(ve()&&document.body.clientWidth<610&&e.invoke("wwapp.closeCurrentWebview",Zo(n)),e.invoke("wwapp.wedoc.closeWindow",Zo(n)))},rr=function(e,n){I.test(n.url)||x.test(n.url)||P.test(n.url)?de()?e.request("mainProcessModule.WeDocsSchemaProtocolController.openwedocs",{url:n.url,id:ke(n.url),is_silent:n.is_silent||!1},{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openInTab",Zo(n)):nr(e,n)},cr=function(e,n){e.invoke("wwapp.wedoc.openWecomSearch",Zo(n))},sr=function(e,n){de()?e.openWedocsMainWindow(!1,!1,{}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openAndJumpToMainPage",Zo(n))};function ar(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.on("focusWedocsWindow",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.focusWedocsWindow",e),[2]}}))}))}function ur(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.removeListener("focusWedocsWindow",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.focusWedocsWindow",e),[2]}}))}))}function lr(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.on("blurWedocsWindow",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.blurWedocsWindow",e),[2]}}))}))}function dr(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.removeListener("blurWedocsWindow",e),[2]):[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.blurWedocsWindow",e),[2]}}))}))}var fr=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.on("url_change",(function(n,t){return e(t)})),[2]):[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.urlChange",e),[2]}}))}))},pr=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return de()?(window.wedocs_preloadIPCRenderer.removeListener("url_change",(function(n,t){return e(t)})),[2]):[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.urlChange",e),[2]}}))}))},vr=function(e,n){var t;if(de()){var o=location.search.replace(/^\?/,"").split("&").reduce((function(e,n){var t=n.split("=");return t[0]&&(e[t[0]]=t[1]),e}),{});null===(t=n.success)||void 0===t||t.call(n,o)}else e.invoke("wwapp.wedoc.getWindowUrlParams",Zo(n))},wr=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.clickDocTab",e),[2]}}))}))},hr=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.clickDocTab",e),[2]}}))}))},gr=function(n,t){var o;if(de())null===(o=t.success)||void 0===o||o.call(t,n.openSupportPage());else if(p()===v)nr(n,e(e({},t),{url:D}));else{var i=O,r=[];for(var c in t.querys)r.push(c+"="+encodeURIComponent(t.querys[c]));var s=r.join("&");fetch("/diskmng/contactus?func=2").then((function(e){return e.json()})).then((function(o){var r,c=null===(r=null==o?void 0:o.body)||void 0===r?void 0:r.feedback_url;if(c){var a=new URL(c),u=a.searchParams.get("tucao_redirect_uri");if(u){var l=!1;u.includes("http")||(u="http://"+u,l=!0);var d=new URL(u);for(var f in t.querys)d.searchParams.set(f,t.querys[f]);u=d.toString(),l&&(u=u.slice(7)),a.searchParams.set("tucao_redirect_uri",u),c=a.toString()}}else c=i+"?"+s;nr(n,e(e({},t),{url:c}))})).catch((function(o){console.error("fetch feedback url error",o),nr(n,e(e({},t),{url:i+"?"+s}))}))}},mr=function(n,t){var o=tn(t.useOpenid,t.canUseOpenid);n.invoke("wwapp.wedoc.getLoginCst",Zo(e({docid:ke(),useOpenid:o},t)))},br=function(n,t){if(de())n.docLogin((function(){return be({},t)}),t.fail);else{var o=tn(t.useOpenid,!0),i=Oe("getLoginCst"),r=i.reportSuccess,c=i.reportFail;n.invoke("wwapp.wedoc.getLoginCst",Zo(e(e({docid:ke(),useOpenid:o,canUseOpenid:!0},t),{success:function(n){on(e({cst:n.cst,deviceid:n.deviceid},o&&n.openid?{openid:n.openid}:{vid:n.vid}),t),r()},fail:function(e){var n;null===(n=t.fail)||void 0===n||n.call(t,e),c(e)}})))}},kr=function(n,t){var o=_e(t.msg||t.message||""),i=t.level||"info";de()?n.localLog(o).then(t.success).catch(t.fail):n.invoke("wwapp.wedoc.localLog",Zo(e(e({},t),{msg:o,level:i})))},yr=function(e,n){e.invoke("wwapp.wedoc.insertWxworkGroupChat",Zo(n))},Cr=function(e,n){e.invoke("wwapp.wedoc.isInWxworkGroupChat",Zo(n))},Wr=function(e,n){e.invoke("wwapp.wedoc.joinWxworkGroupChat",Zo(n))},Sr=function(e,n){e.invoke("wwapp.wedoc.enterWxworkGroupChat",Zo(n))},_r=function(e,n){e.invoke("wwapp.wedoc.createWxworkNameCardSelf",Zo(n))},Ar=function(e,n){e.invoke("wwapp.wedoc.enterWxworkNameCard",Zo(n))},Tr=function(e,n){e.invoke("wwapp.wedoc.canChatWithWxworkNameCard",Zo(n))},Ir=function(e,n){e.invoke("wwapp.wedoc.createWxworkCalender",Zo(n))},xr=function(e,n){e.invoke("wwapp.wedoc.selectWxworkCalenderList",Zo(n))},Pr=function(e,n){e.invoke("wwapp.wedoc.viewDetailWxworkCalender",Zo(n))},Dr=function(e,n){e.invoke("wwapp.wedoc.queryWxworkCalenderInfo",Zo(n))},Or=function(e,n){e.invoke("wwapp.wedoc.joinWxworkCalender",Zo(n))},Er=function(e,n){e.invoke("wwapp.wedoc.createTransferedChatMessageInfo",Zo(n))},Mr=function(e,n){e.invoke("wwapp.wedoc.openChatMessageDetail",Zo(n))};var jr=function(e,n){e.invoke("wwapp.wedoc.getConversationList",Zo(n))},Lr=function(e,n){e.invoke("wwapp.wedoc.getConversationsDetail",Zo(n))},Nr=function(e,n){e.invoke("wwapp.wedoc.getNoticeCount",Zo(n))},Br=function(e,n){e.invoke("wwapp.wedoc.monitorDocConv",Zo(n))},Fr=function(e,n){e.invoke("wwapp.wedoc.markAsRead",Zo(n))},Ur=function(e,n){e.invoke("wwapp.wedoc.setConvTop",Zo(n))},Rr=function(e,n){e.invoke("wwapp.wedoc.removeConv",Zo(n))};function Vr(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.conversationChange",e),[2]}}))}))}function qr(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.conversationChange",e),[2]}}))}))}var Qr=function(e,n){e.invoke("wwapp.wedoc.setNoticeType",Zo(n))},Jr=function(e,n){e.invoke("wwapp.wedoc.getTotalUnreadCount",Zo(n))},Gr=function(e,n){e.invoke("wwapp.wedoc.timelineInited",Zo(n))},Xr=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.openDocInTimeline",e),[2]}}))}))},Hr=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.openDocInTimeline",e),[2]}}))}))},$r=function(e,n){e.invoke("wwapp.wedoc.shareToWeixin",Zo(n))},zr=function(e,n){e.invoke("wwapp.wedoc.isInstalledWeixinApp",Zo(n))},Kr=function(e,n){e.invoke("wwapp.wedoc.queryDepartmentNames",Zo(n))};var Yr;!function(e){e.NotGroup="0",e.Group="1"}(Yr||(Yr={}));var Zr,ec=function(e,n){e.invoke("wwapp.selectCorpGroupContact",Zo(n))},nc={selectEnterpriseContacts:function(e,n){Ne("selectEnterpriseContact",n)},genRoomChatTicket:function(e,n){Ne("wwapp.getTicketToSendGroupChat",n)}},tc="undefined"==typeof window?{log:null}:window,oc=function(){function e(){}return e.debug=function(){for(var n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{tc.log?(n=tc.log).debug.apply(n,t):console.debug.apply(console,t)}catch(n){e.error("日志发生错误","debug",t)}},e.log=function(){for(var n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{tc.log?(n=tc.log).info.apply(n,t):console.log.apply(console,t)}catch(n){e.error("日志发生错误","log",t)}},e.warn=function(){for(var n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{tc.log?(n=tc.log).warn.apply(n,t):console.warn.apply(console,t)}catch(n){e.error("日志发生错误","warn",t)}},e.error=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{tc.log?(e=tc.log).error.apply(e,n):console.error.apply(console,n)}catch(e){console.error("日志发生错误","error",n)}},e.time=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var o={time:Date.now(),options:n};this.sTimeLableMap.set(e,o)},e.timeEnd=function(n){var t=Date.now(),o=e.sTimeLableMap.get(n);if(void 0!==o){var r=t-o.time,c="";o.options&&3===o.options.length&&"clientDatabaseRequest"===o.options[1]&&(c=o.options[2]),e.log.apply(e,i(["label: "+n+": "+r+"ms."],o.options||[])),e.speedReport(r,c),this.sTimeLableMap.delete(n)}},e.speedReport=function(e,n){n&&tc.dbjsApiSpeedReport&&tc.dbjsApiSpeedReport(e,n)},e.sTimeLableMap=new Map,e}();!function(e){e[e.UserName=1]="UserName",e[e.UserAlias=2]="UserAlias"}(Zr||(Zr={}));var ic,rc,cc;!function(e){e[e.ConversationCategory_Single=0]="ConversationCategory_Single",e[e.ConversationCategory_Group=1]="ConversationCategory_Group",e[e.ConversationCategory_Application=2]="ConversationCategory_Application"}(ic||(ic={})),function(e){e[e.ConversationType_Inner=0]="ConversationType_Inner",e[e.ConversationType_External=1]="ConversationType_External",e[e.ConversationType_InterConnect=2]="ConversationType_InterConnect"}(rc||(rc={})),function(e){e[e.EN_CODE_TYPE_DEFAULT=0]="EN_CODE_TYPE_DEFAULT",e[e.EN_CODE_TYPE_SMART_TABLE=1]="EN_CODE_TYPE_SMART_TABLE",e[e.EN_CODE_TYPE_BUSINESS_CARD=2]="EN_CODE_TYPE_BUSINESS_CARD"}(cc||(cc={}));var sc=E.compareVersion(ae(),"3.1.20")>=0,ac=E.compareVersion(ae(),"3.1.23")>=0,uc=E.compareVersion(ae(),"4.0.0")>=0,lc=E.compareVersion(ae(),"4.0.2")>=0,dc=E.compareVersion(ae(),"4.0.6")>=0,fc=E.compareVersion(ae(),"4.0.8")>=0,pc=E.compareVersion(ae(),"4.0.12")>=0,vc=E.compareVersion(ae(),"4.0.16")>=0,wc=E.compareVersion(ae(),"4.0.18")>=0,hc=E.compareVersion(ae(),"4.0.20")>=0,gc=E.compareVersion(ae(),"4.1.0")>=0,mc=E.compareVersion(ae(),"4.1.2")>=0,bc=E.compareVersion(ae(),"4.1.6")>=0,kc=E.compareVersion(ae(),"4.1.8")>=0,yc=E.compareVersion(ae(),"4.1.10")>=0,Cc=E.compareVersion(ae(),"4.1.12")>=0,Wc=E.compareVersion(ae(),"4.1.15")>=0,Sc=E.compareVersion(ae(),"4.1.16")>=0,_c=E.compareVersion(ae(),"4.1.20")>=0,Ac=E.compareVersion(ae(),"4.1.22")>=0,Tc=E.compareVersion(ae(),"4.1.26")>=0,Ic=E.compareVersion(ae(),"4.1.28")>=0,xc=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e({getClipboardData:ci,setClipboardData:si,readAsDataURL:ui,readFileListFromClipBoard:ai,copyNativeImage:li,getAppVersion:Ki,compare:Yi,isNewWwapp:Zi,quoteToDiscuss:Ni,startConversation:Bi,forwardFormsToWXWork:Fi,forwardToConversion:Ui,notifyPush:Ri,showDiscussWindow:Vi,hideOneDiscussWindow:qi,destroyDiscussWindow:Qi,requestFullscreen:di,exitFullscreen:fi,addToDrive:wi,selectFromWxDrive:hi,jumpToDrive:gi,wedriveUniversalEvent:mi,getPartyListOrUserList:bi,getSubDepartments:ki,openSupportPage:gr,selectContacts:Wi,viewProfile:yi,getRecentContacts:Si,searchContacts:_i,openUrl:er,openInBrowser:nr,openInTab:rr,openAndJumpToMainPage:sr,openFileInWedrive:or,closeWindow:ir,getWindowUrlParams:vr,docLogin:br,getLoginCst:mr,log:kr,boardSelectContacts:function(e,n){e.invoke("wwapp.blackboard.selectContacts",Zo(n))},showRobotProfile:function(e,n){e.invoke("wwapp.blackboard.showRobotProfile",Zo(n))},addRobot:function(e,n){e.invoke("wwapp.blackboard.addRobot",Zo(n))},forwardBlackboard:function(e,n){e.invoke("wwapp.blackboard.forwardBlackboard",Zo(n))},jumpToConversation:function(e,n){e.invoke("wwapp.blackboard.jumpToConversation",Zo(n))},monitorBlackboard:function(e,n){e.invoke("wwapp.blackboard.monitorBlackboard",Zo(n))},getWeWorkFontConfig:function(e,n){e.invoke("wwapp.blackboard.getWeWorkFontConfig",Zo(n))},showForwardDialogForBlackboard:function(e,n){e.invoke("wwapp.blackboard.showForwardDialogForBlackboard",Zo(n))},getUserCountForWXDrive:function(e,n){e.invoke("wwapp.blackboard.getUserCountForWXDrive",Zo(n))},readFileCardFromClipboard:function(e,n){e.invoke("wwapp.blackboard.readFileCardFromClipboard",Zo(n))},selectContactsForWXDrive:function(e,n){e.invoke("wwapp.blackboard.selectContactsForWXDrive",Zo(n))}},nc),sc?{insertWxworkGroupChat:yr,isInWxworkGroupChat:Cr,joinWxworkGroupChat:Wr,enterWxworkGroupChat:Sr,createWxworkNameCardSelf:_r,enterWxworkNameCard:Ar,canChatWithWxworkNameCard:Tr,joinWxworkCalender:Or,queryWxworkCalenderInfo:Dr,createWxworkCalender:Ir,selectWxworkCalenderList:xr,viewDetailWxworkCalender:Pr,openChatMessageDetail:Mr,createTransferedChatMessageInfo:Er,getConversationList:jr,getConversationsDetail:Lr,getNoticeCount:Nr,monitorDocConv:Br,markAsRead:Fr,setConvTop:Ur,removeConv:Rr,setNoticeType:Qr,getTotalUnreadCount:Jr}:{}),E.isMac()?{}:{openWecomSearch:cr}),ac&&E.isWindows()?{timelineInited:Gr}:{}),uc?{queryDepartmentNames:Kr,insertApp:function(e,n){e.invoke("wwapp.wedoc.insertApp",Zo(n))},openMiniProgram:function(e,n){e.invoke("wwapp.wedoc.openMiniProgram",Zo(n))},shareToWeixin:$r,isInstalledWeixinApp:zr}:{}),uc?{openInWxworkBrowser:tr}:{}),lc&&E.isMac()?{isDarkMode:function(e,n){e.invoke("isDarkMode",Zo(n))},toggleMainPage:function(e,n){e.invoke("wwapp.wedoc.toggleMainPage",Zo(n))}}:{}),dc?{queryLatestUnreadMsg:function(e,n){e.invoke("wwapp.wedoc.queryLatestUnreadMsg",Zo(n))}}:{}),dc&&E.isMac()?{getDisplayFontSize:function(e,n){e.invoke("wwapp.wedoc.getDisplayFontSize",Zo(n))}}:{}),fc?{getRedPointMsgList:function(e,n){e.invoke("wwapp.wedoc.getRedPointMsgList",Zo(n))}}:{}),pc&&E.isWindows()?{checkIsCurrentUser:function(n,t){var o;n.invoke("wwapp.wedoc.checkIsCurrentUser",Zo(e(e({},t),{useOpenid:null!==(o=t.useOpenid)&&void 0!==o?o:rn(t.userId)?void 0:1})))},getLastClickDocTabTime:function(e,n){e.invoke("wwapp.wedoc.getLastClickDocTabTime",Zo(n))},getCurrentProcessMemory:function(e,n){e.invoke("wwapp.wedoc.getCurrentProcessMemory",Zo(n))}}:{}),pc?{startMeeting:function(e,n){e.invoke("wwapp.wedoc.startMeeting",Zo(n))},startGroupChat:function(e,n){e.invoke("wwapp.wedoc.startGroupChat",Zo(n))},finishLoad:function(e,n){e.invoke("wwapp.wedoc.finishLoad",Zo(n))}}:{}),vc?e(e({openContactProfile:function(e,n){e.invoke("wwapp.openContactProfile",Zo(n))},openDefaultBrowser:function(e,n){e.invoke("wwapp.openDefaultBrowser",Zo(n))},openEnterpriseContact:function(e,n){e.invoke("wwapp.openEnterpriseContact",Zo(n))},downloadFile:function(e,n){e.invoke("wwapp.downloadFile",Zo(n))},uploadFile:function(e,n){e.invoke("wwapp.uploadFile",Zo(n))},setBlackBoardNavigationItem:function(e,n){e.invoke("wwapp.setBlackBoardNavigationItem",Zo(n))},getAppInfo:function(e,n){e.invoke("wwapp.getAppInfo",Zo(n))},disableWebviewBounce:function(e,n){e.invoke("wwapp.disableWebviewBounce",Zo(n))},openLocation:function(e,n){e.invoke("wwapp.openLocation",Zo(n))},selectLocation:function(e,n){e.invoke("wwapp.selectLocation",Zo(n))},showAlert:function(e,n){e.invoke("wwapp.showAlert",Zo(n))},previewImages:function(e,n){e.invoke("wwapp.previewImages",Zo(n))},previewFile:function(e,n){e.invoke("wwapp.previewFile",Zo(n))},readLocalCache:function(e,n){e.invoke("wwapp.readLocalCache",Zo(n))},selectHomeSchoolNode:function(e,n){e.invoke("wwapp.selectHomeSchoolNode",Zo(n))},showListDialog:function(e,n){e.invoke("wwapp.showListDialog",Zo(n))},selectGroupChat:function(e,n){e.invoke("wwapp.selectGroupChat",Zo(n))},notifyWebViewFinish:function(e,n){e.invoke("wwapp.journal.notifyWebViewFinish",Zo(n))},shareToConversation:function(e,n){e.invoke("wwapp.journal.shareToConversation",Zo(n))},didSubmitedJournalTemplate:function(e,n){e.invoke("wwapp.journal.didSubmitedJournalTemplate",Zo(n))},onPageStatusChanged:function(e,n){e.invoke("wwapp.journal.onPageStatusChanged",Zo(n))},jumpToJournalSetting:function(e,n){e.invoke("wwapp.journal.jumpToJournalSetting",Zo(n))},didPublishWorkLog:function(e,n){e.invoke("wwapp.journal.didPublishWorkLog",Zo(n))},getWorknoteChatData:function(e,n){e.invoke("wwapp.journal.getWorknoteChatData",Zo(n))},selectWorknoteTime:function(e,n){e.invoke("wwapp.journal.selectWorknoteTime",Zo(n))}},E.isWindows()?{selectCorpGroupContact:ec}:{}),{sendTemplateInviteCard:function(e,n){e.invoke("wwapp.journal.sendTemplateInviteCard",Zo(n))},sendTemplateInviteCard4WeworkJournal:function(e,n){e.invoke("sendTemplateInviteCard",Zo(n))},getWecomSetting:function(e,n){e.invoke("wwapp.wedoc.getWecomSetting",Zo(n))},openNativeJournal:function(e,n){e.invoke("wwapp.wedoc.openNativeJournal",Zo(n))},getLanguageSettings:function(e,n){e.invoke("wwapp.wedoc.getLanguageSettings",Zo(n))}}):{}),wc?{selectCorpGroupContact:ec,getUserInfo:function(e,n){e.invoke("wwapp.wedoc.getUserInfo",Zo(n))},timelineInited:Gr,getMessageList:function(e,n){e.invoke("wwapp.wedoc.getMessageList",Zo(n))},getReadedAnchor:function(e,n){e.invoke("wwapp.wedoc.getReadedAnchor",Zo(n))},markConvAsRead:function(e,n){e.invoke("wwapp.wedoc.markConvAsRead",Zo(n))},removeMessage:function(e,n){e.invoke("wwapp.wedoc.removeMessage",Zo(n))},removeAllMessage:function(e,n){e.invoke("wwapp.wedoc.removeAllMessage",Zo(n))},openWorkUrl:function(e,n){e.invoke("wwapp.wedoc.openWorkUrl",Zo(n))},showAdvancedFunc:function(e,n){e.invoke("wwapp.showAdvancedFunc",Zo(n))}}:{}),wc&&E.isWindows()?{getVisibilityState:function(e,n){e.invoke("wwapp.wedoc.getVisibilityState",Zo(n))}}:{}),hc?{isMailInTab:function(e,n){e.invoke("wwapp.wedoc.isMailInTab",Zo(n))},openMailWritePage:function(e,n){e.invoke("wwapp.wedoc.openMailWritePage",Zo(n))}}:{}),gc?{checkIsDocBrowser:function(e,n){E.isMac()?Promise.resolve().then((function(){var e;return null===(e=n.success)||void 0===e?void 0:e.call(n,{isDocBrowser:/WeComCEF/i.test(E.getUserAgent())})})):e.invoke("wwapp.wedoc.checkIsDocBrowser",Zo(n))}}:{}),mc?{selectWxworkMeetingList:function(e,n){e.invoke("wwapp.wedoc.selectWxworkMeetingList",Zo(n))},viewDetailWxworkMeeting:function(e,n){e.invoke("wwapp.wedoc.viewDetailWxworkMeeting",Zo(n))},enterWxworkMeeting:function(e,n){e.invoke("wwapp.wedoc.enterWxworkMeeting",Zo(n))},joinWxworkMeeting:function(e,n){e.invoke("wwapp.wedoc.joinWxworkMeeting",Zo(n))},openMeetingRecord:function(e,n){e.invoke("wwapp.wedoc.openMeetingRecord",Zo(n))},hasWorkbenchAppId:function(e,n){e.invoke("wwapp.wedoc.hasWorkbenchAppId",Zo(n))}}:{}),mc&&E.isMac()?{getDropFiles:function(e,n){e.invoke("wwapp.wedoc.getDropFiles",Zo(n))}}:{}),bc?{getApplyInfo:function(n,t){n.invoke("wwapp.getApplyInfo",Zo(e(e({},t),{success:function(e){var n,o;(null==e?void 0:e.result)?null===(n=t.success)||void 0===n||n.call(t,e.result):null===(o=t.fail)||void 0===o||o.call(t,e)}})))}}:{}),kc?{getUserCount:function(e,n){e.invoke("wwapp.wedoc.getUserCount",Zo(n))},sendDocTipsMessage:function(e,n){e.invoke("wwapp.wedoc.sendDocTipsMessage",Zo(n))},sendMagicBoxMsg:function(e,n){e.invoke("wwqt.wedoc.emitEvent",Zo(n))},journalLoaded:function(e,n){e.invoke("wwqt.wedoc.journalLoaded",Zo(n))},formLoaded:function(e,n){e.invoke("wwqt.wedoc.formLoaded",Zo(n))},wedriveMessage:function(e,n){e.invoke("wwqt.wedoc.wedriveMessage",Zo(n))},checkWxworkAppNetwork:function(e,n){e.invoke("wwapp.wedoc.checkWxworkAppNetwork",Zo(n))}}:{}),kc&&E.isMac()?{getMacDeviceInfo:function(e,n){e.invoke("macDeviceInfo",Zo(n))}}:{}),yc?{showTelAlert:function(n,t){n.invoke("wwapp2.wedoc.showTelAlert",Zo(e({appid:200001},t)))},showMailWritePage:function(e,n){e.invoke("wwapp2.wedoc.showMailWritePage",Zo(n))}}:{}),Cc&&De()?{forwardToDesktop:function(e,n){e.invoke("wwqt.wedoc.forwardToDesktop",Zo(n))}}:{}),Sc&&De()?{getWeworkInfo:function(e,n){var t=n.success;n.success=function(e){e.corpId=""+(e.corpId||""),null==t||t(e)},e.invoke("wwqt.wedoc.getWeworkInfo",Zo(n))}}:{}),_c&&De()?{openMyDocListPage:function(e,n){e.invoke("wwqt.wedoc.openMyDocListPage",Zo(n))},setTabIconByDocType:function(e,n){e.invoke("wwqt.wedoc.setTabIconByDocType",Zo(n))}}:{}),_c?{openSecurityApplication:function(e,n){e.invoke("wwapp2.wedoc.openSecurityApplication",Zo(n))},setZoomLevel:function(e,n){e.invoke("wwapp2.setZoomLevel",Zo(n))}}:{}),Ac&&De()?{uploadFileInWedrive:function(e,n){e.invoke("wwqt.wedoc.consumeDropFileInWedrive",Zo(n))},getProcessUsage:function(e,n){e.invoke("wwqt.wedoc.getProcessUsage",Zo(n))}}:{}),Tc?{selectConversations:function(n,t){var o=Ci({positionX:t.x,positionY:t.y}),i=o.positionX,r=o.positionY;ti("wwapp2.wedoc.selectConversations",n,e(e({max_count:500},t),{x:i,y:r}))},fetchConversationInfos:function(e,n){ti("wwapp2.wedoc.fetchConversationInfos",e,n)}}:{}),Ic?{selectSmartSheetForImport:function(e,n){e.invoke("wwapp2.wedoc.selectSmartSheetForImport",Zo(n))},getImageFromMobile:function(e,n){e.invoke("wwapp2.wedoc.getImageFromMobile",Zo(n))},getImageFromMobileByPath:function(e,n){e.invoke("wwqt.wedoc.getImageFromMobileByPath",Zo(n))},closeSelectConversationsWindow:function(e,n){ti("wwapp2.wedoc.closeSelectConversationsWindow",e,n)}}:{}),Pc={getClipboardData:ci,setClipboardData:si,readAsDataURL:ui,readFileListFromClipBoard:ai,copyNativeImage:li,getAppVersion:Ki,compare:Yi,isNewWwapp:Zi,quoteToDiscuss:Ni,startConversation:Bi,forwardFormsToWXWork:Fi,forwardToConversion:Ui,notifyPush:Ri,showDiscussWindow:Vi,hideOneDiscussWindow:qi,destroyDiscussWindow:Qi,addToDrive:wi,selectFromWxDrive:hi,jumpToDrive:gi,getPartyListOrUserList:bi,getSubDepartments:ki,openSupportPage:gr,selectContacts:Wi,viewProfile:yi,getRecentContacts:Si,searchContacts:_i,openUrl:er,openInBrowser:nr,openInTab:rr,openAndJumpToMainPage:sr,openFileInWedrive:or,closeWindow:ir,getWindowUrlParams:vr,docLogin:br,log:kr},Dc={getAppVersion:Ki,compare:Yi,isNewWwapp:Zi},Oc=ge(de()?Pc:ue()?xc:Dc,j.isWeWork);Oc.docLogin&&(Oc.docLogin=Pe(Oc.docLogin)),yc&&(Oc.canShowSharePanel=Li,Oc.isSharePanelShowed=function(){return Ei}),yc&&(Oc.canUseNativeIframe=function(){return Y.isWxWorkQt&&Y.isWxWorkVersionAboveOrEqual("4.1.10")},Oc.useNativeIframe=function(e,t){if(!e)return null;var o=t.onMessage,i=t.onClean,c=t.query,s=t.inject;t.scope;var a=t.targetName,u=void 0===a?"general_container":a,l=n(t,["onMessage","onClean","query","inject","scope","targetName"]);if(c){var d=new URL(e),f=d.searchParams;for(var p in c)"object"===r(c[p])&&(c[p]=JSON.stringify(c[p]));new URLSearchParams(c).forEach((function(e,n){return f.has(n)?f.set(n,e):f.append(n,e)})),d.search=f.toString(),e=d.toString()}var v="";"function"==typeof s?v=encodeURIComponent("("+s.toString()+")()"):s&&(v=encodeURIComponent(s));var w=Date.now().toString(),h=u+"?"+new URLSearchParams({scope:t.scope||"",identifier:w,options:JSON.stringify(l),inject:v}),g=window.open(e,h);if(!g)return null;var m=function(){window.__QtNativeIframe=void 0,window.removeEventListener("message",b)},b=function(e){o&&o(e),"https://doc.weixin.qq.com"!==e.origin&&"https://docs.qq.com"!==e.origin||"_QtNativeDestroyed_"===e.data&&(console.warn("receive _QtNativeDestroyed_"),i(),m())};window.__QtNativeIframe&&(console.error("__QtNativeIframe already exists, safetyClean"),window.__QtNativeIframe.safetyClean()),window.addEventListener("message",b);var k={ref:g,identifier:w,safetyClean:m};return window.__QtNativeIframe=k,k}),Wc&&De()&&(Oc.onEnterBackground=function(e){var n=function(n){var t,o;if("magicbox://tdocs/container/enterBackground"===(null===(t=null==n?void 0:n.detail)||void 0===t?void 0:t.schema)){var i=(null===(o=null==n?void 0:n.detail)||void 0===o?void 0:o.option)||{};e(i),oc.log("enterBackground",i)}};return window.addEventListener("magicBoxEvent",n),function(){return window.removeEventListener("magicBoxEvent",n)}},Oc.onEnterForeground=function(e){var n=function(n){var t,o;if("magicbox://tdocs/container/enterForeground"===(null===(t=null==n?void 0:n.detail)||void 0===t?void 0:t.schema)){var i=(null===(o=null==n?void 0:n.detail)||void 0===o?void 0:o.option)||{};e(i),oc.log("enterForeground",i)}};return window.addEventListener("magicBoxEvent",n),function(){return window.removeEventListener("magicBoxEvent",n)}});var Ec=e(e(e(e(e(e(e(e(e(e(e({},Oc),de()?{onCompleteComment:Ji,onUnreadCountChange:Xi,onCloseDiscussWindow:$i,onBlurWedocsWindow:lr,onFocusWedocsWindow:ar,onUrlChange:fr,offCompleteComment:Gi,offUnreadCountChange:Hi,offCloseDiscussWindow:zi,offBlurWedocsWindow:dr,offFocusWedocsWindow:ur,offUrlChange:pr}:{}),ue()?{onUpdateWeWorkFontConfig:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.updateWeWorkFontConfig",e),[2]}}))}))},onBoardOpenPage:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.boardOpenPage",e),[2]}}))}))},onFocusBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.focusBoardWindow",e),[2]}}))}))},onBlurBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.blurBoardWindow",e),[2]}}))}))},offBlurBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.blurBoardWindow",e),[2]}}))}))},offBoardOpenPage:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.boardOpenPage",e),[2]}}))}))},offFocusBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.focusBoardWindow",e),[2]}}))}))},offUpdateWeWorkFontConfig:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.updateWeWorkFontConfig",e),[2]}}))}))},onCompleteComment:Ji,onFullscreenChange:pi,onUnreadCountChange:Xi,onCloseDiscussWindow:$i,onBlurWedocsWindow:lr,onFocusWedocsWindow:ar,onUrlChange:fr,offCompleteComment:Gi,offFullscreenChange:vi,offUnreadCountChange:Hi,offCloseDiscussWindow:zi,offBlurWedocsWindow:dr,offFocusWedocsWindow:ur,offUrlChange:pr}:{}),sc?{onConversationChange:Vr,offConversationChange:qr}:{}),ac?{onClickDocTab:wr,offClickDocTab:hr,onOpenDocInTimeline:Xr,offOpenDocInTimeline:Hr}:{}),lc&&E.isMac()?{onDarkModeChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.darkModeChange",e),[2]}}))}))},offDarkModeChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.darkModeChange",e),[2]}}))}))}}:{}),dc&&E.isMac()?{onFontSizeDidChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.fontSizeDidChange",e),[2]}}))}))},offFontSizeDidChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.fontSizeDidChange",e),[2]}}))}))}}:{}),fc&&E.isMac()?{onMainPageFloatingChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.mainPageFloatingChange",e),[2]}}))}))},offMainPageFloatingChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.mainPageFloatingChange",e),[2]}}))}))}}:{}),wc?{onSearchDocInTimeline:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.searchDocInTimeline",e),[2]}}))}))},offSearchDocInTimeline:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.searchDocInTimeline",e),[2]}}))}))},onMessageChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.messageChange",e),[2]}}))}))},offMessageChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.messageChange",e),[2]}}))}))}}:{}),wc&&E.isWindows()||Cc&&E.isMac()&&De()?{onVisibilityChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.visibilityChange",e),[2]}}))}))},offVisibilityChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.visibilityChange",e),[2]}}))}))}}:{}),Ac?{onDragFileEvent:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().on("wwqt.wedoc.dragFileEvent",e),[2]}}))}))},offDragFileEvent:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,te(j.isWeWork)];case 1:return n.sent().off("wwqt.wedoc.dragFileEvent",e),[2]}}))}))}}:{}),Mc=E.compareVersion(he(),"2.6.15")>=0,jc=e(e({getClipboardData:ci,setClipboardData:si,readAsDataURL:ui,readFileListFromClipBoard:ai,copyNativeImage:li,getAppVersion:Ki,compare:Yi,isNewWwapp:Zi,quoteToDiscuss:Ni,startConversation:Bi,forwardFormsToWXWork:Fi,forwardToConversion:Ui,notifyPush:Ri,showDiscussWindow:Vi,hideOneDiscussWindow:qi,destroyDiscussWindow:Qi,requestFullscreen:di,exitFullscreen:fi,addToDrive:wi,selectFromWxDrive:hi,jumpToDrive:gi,wedriveUniversalEvent:mi,getPartyListOrUserList:bi,getSubDepartments:ki,selectContacts:Wi,viewProfile:yi,getRecentContacts:Si,searchContacts:_i,openUrl:er,openInBrowser:nr,openInTab:rr,openAndJumpToMainPage:sr,openFileInWedrive:or,closeWindow:ir,getWindowUrlParams:vr,docLogin:br,getLoginCst:mr,log:kr,insertWxworkGroupChat:yr,isInWxworkGroupChat:Cr,joinWxworkGroupChat:Wr,enterWxworkGroupChat:Sr,createWxworkNameCardSelf:_r,enterWxworkNameCard:Ar,canChatWithWxworkNameCard:Tr,joinWxworkCalender:Or,queryWxworkCalenderInfo:Dr,createWxworkCalender:Ir,selectWxworkCalenderList:xr,viewDetailWxworkCalender:Pr,openChatMessageDetail:Mr,createTransferedChatMessageInfo:Er,getConversationList:jr,getConversationsDetail:Lr,getNoticeCount:Nr,monitorDocConv:Br,markAsRead:Fr,setConvTop:Ur,removeConv:Rr,setNoticeType:Qr,getTotalUnreadCount:Jr},E.isMac()?{}:{openWecomSearch:cr}),{timelineInited:Gr,queryDepartmentNames:Kr,shareToWeixin:$r,isInstalledWeixinApp:zr,openInWxworkBrowser:tr}),Lc=ge(Mc?jc:{getAppVersion:Ki,compare:Yi,isNewWwapp:Zi},j.isWeWork),Nc=e(e({},Lc),{onCompleteComment:Ji,onFullscreenChange:pi,onUnreadCountChange:Xi,onCloseDiscussWindow:$i,onBlurWedocsWindow:lr,onFocusWedocsWindow:ar,onUrlChange:fr,offCompleteComment:Gi,offFullscreenChange:vi,offUnreadCountChange:Hi,offCloseDiscussWindow:zi,offBlurWedocsWindow:dr,offFocusWedocsWindow:ur,offUrlChange:pr,onConversationChange:Vr,offConversationChange:qr,onClickDocTab:wr,offClickDocTab:hr,onOpenDocInTimeline:Xr,offOpenDocInTimeline:Hr});E.compareVersion(ae(),"3.1.20"),E.compareVersion(ae(),"3.1.23"),E.compareVersion(ae(),"4.0.0"),E.compareVersion(ae(),"4.0.2"),E.compareVersion(ae(),"4.0.6");var Bc={clean:Qn,isWeDriveEnabled:Ve,chooseWeDriveFile:qe,multiChooseWeDriveFile:Qe,chooseTencentOfficeFile:Je,getClipboardData:Ue,setClipboardData:Re,fileDownload:He,getAppVersion:ze,compare:Ke,isNewWwapp:Ye,openCamera:$e,quoteToDiscuss:Ge,forwardToConversion:Xe,showNativePanel:mn,updatePanelConfig:gn,initToolbarConfig:vn,showNativeToolbar:hn,updateToolbarConfig:wn,setTitle:Tn,showOnlineUserList:In,getCustomTopbarButtonConfig:Un,onCustomTopbarButtonClick:Rn,viewProfile:un,onUnload:Ze,selectPerson:an,openUrl:Gn,popBack:Xn,saveImage:zn,previewImage:$n,chooseImage:Kn,setActionButtons:kn,showMenuActions:Wn,showBottomActionSheet:Sn,updateActionButtons:_n,showNativeToast:et,notifyCommentActionToNative:nt,notifyEmojiCommentToNative:tt,allCommentPanelCountUpdated:ot,showNativeAllCommentPanel:it,launchCommentInput:rt,showEmojiActionPanel:ct,vibration:Lt,updateAuthority:ln,wdocsUpdateAuthority:ln,getLoginCst:Bt,docLogin:Vt,log:qt,sendMagicBoxMsg:Qt,getClientMutexLock:Jt,mapDocumentVersion:Gt,removeDocumentVersion:Xt,getOfflineLocalConfig:Ht,isOfflineBidAvailable:$t,preloadJsReady:Yt,manualSaveDocData:Kt,notifyNative:zt,firstLoadFinished:eo,documentUrlReplace:Zt,requestFocus:no,insertWxworkGroupChat:bt,isInWxworkGroupChat:kt,joinWxworkGroupChat:yt,enterWxworkGroupChat:Ct,createWxworkNameCardSelf:Wt,enterWxworkNameCard:St,canChatWithWxworkNameCard:_t,joinWxworkCalender:Pt,queryWxworkCalenderInfo:xt,createWxworkCalender:At,selectWxworkCalenderList:Tt,viewDetailWxworkCalender:It,openChatMessageDetail:Ot,createTransferedChatMessageInfo:Dt,clearDocUnread:dt,showDiscussion:ft,hideDiscussion:pt,updateDiscussion:vt,showCollaboratorPanel:dn,showNativeSingleCommentPanel:st,hideNativeSingleCommentPanel:at,updateOnlineUserList:fn,notifyDocChange:ut,updateMessageQuoteStatus:lt,insertApp:Et,openMiniProgram:Mt,updateAuth:pn,vibrateDevice:Nt,queryLatestUnreadMsg:wt,queryConversationUnread:ht},Fc={clean:Qn,getClipboardData:Ue,setClipboardData:Re,getAppVersion:ze,compare:Ke,isNewWwapp:Ye,quoteToDiscuss:Ge,forwardToConversion:Xe,setTitle:Tn,viewProfile:un,onUnload:Ze,selectPerson:an,openUrl:Gn,previewImage:$n,showNativeToast:et,notifyCommentActionToNative:nt,notifyEmojiCommentToNative:tt,allCommentPanelCountUpdated:ot,showNativeAllCommentPanel:it,launchCommentInput:rt,showEmojiActionPanel:ct,vibration:Lt,updateAuthority:ln,docLogin:Vt,log:qt},Uc={getAppVersion:ze,compare:Ke,isNewWwapp:Ye,viewProfile:un,openUrl:Gn,previewImage:$n,getLoginCst:Bt,docLogin:Vt},Rc=ge(fe()?Bc:pe()?Fc:Uc,j.isWeWorkApp),Vc=e(e(e({},Rc),{isWedocWebview:fe}),fe()?{addEventListener:en,removeEventListener:nn,removeIconButtonClickEvent:Bn,callbackMap:xn,deleteCookie:We}:{});ce()===j.isWeWorkApp&&!fe()&&pe()&&document.addEventListener("WeixinJSBridgeReady",(function(){var e,n;Object.keys(Vc).forEach((function(e){var n;Uc[e]||(null===(n=window.tdocs)||void 0===n?void 0:n[e])===Vc[e]&&delete window.tdocs[e]})),null===(n=null===(e=window.qmailBridge)||void 0===e?void 0:e.destroy)||void 0===n||n.call(e),console.warn("no jsapi support for this wxwork mobile version")}));var qc=function(e,n){e.invoke("docx","getNativeScreenSize",{},(function(e){var t;null===(t=n.success)||void 0===t||t.call(n,e)}))},Qc=new Map;function Jc(n,t){var o=e({},t);if("function"==typeof t.onclick){var i=Qc.get(t.id);i&&i.func===t.onclick?o.onclick=i.callbackId:(o.onclick=n.callback(t.onclick),Qc.set(t.id,{callbackId:o.onclick,func:t.onclick}))}return o}function Gc(e,n){return n.map((function(n){return Jc(e,n)}))}var Xc,Hc=function(){function e(){this.currentSeqId=0,this.reqCallbacks=new Map}return Object.defineProperty(e.prototype,"canUseNativeAndroid",{get:function(){var e;return(null===(e=window.mqq)||void 0===e?void 0:e.android)&&window._mqqWebViewJSInterface&&window._mqqWebViewJSInterface.invoke},enumerable:!1,configurable:!0}),e.prototype.JSApiCallback=function(e){var n=this.reqCallbacks.get(e.callbackId);if(n){var t=n.callback,o=n.command,i=n.startTime;t&&(oc.debug("callback invokeNative-"+e.callbackId+"-"+o+"-"+(Date.now()-i)+"ms",this.canUseNativeAndroid,"response="+JSON.stringify(e)),t(e)),this.reqCallbacks.delete(e.callbackId)}else oc.warn("callback invokeNative-"+e.callbackId+" reqCallback not found")},e.prototype.createReqSeq=function(){return this.currentSeqId++},e.prototype.invokeNative=function(e,n,t,o){var i=this.createReqSeq(),r=t.command;this.reqCallbacks.set(i,{callback:o,command:r,startTime:Date.now()}),oc.debug("start call invokeNative-"+i+"-"+r,e,n,r,this.canUseNativeAndroid,"request="+JSON.stringify(t)),t.callbackId=i,this.canUseNativeAndroid?this.invokeNativeAndroid(e,n,t):window.mqq&&window.mqq.invoke(e,n,t)},e.prototype.invokeNativeAndroid=function(e,n,t){var o="jsbridge://"+encodeURIComponent(e)+"/"+encodeURIComponent(n);t&&(o+="?p="+encodeURIComponent(JSON.stringify(t))),window._mqqWebViewJSInterface.invoke(o)},e.prototype.defaultOfflineCodeVersion=function(e,n){oc.debug("defaultOfflineCodeVersion-"+e),window.mqq&&window.mqq.invoke("docx","defaultOfflineCodeVersion",{type:e},(function(t){oc.debug("defaultOfflineCodeVersion-"+e),n&&n(t)}))},e}();E.isServerSide()?Xc=null:window.jsApi?Xc=window.jsApi:((Xc=new Hc).invokeNative=Xc.invokeNative.bind(Xc),Xc.invokeNativeAndroid=Xc.invokeNativeAndroid.bind(Xc),window.jsApi=Xc,window.JSApiCallback||(window.JSApiCallback=Xc.JSApiCallback.bind(Xc)));var $c=Xc;function zc(e,t,o,i){void 0===i&&(i="docx");var r=o.success;o.fail;var c=n(o,["success","fail"]);e.invoke(i,t,c,r)}var Kc=ge({getClipboardData:function(e,n){e.invoke("docx","readSystemClipboard",{},(function(e){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,e)}))},setClipboardData:function(e,t){var o=t||{},i=o.success;o.fail;var r=n(o,["success","fail"]);e.invoke("docx","writeSystemClipboard",r,(function(e){null==i||i(e)}))},getAppVersion:function(e,n){var t;null===(t=n.success)||void 0===t||t.call(n,e.clientVersion)},updateAuthority:function(e,n){e.invoke("QQApi","updatePermission",{},n.success)},setWxWorkLogin:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("docx","setWxWorkLogin",i,o)},compare:function(e,n){var t;null===(t=n.success)||void 0===t||t.call(n,E.compareVersion(e.clientVersion,n.version||""))},copyNativeImage:function(e,n){var t=n||{},o=t.x,i=t.y;e.invoke("docx","copyNativeImageByPosition",{x:o,y:i})},openCamera:function(e,n){e.invoke("docx","openCamera",{},(function(e){var t;e.url&&(null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,e))}))},checkCameraPermission:function(e,n){e.invoke("docx","cameraCheckPermission",{},(function(){var e;null===(e=null==n?void 0:n.success)||void 0===e||e.call(n,{})}))},getScreenSize:function(e,n){qc(e,n)},getDeviceId:function(e,n){},setTitle:function(e,n){null==e||e.invoke("ui","setWebviewNaviTitle",{title:n.title})},showNativeHeader:function(e){e.invoke("titlebar","setState",{state:1})},hideNativeHeader:function(e){e.invoke("titlebar","setState",{state:0})},openUrl:function(e,n){e.ui.openUrl({url:n.url,target:N.Detail,style:1})},openInBrowser:function(e,n){e.publicAccount.openInExternalBrowser(n.url)},jumpNativeList:function(e,n){e.invoke("QQApi","jumpNativeList",n,n.callback)},saveImage:function(t,o){var i=o.success;o.fail;var r=n(o,["success","fail"]);se()===L.Android?null==$c||$c.invokeNative("ui","savePublicImg",r,(function(n){null==i||i(e({data:n.result},n))})):t.invoke("ui","savePublicImg",r,i)},chooseImage:function(e,n){console.log(e,n),e.invoke("docx","multipleImagePicker",{max_count:n.max_count},(function(e){var t,o;0===e.retcode?null===(t=n.success)||void 0===t||t.call(n,e):null===(o=n.fail)||void 0===o||o.call(n,"",e.retcode)}))},showDialog:function(e,n){e.invoke("titlebar","showDialogById",Jc(e,{id:n.id,event:n.event,msg:n.msg,btnText:n.btnText,onclick:n.onClick}))},setActionButtons:function(e,n){var t=Gc(e,n.buttons);e.invoke("titlebar","setActionButtons",{buttons:t})},updateActionButtons:function(e,n){var t=Gc(e,n.buttons);e.invoke("titlebar","updateActionButtonsById",{buttons:t})},popBack:function(e){e.invoke("ui","popBack")},setTitleButtons:function(e,t){t.success,t.fail;var o=n(t,["success","fail"]);e.ui.setTitleButtons(o)},fileDownload:function(e,n){e.invoke("docx","fileDownload",n.url)},getZoomState:function(e,n){e.invoke("QQApi","getZoomState",{},n.success)},setZoomState:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("QQApi","setZoomState",i,o)},logoutAccount:function(e,n){e.invoke("docx","logoutAccount",(function(){var e;null===(e=n.success)||void 0===e||e.call(n)}))},updateUndoRedoState:function(e,n){e.invoke("docx","updateUndoRedoState",{isUndoAvailable:n.isUndoAvailable,isRedoAvailable:n.isRedoAvailable},(function(){var e;null===(e=n.success)||void 0===e||e.call(n)}))},sendMagicBoxMsg:function(t,o){var i=o.success;o.fail;var r=n(o,["success","fail"]);t.invoke("magicbox","emitEvent",e({},r),i)},getClientMutexLock:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);null==$c||$c.invokeNative("docx","clientMutexLock",i,(function(e){null==o||o(e)}))},mapDocumentVersion:function(e,n){var t,o,i;if(Y.isElectronTencentDocsClient)return null===(o=null===(t=navigator.serviceWorker)||void 0===t?void 0:t.controller)||void 0===o||o.postMessage({type:"preload:map-document-version",data:n}),void(null===(i=n.success)||void 0===i||i.call(n,{}));zc(e,"mapDocumentVersion",n)},removeDocumentVersion:function(e,n){var t,o,i;if(Y.isElectronTencentDocsClient)return null===(o=null===(t=navigator.serviceWorker)||void 0===t?void 0:t.controller)||void 0===o||o.postMessage({type:"preload:remove-document-version",data:n}),void(null===(i=n.success)||void 0===i||i.call(n,{}));zc(e,"removeDocumentVersion",n)},isOfflineBidAvailable:function(e,n){zc(e,"isOfflineBidAvailable",n)},getOfflineLocalConfig:function(e,n){zc(e,"getOfflineLocalConfig",n)},preloadJsReady:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);null==$c||$c.invokeNative("docx","preloadJsReady",i,(function(e){null==o||o(e)}))},manualSaveDocData:function(e,n){zc(e,"manualSaveDocData",n)},notifyNative:function(e,n){zc(e,"notifyNative",n)},firstLoadFinished:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("docx","firstLoadFinished",i,o)},updateNativeList:function(e,n){e.invoke("QQApi","updateNativeList",{target:n.target},n.success)},requestFocus:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("docx","requestFocus",i,o)},clientDatabaseRequest:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);null==$c||$c.invokeNative("docx","clientDatabaseRequest",i,(function(e){null==o||o(e)}))}},j.isTencentDocsApp),Yc=e({},Kc);function Zc(t,o,i){var r=Date.now().toString(36)+Math.random().toString(36).substring(2),c=function(e){return"__MEETING_SDK_CALLBACK_"+e}(r),s=i.success,a=i.fail,u=n(i,["success","fail"]),l=e(e({},o),{callId:r,callback:c,param:u});window[c]=function(e){if(delete window[c],"string"==typeof e)try{e=JSON.parse(e)}catch(e){}1===(null==e?void 0:e.code)?null==s||s(e.data||{}):null==a||a(e)},t.invokeNative("JSCallNative",l)}var es,ns=E.compareVersion((es=E.getLowerCaseUserAgent().match(/app_version\/([0-9.]*)/))?es[1]:"","3.13.0.0")>=0,ts=ge(e({closeLoading:function(e,n){Zc(e,{module:"CommonPlugin",method:"HideLoading"},n)},docLogin:function(e,n){(function(){return t(this,void 0,Promise,(function(){return o(this,(function(e){return[2,window.wemeet.wework.getCurDocAuthData({pageType:1})]}))}))})().then((function(e){var t,o=e.authCode,i=e.meetingId,r=e.openId,c=e.docCode;o&&i&&r&&c?function(e,n){var t=Oe("disklogin_meeting"),o=t.reportSuccess,i=t.reportFail,r="/disklogin/login?from_tdocs_jsapi=1&product=2&from=33&f=json&"+Object.keys(e).map((function(n){return n+"="+encodeURIComponent(e[n])})).join("&");fetch(r).then((function(e){return e.json()})).then((function(e){var t,c,s,a;0===(null===(t=null==e?void 0:e.head)||void 0===t?void 0:t.ret)?(null===(c=null==n?void 0:n.success)||void 0===c||c.call(n,e),o()):(null===(s=null==n?void 0:n.fail)||void 0===s||s.call(n,e),i(e),xe({url:r,code:(null===(a=null==e?void 0:e.head)||void 0===a?void 0:a.ret)||-1,scene:"backendError"}))})).catch((function(e){var t;null===(t=null==n?void 0:n.fail)||void 0===t||t.call(n,e),i(null==e?void 0:e.message)}))}({code:o,meeting_id:i,openid:r,doc_code:c},n):null===(t=n.fail)||void 0===t||t.call(n,{err_msg:"need meeting_id、openid、authCode、docCode",authCode:o,meetingId:i,openId:r,docCode:c})})).catch((function(e){var t;null===(t=n.fail)||void 0===t||t.call(n,e)}))},setDocTitle:function(e,n){Zc(e,{module:"DocSharePlugin",method:"SetDocTitle"},n)}},ns?{enableRecordRect:function(e,n){Zc(e,{module:"WebAppSharePlugin",method:"EnableRecordRect"},n)}}:{}),j.isTencentMeeting),os=function(){var e,n=ce(),t=se();!function(e){if(!ne)if(document.getElementById("tdocsJSScript"))Z=Promise.resolve();else{var n=document.createElement("script");switch(n.id="tdocsJSScript",n.crossOrigin="anonymous",e){case j.IsQQ:case j.isQQMiniProgram:case j.isTencentDocsApp:n.src=m;break;case j.isElectronTencentDocsClient:return void(Z=Promise.resolve());case j.isWXh5:n.src=b;break;case j.isWeWork:if(we())n.src=y;else if(de()){if(!ye())return void(Z=Promise.resolve());n.src=W}else{if(!ue())return console.error("no jsapi support for this wxwork version"),void(Z=Promise.resolve());n.src=y}break;case j.isWeWorkApp:if(fe())n.src=k;else{if(!pe())return console.error("no jsapi support for this wxwork mobile version"),void(Z=Promise.resolve());if(!ye())return void(Z=Promise.resolve());n.src=C}break;case j.isTencentMeeting:window.tencentMeetingSDK=ee.getInstance(),n.src=S}if(E.isMobile()&&"loading"===document.readyState){try{document.write(n.outerHTML)}catch(e){console.error("document.write error",e)}if(document.getElementById("tdocsJSScript"))return void(Z=Promise.resolve())}Z=new Promise((function(e,t){n.onload=function(){console.error("--------资源加载成功"),e()},n.onerror=function(){console.error("--------资源加载失败"),t()},null!==document.head?document.head.appendChild(n):document.body.appendChild(n)}))}}(n);var o=((e={})[j.isWeWork]=we()?Nc:Ec,e[j.isWeWorkApp]=we()?Vc:Yo,e[j.isTencentDocsApp]=Yc,e[j.isElectronTencentDocsClient]=Yc,e[j.isQQMiniProgram]=Yc,e[j.IsQQ]=Yc,e[j.isWXh5]={},e[j.isTencentMeeting]=ts,e[j.UNKNOW]={},e)[n];E.isServerSide()||setTimeout((function(){document.dispatchEvent(new CustomEvent("tdocsReady"))}));return Object.assign({environmentType:n,platform:t,version:"1.103.0"},o)}();return function(e){ce()===j.isWeWork&&E.isWindows()&&ue()&&p()===v&&setTimeout((function(){var n;null===(n=e.checkIsDocBrowser)||void 0===n||n.call(e).then((function(n){n.isDocBrowser||Object.keys(xc).forEach((function(n){e[n]&&!Dc[n]&&delete e[n]}))}))}),0)}(os),function(e){ce()!==j.isWeWorkApp||fe()||ve()||!pe()||document.addEventListener("WeixinJSBridgeReady",(function(){var n,t;Object.keys(Ho).forEach((function(n){delete e[n]}));var o=ge($o,j.isWeWorkApp);o.docLogin&&(o.docLogin=Pe(o.docLogin)),Object.keys(o).forEach((function(n){e[n]=o[n]})),null===(t=null===(n=window.qmailBridge)||void 0===n?void 0:n.destroy)||void 0===t||t.call(n),console.warn("tdocs jsapi switch to wxwork normal webview")}))}(os),os}));
